import{R as On,j as ue,r as cn}from"./index-BLLJZjrO.js";(function(t){typeof define=="function"&&define.amd?define(t):t()})(function(){function t(a){return a.startsWith("gl_")||a.startsWith("webgl_")}function e(a){return!!a.texImage3D}function n(a){return a&&a.buffer&&a.buffer instanceof ArrayBuffer}function r(a){return Array.isArray(a)||a instanceof Float32Array||a instanceof Float64Array}function s(a){return a?`"${a}"`:""}const i={};function c(a,b){const R=[];if(b.length){for(let M=0;M<b.length;++M)b.push(f(b[M]));return"["+R.join(", ")+"]"}return R.toString()}function o(a){return function(b,R){let M=0;const N=[];for(let k=0;k<a.length;++k){const W=i[a[k]];R&W&&(M|=W,N.push(f(W)))}return M===R?N.join(" | "):f(R)}}const l=new Map;function h(a){for(const b in a){const R=a[b];typeof R=="number"&&(l.has(R)||l.set(R,new Set),l.get(R).add(b))}}function f(a){const b=l.get(a);return b?[...b.keys()].map(R=>`${R}`).join(" | "):`/*UNKNOWN WebGL ENUM*/ ${typeof a=="number"?`0x${a.toString(16)}`:a}`}const A=5126,p=35664,F=35665,U=35666,z=5124,X=35667,y=35668,g=35669,v=35670,C=35671,I=35672,Y=35673,xe=35674,Ae=35675,fe=35676,le=35678,Z=35680,J=35679,ie=35682,q=35685,he=35686,Me=35687,we=35688,Oe=35689,Pe=35690,Qe=36289,Rs=36292,_s=36293,Dt=5125,Vn=36294,Xn=36295,Wn=36296,gs=36298,Fs=36299,Ms=36300,Ss=36303,Is=36306,Bs=36307,ws=36308,Ps=36311,Us=new Map([[A,{size:1,name:"float"}],[p,{size:2,name:"vec2"}],[F,{size:3,name:"vec3"}],[U,{size:4,name:"vec4"}],[z,{size:1,name:"int"}],[X,{size:2,name:"ivec2"}],[y,{size:3,name:"ivec3"}],[g,{size:4,name:"ivec4"}],[Dt,{size:1,name:"uint"}],[Vn,{size:2,name:"uvec2"}],[Xn,{size:3,name:"uvec3"}],[Wn,{size:4,name:"uvec4"}],[v,{size:1,name:"bool"}],[C,{size:2,name:"bvec2"}],[I,{size:3,name:"bvec3"}],[Y,{size:4,name:"bvec4"}],[xe,{size:4,name:"mat2"}],[Ae,{size:9,name:"mat3"}],[fe,{size:16,name:"mat4"}],[q,{size:6,name:"mat2x3"}],[he,{size:8,name:"mat2x4"}],[Me,{size:6,name:"mat3x2"}],[we,{size:12,name:"mat3x4"}],[Oe,{size:8,name:"mat4x2"}],[Pe,{size:12,name:"mat4x3"}],[le,{size:1,name:"sampler2D"}],[Z,{size:1,name:"samplerCube"}],[J,{size:1,name:"sampler3D"}],[ie,{size:1,name:"sampler2DShadow"}],[Qe,{size:1,name:"sampler2DArray"}],[Rs,{size:1,name:"sampler2DArrayShadow"}],[_s,{size:1,name:"samplerCubeShadow"}],[gs,{size:1,name:"isampler2D"}],[Fs,{size:1,name:"isampler3D"}],[Ms,{size:1,name:"isamplerCube"}],[Ss,{size:1,name:"isampler2DArray"}],[Is,{size:1,name:"usampler2D"}],[Bs,{size:1,name:"usampler3D"}],[ws,{size:1,name:"usamplerCube"}],[Ps,{size:1,name:"usampler2DArray"}]]);function Bt(a){return Us.get(a)}const Ns=32873,vs=34068,Ds=32874,Cs=35869,Ls=34962,Os=34963,zs=34964,$s=34965,ks=3553,Gs=32879,Vs=35866,Xs=34067,Ws=36160,Ys=36161,Yn=36006,js=36007,Qs=35982,Hs=35983,qs=36009,Ks=36008,Zs=36010,Js=35345,ei=35368,ti=36386,ni=36389,ri=new Map([[Ls,zs],[Os,$s],[ks,Ns],[Xs,vs],[Gs,Ds],[Vs,Cs],[Ys,js],[Ws,Yn],[qs,Yn],[Ks,Zs],[Js,ei],[Qs,Hs],[ti,ni]]);function jn(a){return ri.get(a)}const si=5120,ii=5122,Qn=5121,Hn=5123,oi=new Map([[v,1],[si,1],[Qn,1],[ii,2],[Hn,2],[z,4],[Dt,4],[A,4]]);function qn(a){return oi.get(a)||0}const ai=new Map([[Qn,Uint8Array],[Hn,Uint16Array],[Dt,Uint32Array]]);function ci(a){return ai.get(a)}const Kn={drawArrays(a,b,R){return{startOffset:b,vertCount:R,instances:1}},drawElements(a,b,R,M){return{startOffset:M,vertCount:b,instances:1,indexType:R}},drawArraysInstanced(a,b,R,M){return{startOffset:b,vertCount:R,instances:M}},drawElementsInstanced(a,b,R,M,N){return{startOffset:M,vertCount:b,instances:N,indexType:R}},drawArraysInstancedANGLE(a,b,R,M){return{startOffset:b,vertCount:R,instances:M}},drawElementsInstancedANGLE(a,b,R,M,N){return{startOffset:M,vertCount:b,instances:N,indexType:R}},drawRangeElements(a,b,R,M,N,k){return{startOffset:k,vertCount:M,instances:1,indexType:N}}};function Zn(a,b){return Kn[a](...b)}function xn(a){return!!Kn[a]}const ui=new Map([[A,{size:4}],[p,{size:8}],[F,{size:12}],[U,{size:16}],[z,{size:4}],[X,{size:8}],[y,{size:12}],[g,{size:16}],[Dt,{size:4}],[Vn,{size:8}],[Xn,{size:12}],[Wn,{size:16}],[v,{size:4}],[C,{size:8}],[I,{size:12}],[Y,{size:16}],[xe,{size:4,count:2}],[Ae,{size:9,count:3}],[fe,{size:16,count:4}]]);function Ai(a){return ui.get(a)}const ct=a=>a?new WeakRef(a):null,ut=(a,b)=>{const R=a==null?void 0:a.deref();return!!R!=!!b?!1:R?R===b:!0};function Jn(a,b){return a==="undefined"?b:a}const fi=35070;function li(a,b){return a+b-1}function mi(a,b,R,M,N,k,W,G,j){const L=a.getParameter(a.ELEMENT_ARRAY_BUFFER_BINDING);if(!L){j.push("No ELEMENT_ARRAY_BUFFER bound");return}const K=qn(k),de=a.getBufferParameter(a.ELEMENT_ARRAY_BUFFER,a.BUFFER_SIZE),Se=R+M*K;if(Se>de){j.push(`offset: ${R} and count: ${M} with index type: ${f(k)} passed to ${b} are out of range for current ELEMENT_ARRAY_BUFFER.
Those parameters require ${Se} bytes but the current ELEMENT_ARRAY_BUFFER ${W(L)} only has ${de} bytes`);return}const Ne=G(L),Ie=ci(k),ve=new Ie(Ne,R);let ye=ve[0];for(let ot=1;ot<M;++ot)ye=Math.max(ye,ve[ot]);return ye}function hi(a,b,R,M,N){const{vertCount:k,startOffset:W,indexType:G,instances:j}=Zn(b,R);if(k<=0||j<=0)return[];const L=a.getParameter(a.CURRENT_PROGRAM),K=[],de=G?mi(a,b,W,k,j,G,M,N,K):li(W,k);if(K.length)return K;const Se=e(a)||a.getExtension("ANGLE_instanced_arrays"),Ne=a.getProgramParameter(L,a.ACTIVE_ATTRIBUTES),Ie=a.getParameter(a.ARRAY_BUFFER_BINDING);for(let ve=0;ve<Ne;++ve){const{name:ye,type:ot}=a.getActiveAttrib(L,ve);if(t(ye))continue;const nt=a.getAttribLocation(L,ye),{count:Tt}={count:1,...Ai(ot)};for(let ne=0;ne<Tt;++ne){const be=nt+ne;if(!a.getVertexAttrib(be,a.VERTEX_ATTRIB_ARRAY_ENABLED))continue;const ze=a.getVertexAttrib(be,a.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING);if(!ze){K.push(`no buffer bound to attribute (${ye}) location: ${nt}`);continue}const $=a.getVertexAttrib(be,a.VERTEX_ATTRIB_ARRAY_SIZE),V=a.getVertexAttrib(be,a.VERTEX_ATTRIB_ARRAY_TYPE),w=qn(V)*$,B=a.getVertexAttribOffset(be,a.VERTEX_ATTRIB_ARRAY_POINTER),O=a.getVertexAttrib(be,a.VERTEX_ATTRIB_ARRAY_STRIDE),ee=O||w,Q=Se?a.getVertexAttrib(be,fi):0;a.bindBuffer(a.ARRAY_BUFFER,ze);const ae=a.getBufferParameter(a.ARRAY_BUFFER,a.BUFFER_SIZE),re=Q>0?((j+Q-1)/Q|0)-1:de,se=B+re*ee+w;se>ae&&K.push(`${M(ze)} assigned to attribute ${be} used as attribute '${ye}' in current program is too small for draw parameters.
index of highest vertex accessed: ${re}
attribute size: ${$}, type: ${f(V)}, stride: ${O}, offset: ${B}, divisor: ${Q}
needs ${se} bytes for draw but buffer is only ${ae} bytes`)}}return a.bindBuffer(a.ARRAY_BUFFER,Ie),K}const er=35678,tr=35680,nr=35679,rr=35682,sr=36289,ir=36292,or=36293,Ei=36298,di=36299,xi=36300,bi=36303,Ti=36306,pi=36307,yi=36308,Ri=36311,Ct=new Map([[er,{uniformType:"sampler2D",numberType:"float/normalized",bindPoint:"2D"}],[tr,{uniformType:"samplerCube",numberType:"float/normalized",bindPoint:"CUBE"}],[nr,{uniformType:"sampler3D",numberType:"float/normalized",bindPoint:"3D"}],[rr,{uniformType:"sampler2D",numberType:"float/normalized",bindPoint:"2D"}],[sr,{uniformType:"sampler2DArray",numberType:"float/normalized",bindPoint:"2D_ARRAY"}],[ir,{uniformType:"sampler2DArray",numberType:"float/normalized",bindPoint:"2D_ARRAY"}],[or,{uniformType:"samplerCube",numberType:"float/normalized",bindPoint:"CUBE"}],[Ei,{uniformType:"isampler2D",numberType:"int",bindPoint:"2D"}],[di,{uniformType:"isampler3D",numberType:"int",bindPoint:"3D"}],[xi,{uniformType:"isamplerCube",numberType:"int",bindPoint:"CUBE"}],[bi,{uniformType:"isampler2DArray",numberType:"int",bindPoint:"2D_ARRAY"}],[Ti,{uniformType:"usampler2D",numberType:"unsigned int",bindPoint:"2D"}],[pi,{uniformType:"usampler3D",numberType:"unsigned int",bindPoint:"3D"}],[yi,{uniformType:"usamplerCube",numberType:"unsigned int",bindPoint:"CUBE"}],[Ri,{uniformType:"usampler2DArray",numberType:"unsigned int",bindPoint:"2D_ARRAY"}]]);function _i(a){return Ct.get(a).bindPoint}function Lt(a){return Ct.has(a)}function gi(a){return Ct.get(a).numberType}function ar(a){return Ct.get(a).uniformType}const Fi=3553,Mi=32879,Si=35866,Ii=34067,Bi=34069,wi=34070,Pi=34071,Ui=34072,Ni=34073,vi=34074,Di=new Map([[Fi,"2D"],[Mi,"3D"],[Ii,"CUBE"],[Bi,"CUBE"],[wi,"CUBE"],[Pi,"CUBE"],[Ui,"CUBE"],[Ni,"CUBE"],[vi,"CUBE"],[Si,"2D_ARRAY"]]);function cr(a){return Di.get(a)}const ur=32873,Ar=34068,Ci=32874,fr=35869,Li=new Map([[er,ur],[rr,ur],[nr,Ci],[sr,fr],[ir,fr],[tr,Ar],[or,Ar]]);function Oi(a,b,R){a.activeTexture(a.TEXTURE0+b);const M=Li.get(R);return a.getParameter(M)}const zi=36063;function $i(a){return!e(a)&&!a.getExtension("WEBGL_draw_buffers")?1:a.getParameter(zi)}function Ot(a,b,R){if(a.getFramebufferAttachmentParameter(a.FRAMEBUFFER,b,a.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE)===a.NONE)return;const N=a.getFramebufferAttachmentParameter(a.FRAMEBUFFER,b,a.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME);N instanceof WebGLTexture&&(R.has(N)||R.set(N,[]),R.get(N).push(b))}function ki(a,b){const R=a.getParameter(a.FRAMEBUFFER_BINDING);if(!R)return[];const M=$i(a),N=new Map;for(let L=0;L<M;++L)Ot(a,a.COLOR_ATTACHMENT0+L,N);Ot(a,a.DEPTH_ATTACHMENT,N),Ot(a,a.STENCIL_ATTACHMENT,N),e(a)||Ot(a,a.DEPTH_STENCIL_ATTACHMENT,N);const k=a.getParameter(a.ACTIVE_TEXTURE),W=a.getParameter(a.CURRENT_PROGRAM),G=a.getProgramParameter(W,a.ACTIVE_UNIFORMS),j=[];for(let L=0;L<G;++L){const{name:K,type:de,size:Se}=a.getActiveUniform(W,L);if(!(t(K)||!Lt(de)))if(Se>1){const Ne=K.substr(-3)==="[0]"?K.substr(0,K.length-3):K;for(let Ie=0;Ie<Se;++Ie)j.push(...lr(a,R,N,W,`${Ne}[${Ie}]`,de,b))}else j.push(...lr(a,R,N,W,K,de,b))}return a.activeTexture(k),j}function lr(a,b,R,M,N,k,W){const G=a.getUniformLocation(M,N),j=a.getUniform(M,G),L=Oi(a,j,k),K=R.get(L);return K?[`${W(L)} on uniform: ${N} bound to texture unit ${j} is also attached to ${W(b)} on attachment: ${K.map(de=>f(de)).join(", ")}`]:[]}function Gi(){const a=navigator.userAgent;let b=a.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];if(/trident/i.test(b[1]))return b=/\brv[ :]+(\d+)/g.exec(a)||[],{name:"IE",version:b[1]};if(b[1]==="Chrome"){const M=a.match(/\b(OPR|Edge)\/(\d+)/);if(M)return{name:M[1].replace("OPR","Opera"),version:M[2]}}b=b[2]?[b[1],b[2]]:[navigator.appName,navigator.appVersion,"-?"];const R=a.match(/version\/(\d+)/i);return R&&b.splice(1,1,R[1]),{name:b[0],version:b[1]}}const Vi=function(){const a=Gi();let b,R;return/chrome|opera/i.test(a.name)?(b=3,R=function(M){const N=/at ([^(]+)*\(*(.*?):(\d+):(\d+)/.exec(M);if(N){let k=N[1],W=N[2];const G=parseInt(N[3]),j=parseInt(N[4]);return W===""&&(W=k,k=""),{url:W,lineNo:G,colNo:j,funcName:k}}}):/firefox|safari/i.test(a.name)&&(b=2,R=function(M){const N=/@(.*?):(\d+):(\d+)/.exec(M);if(N){const k=N[1],W=parseInt(N[2]),G=parseInt(N[3]);return{url:k,lineNo:W,colNo:G}}}),function(N){if(R)try{const k=N.split(`
`);return R(k[b])}catch{}}}();function Xi(a){const b=[],R=a.getParameter(a.MAX_COMBINED_TEXTURE_IMAGE_UNITS);for(let M=0;M<R;++M)b.push(new Map);return b}const Wi=33984,bn=3553,Tn=32879,At=34067,zt=34069,mr=34070,hr=34071,Er=34072,dr=34073,xr=34074,br=10241,Tr=10240,$t=33084,pr=33085,yr=10242,Rr=10243,_r=10497,gr=35866,kt=33071,pn=9728,Fr=9729,Yi=9986,ji=new Map([[9,function([a,b,R,M,N,,k,W]){return{target:a,level:b,internalFormat:R,width:M,height:N,format:k,type:W}}],[6,function([a,b,R,M,N,k]){return{target:a,level:b,internalFormat:R,width:k.width,height:k.height,format:M,type:N}}],[10,function([a,b,R,M,N,,k,W]){return{target:a,level:b,internalFormat:R,width:M,height:N,format:k,type:W}}]]),Gt=6406,qe=6407,Ke=6408,Vt=6409,Xt=6410,yn=6402,Mr=34041,Sr=new Set([Gt,Vt,Xt,qe,Ke]);function wt(a,b){return Sr.has(a)?`${f(a)}/${f(b)}`:f(a)}const Ir=new Map([[bn,0],[Tn,0],[gr,0],[At,0],[zt,0],[mr,1],[hr,2],[Er,3],[dr,4],[xr,5]]);function Rn(a,b){return b===At?`(${f(zt+a)})`:""}const Qi=[bn],Hi=[zt,mr,hr,Er,dr,xr],qi=33321,Ki=36756,Br=33325,wr=33326,Zi=33330,Ji=33329,eo=33338,to=33337,no=33340,ro=33339,so=33323,io=36757,Pr=33327,Ur=33328,oo=33336,ao=33335,co=33332,uo=33331,Ao=33334,fo=33333,lo=32849,mo=35905,ho=36194,Eo=36758,xo=35898,bo=35901,Nr=34843,vr=34837,To=36221,po=36239,yo=36215,Ro=36233,_o=36209,go=36227,Fo=32856,Mo=35907,So=36759,Io=32855,Bo=32854,wo=32857,Dr=34842,Cr=34836,Po=36220,Uo=36238,No=36975,vo=36214,Do=36232,Co=36226,Lo=36208,Oo=33189,zo=33190,$o=36012,ko=36013,Go=35056,ft=5120,Ue=5121,Wt=5122,Pt=5123,Yt=5124,yt=5125,He=5126,Lr=32819,Or=32820,zr=33635,lt=5131,$r=36193,_n=33640,Vo=35899,Xo=35902,Wo=36269,Yo=34042,jt=33319,Rt=33320,Qt=6403,_t=36244,gt=36248,bt=36249;function jo(){const a=new Map([[Gt,{textureFormat:Gt,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1,2,2,4],type:[Ue]}],[Vt,{textureFormat:Vt,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1,2,2,4],type:[Ue]}],[Xt,{textureFormat:Xt,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[2,4,4,8],type:[Ue]}],[qe,{textureFormat:qe,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3,6,6,12,2],type:[Ue,zr]}],[Ke,{textureFormat:Ke,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,8,8,16,2,2],type:[Ue,Lr,Or]}],[qi,{textureFormat:Qt,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1],type:[Ue]}],[Ki,{textureFormat:Qt,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[1],type:[ft]}],[Br,{textureFormat:Qt,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[4,2],type:[He,lt]}],[wr,{textureFormat:Qt,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[4],type:[He]}],[Zi,{textureFormat:_t,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[1],type:[Ue]}],[Ji,{textureFormat:_t,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[1],type:[ft]}],[co,{textureFormat:_t,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[Pt]}],[uo,{textureFormat:_t,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[Wt]}],[Ao,{textureFormat:_t,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[yt]}],[fo,{textureFormat:_t,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Yt]}],[so,{textureFormat:jt,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[2],type:[Ue]}],[io,{textureFormat:jt,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[2],type:[ft]}],[Pr,{textureFormat:jt,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[8,4],type:[He,lt]}],[Ur,{textureFormat:jt,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[8],type:[He]}],[oo,{textureFormat:Rt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[Ue]}],[ao,{textureFormat:Rt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[ft]}],[eo,{textureFormat:Rt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Pt]}],[to,{textureFormat:Rt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Wt]}],[no,{textureFormat:Rt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[yt]}],[ro,{textureFormat:Rt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[Yt]}],[lo,{textureFormat:qe,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3],type:[Ue]}],[mo,{textureFormat:qe,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[3],type:[Ue]}],[ho,{textureFormat:qe,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3,2],type:[Ue,zr]}],[Eo,{textureFormat:qe,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[3],type:[ft]}],[xo,{textureFormat:qe,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6,4],type:[He,lt,Vo]}],[bo,{textureFormat:qe,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6,4],type:[He,lt,Xo]}],[Nr,{textureFormat:qe,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6],type:[He,lt]}],[vr,{textureFormat:qe,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[He]}],[To,{textureFormat:gt,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[3],type:[Ue]}],[po,{textureFormat:gt,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[3],type:[ft]}],[yo,{textureFormat:gt,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[6],type:[Pt]}],[Ro,{textureFormat:gt,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[6],type:[Wt]}],[_o,{textureFormat:gt,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[yt]}],[go,{textureFormat:gt,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[Yt]}],[Fo,{textureFormat:Ke,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[Ue]}],[Mo,{textureFormat:Ke,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[Ue]}],[So,{textureFormat:Ke,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[4],type:[ft]}],[Io,{textureFormat:Ke,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,2,4],type:[Ue,Or,_n]}],[Bo,{textureFormat:Ke,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,2],type:[Ue,Lr]}],[wo,{textureFormat:Ke,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[_n]}],[Dr,{textureFormat:Ke,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[16,8],type:[He,lt]}],[Cr,{textureFormat:Ke,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[16],type:[He]}],[Po,{textureFormat:bt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Ue]}],[Uo,{textureFormat:bt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[ft]}],[No,{textureFormat:bt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[_n]}],[vo,{textureFormat:bt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[Pt]}],[Do,{textureFormat:bt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[Wt]}],[Co,{textureFormat:bt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[16],type:[Yt]}],[Lo,{textureFormat:bt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[16],type:[yt]}],[Oo,{textureFormat:yn,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[2,4],type:[Pt,yt]}],[zo,{textureFormat:yn,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[yt]}],[$o,{textureFormat:yn,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[He]}],[Go,{textureFormat:Mr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Yo]}],[ko,{textureFormat:Mr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Wo]}]]);a.forEach(R=>{R.bytesPerElementMap={},R.bytesPerElement.forEach(function(M,N){const k=R.type[N];R.bytesPerElementMap[k]=M})});const b=new Map;return a.forEach((R,M)=>{Sr.has(M)?R.type.forEach(N=>{b.set(wt(M,N),R)}):b.set(wt(M),R)}),{textureInternalFormatInfoMap:a,internalFormatStringToFormatInfoMap:b}}function Ht(a){return(a&a-1)===0}function gn(a,b=0,R=0){return(Math.log2(Math.max(a,b,R))|0)+1}function qt(a,...b){return a?b:[]}function kr(a,b){return[...qt(!Ht(a),`width(${a}) is not a power of 2`),...qt(!Ht(b),`height(${b}) is not a power of 2`)].join(" and ")}function Qo(a,b){return[...qt(a!==kt,`TEXTURE_WRAP_S (${f(a)}) is not CLAMP_TO_EDGE`),...qt(b!==kt,`TEXTURE_WRAP_T (${f(b)}) is not CLAMP_TO_EDGE`)].join(" and ")}function Ho(a){const b=f(a);return b.endsWith("UI")?"unsigned int":b.endsWith("I")?"int":"float/normalized"}function Gr(a,b,R,M){return a===bn||a===At?`${b}x${R}`:`${b}x${R}x${M}`}class qo{constructor(b,R){this.redundantStateSetting=R;const M=e(b),N=!M,k=new Set,W=new Map,G=new Map,j=Xi(b),L=gn(b.getParameter(b.MAX_TEXTURE_SIZE)),{internalFormatStringToFormatInfoMap:K}=jo();let de=0,Se=j[0];this.numTextureUnits=j.length;function Ne($){$.notRenderable=ve($,$.parameters)}function Ie(){W.forEach(Ne)}function ve($,V){const{type:w,mips:B}=$,O=V.get($t)||0,ee=Jn(V.get(pr),L);if(ee<O)return`TEXTURE_MAX_LEVEL(${ee}) is less than TEXTURE_BASE_LEVEL(${O})`;const Q=B[O];if(!Q)return"no base level mip ${baseLevel}";const ae=Q[0];if(!ae)return"TEXTURE_CUBE_MAP_POSITIVE_X face does not exist";const{width:re,height:se,depth:De,internalFormatString:Re}=ae,Ye=w===At?6:1,Ce=V.get(br),mt=K.get(Re);if(mt&&!mt.textureFilterable){if(Ce!==pn)return`texture of type (${Re}) is not filterable but TEXTURE_MIN_FILTER is set to ${f(Ce)}`;{const $e=V.get(Tr);if($e!==pn)return`texture of type (${Re}) is not filterable but TEXTURE_MAG_FILTER is set to ${f($e)}`}}const rt=Ce===Fr||Ce===pn?1:gn(re,se,De);{let Be=re,$e=se,st=De;const Je=Math.min(ee,O+rt-1);for(let Te=O;Te<=Je;++Te){const pt=B[Te];if(!pt)return`filtering is set to use mips from level ${O} to ${Je} with (TEXTURE_MIN_FILTER = ${f(Ce)}) but mip level ${Te} does not exist`;for(let ht=0;ht<Ye;++ht){const et=pt[ht];if(!et)return`filtering is set to use mips level ${O} to ${Je} with (TEXTURE_MIN_FILTER = ${f(Ce)}) but mip level ${Te}${Rn(ht,w)} does not exist`;if(et.width!==Be||et.height!==$e||et.depth!==st)return`mip level ${Te}${Rn(ht,w)} needs to be ${Gr(w,Be,$e,st)} but it is ${Gr(w,et.width,et.height,et.depth)}`;if(et.internalFormatString!==Re)return`mip level ${Te}${Rn(ht,w)}'s internal format ${et.internalFormatString} does not match mip level ${O}'s internal format ${Re}`}Be=Math.max(1,Be/2|0),$e=Math.max(1,$e/2|0),w!==gr&&(st=Math.max(1,st/2|0))}}if(N&&(!Ht(re)||!Ht(se))){if(rt>1)return`texture's ${kr(re,se)} but TEXTURE_MIN_FILTER (${f(Ce)}) is set to need mips`;const Be=V.get(yr),$e=V.get(Rr);if(Be!==kt||$e!==kt)return`texture's ${kr(re,se)} but ${Qo(Be,$e)}.`}if(w===At&&re!==se)return`texture is CUBE_MAP but dimensions ${re}x${se} are not square`}function ye($){const V=cr($),w=Se.get(V);return W.get(w)}function ot($,V){const w=ye($),B=Ir.get($);return w.mips[V][B]}function nt($,V,w){const B=ye($);B.parameters.set(V,w),Ne(B)}function Tt($,V){for(let w=0;w<j.length;++w){const B=j[w];B.get($)===V&&B.set($,null)}}function ne($){const{mips:V,parameters:w}=$,B=w.get($t)||0,O=V[B];if(!O)return"";const ee=O[0];return ee?ee.internalFormatString:""}function be($,V){const w=k.has(V);[Ke,qe,Vt,Xt,Gt].forEach(B=>{K.set(wt(B,$),{textureFormat:b.RGBA,textureFilterable:w})})}function Zt($){for(const V of $){const w=K.get(wt(V));w.textureFilterable=!0}}this.addExtension=function($){switch(k.add($),$){case"oes_texture_float":be(He,"oes_texture_float_linear");break;case"oes_texture_float_linear":M?Zt([wr,Ur,vr,Cr]):k.has("oes_texture_float")&&be(He,"oes_texture_float_linear"),Ie();break;case"oes_texture_half_float":be(lt,"oes_texture_half_float_linear"),be($r,"oes_texture_half_float_linear");break;case"oes_texture_half_float_linear":M?Zt([Br,Pr,Nr,Dr]):k.has("oes_texture_half_float")&&(be(lt,"oes_texture_half_float_linear"),be($r,"oes_texture_half_float_linear")),Ie();break;default:return}},this.getTextureForTextureUnit=function($,V){return j[$].get(V)},this.getTextureUnitUnrenderableReason=function($,V,w,B){const O=j[V].get(w);if(!O)return`no texture bound to texture unit ${V} ${w}`;const ee=W.get(O),{mips:Q,parameters:ae}=ee,re=ae.get($t)||0,se=Q[re];if(!se)return`no mip level ${re}`;const De=se[0];if(!De)return`TEXTURE_CUBE_MAP_POSITIVE_X face at mip level ${re} does not exist`;const Re=Ho(De.internalFormat),Ye=gi($);if(Re!==Ye)return`uniform ${ar($)} needs a ${Ye} texture but ${B(O)} on texture unit ${V} is ${Re} texture (${ne(ee)})`;const Ce=j[V].get("SAMPLER");if(Ce){const mt=G.get(Ce),rt=ve(ee,mt);return rt&&`${rt} with sampler ${B(Ce)} bound to texture unit ${V}`}else return ee.notRenderable};function ze($,V,w,B,O,ee,Q=0){const ae=wt(w,Q),re=ye($),{mips:se}=re;se[V]||(se[V]=[]);const De=Ir.get($);se[V][De]={width:B,height:O,depth:ee,internalFormatString:ae,internalFormat:w,type:Q},Ne(re)}this.postChecks={activeTexture($,V,w){de=w[0]-Wi,Se=j[de]},bindTexture($,V,w){const[B,O]=w,ee=cr(B);if(Se.get(ee)===O)++R.bindTexture;else if(Se.set(ee,O),O){const Q=W.get(O);if(Q.type){if(Q.type!==B)throw new Error("should never get here")}else Q.type=B}},createTexture($,V,w,B){const O={mips:[],parameters:new Map([[br,Yi],[Tr,Fr],[yr,_r],[Rr,_r]]),renderable:!1};W.set(B,O)},deleteTexture($,V,w){const[B]=w,{type:O}=W.get(B);W.delete(B),Tt(O,B)},createSampler($,V,w,B){G.set(B,new Map)},deleteSampler($,V,w){const[B]=w;G.delete(B),Tt("SAMPLER",B)},bindSampler($,V,w){const[B,O]=w;O===j[B].get("SAMPLER")?++R.bindSampler:j[B].set("SAMPLER",O)},samplerParameteri($,V,w){const[B,O,ee]=w;G.get(B).set(O,ee)},copyTexImage2D($,V,w){const[B,O,ee,Q,ae]=w,re=$.UNSIGNED_BYTE;ze(B,O,ee,Q,ae,1,re)},texImage2D($,V,w){const B=ji.get(w.length),{target:O,level:ee,internalFormat:Q,width:ae,height:re,type:se}=B(w);ze(O,ee,Q,ae,re,1,se)},texImage3D($,V,w){const[B,O,ee,Q,ae,re,,,se]=w;ze(B,O,ee,Q,ae,re,se)},texStorage2D($,V,w){const[B,O,ee,Q,ae]=w;let re=Q,se=ae;const De=B===At?Hi:Qi;for(let Re=0;Re<O;++Re){for(const Ye of De)ze(Ye,Re,ee,re,se,1);re=Math.max(1,re/2|0),se=Math.max(1,se/2|0)}},texStorage3D($,V,w){const[B,O,ee,Q,ae,re]=w;let se=Q,De=ae,Re=re;for(let Ye=0;Ye<O;++Ye)ze(B,Ye,ee,se,De,Re),se=Math.max(1,se/2|0),De=Math.max(1,De/2|0),B===Tn&&(Re=Math.max(1,Re/2|0))},generateMipmap($,V,w){const[B]=w,O=ye(B),{parameters:ee}=O,Q=ee.get($t)||0,ae=Jn(ee.get(pr),L),re=ot(B,Q),{width:se,height:De,depth:Re,internalFormat:Ye,type:Ce}=re,mt=Math.min(gn(se,De,Re),ae+1-Q),rt=B===At?6:1;let Be=se,$e=De,st=Re;for(let Je=0;Je<mt;++Je){Be=Math.max(1,Be/2|0),$e=Math.max(1,$e/2|0),B===Tn&&(st=Math.max(1,st/2|0));for(let Te=0;Te<rt;++Te){const pt=B===At?zt+Te:B;ze(pt,Q+Je,Ye,Be,$e,st,Ce)}}},compressedTexImage2D($,V,w){const[B,O,ee,Q,ae]=w;ze(B,O,ee,Q,ae,1)},compressedTexImage3D($,V,w){const[B,O,ee,Q,ae,re]=w;ze(B,O,ee,Q,ae,re)},texParameteri($,V,w){const[B,O,ee]=w;nt(B,O,ee)}}}}class Vr{constructor(b){this.elementAttribArray=null,this.attribs=[];for(let R=0;R<b;++R)this.attribs.push({size:0,type:0,normalize:!1,stride:0,offset:0,divisor:0,buffer:null,iPointer:!1})}setElementArrayBuffer(b,R){ut(this.elementAttribArray,R)?++b.bindBuffer:this.elementAttribArray=ct(R)}setAttrib(b,R,M,N,k,W,G,j,L){const K=this.attribs[M];ut(K.buffer,L)&&K.iPointer===R&&K.size===N&&K.type===k&&K.normalize===W&&K.stride===G&&K.offset===j?++b.vertexAttribPointer:Object.assign(K,{iPointer:R,size:N,type:k,normalize:W,stride:G,offset:j,buffer:ct(L)})}}class Ko{constructor(b,R){this.gl=b,this.redundantStateSetting=R,this.numAttribs=b.getParameter(b.MAX_VERTEX_ATTRIBS),this.vertexArrays=new WeakMap,this.defaultVertexArray=new Vr(this.numAttribs),this.currentVertexArray=this.defaultVertexArray;const M=(W,G,j,L)=>{this.vertexArrays.set(L,new Vr(this.numAttribs))},N=(W,G,j)=>{const[L]=j,K=this.vertexArrays.get(L);this.currentVertexArray===K&&(this.currentVertexArray=this.defaultVertexArray),this.vertexArrays.delete(L)},k=(W,G,j)=>{let[L]=j;L=L?this.vertexArrays.get(L):this.defaultVertexArray,L===this.currentVertexArray?++this.redundantStateSetting.bindVertexArray:this.currentVertexArray=L};this.postChecks={createVertexArray:M,createVertexArrayOES:M,bindVertexArray:k,bindVertexArrayOES:k,bindBuffer:(W,G,j)=>{const[L,K]=j;L===b.ELEMENT_ARRAY_BUFFER&&this.currentVertexArray.setElementArrayBuffer(this.redundantStateSetting,K)},deleteVertexArray:N,deleteVertexArrayOES:N,vertexAttribPointer:(W,G,j)=>{const[L,K,de,Se,Ne,Ie]=j,ve=this.gl;this.currentVertexArray.setAttrib(this.redundantStateSetting,!1,L,K,de,Se,Ne,Ie,ve.getParameter(ve.ARRAY_BUFFER_BINDING))},vertexAttribIPointer:(W,G,j)=>{const[L,K,de,Se,Ne]=j,Ie=this.gl;this.currentVertexArray.setAttrib(this.redundantStateSetting,!0,L,K,de,!1,Se,Ne,Ie.getParameter(Ie.ARRAY_BUFFER_BINDING))}}}}const Xr=o(["COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","STENCIL_BUFFER_BIT"]);function Kt(a,b){Array.isArray(a[b])&&(a[b]=Object.fromEntries(a[b].map(R=>[Math.abs(R),R])))}function Zo(a,b,R,M){const N=R[0],k=M.locationsToNamesMap.get(N),W=a.getParameter(a.CURRENT_PROGRAM),G=[];if(k&&G.push(`trying to set uniform '${k}'`),W){const j=M.webglObjectToNamesMap.get(W);j&&G.push(`on WebGLProgram(${s(j)})`)}else G.push("on ** no current program **");return G.length?`: ${G.join(" ")}`:""}function Wr(a){if(Array.isArray(a)||n(a)||typeof a!="object")throw new Error("not a WebGLObject")}function Jo(){return{elementArrayBuffer:null,vertexAttribs:[]}}const Fn=new Set,Yr={useProgram:0,bindBuffer:0,bindFramebuffer:0,bindRenderbuffer:0,bindSampler:0,bindTexture:0,bindVertexArray:0,enableDisable:0,vertexAttribPointer:0};function jr(a,b,R={}){if(Fn.has(a))return a;Fn.add(a);const M=R.origGLErrorFn||a.getError;h(a);function N(u){const E=Jo(),m={...Yr},d={};for(const _ in u){const S=u[_];d[_]=typeof S=="function"?function(...P){return S.call(u,...P)}:S}const T={baseContext:u,config:R,apis:{gman_debug_helper:{ctx:{tagObject(_,S){Wr(_),T.webglObjectToNamesMap.set(_,S)},untagObject(_){Wr(_),T.webglObjectToNamesMap.delete(_)},getTagForObject(_){return T.webglObjectToNamesMap.get(_)},disable(){B()},setConfiguration(_){for(const[S,P]of Object.entries(_)){if(!(S in T.config))throw new Error(`unknown configuration option: ${S}`);T.config[S]=P}for(const S of T.config.ignoreUniforms)T.ignoredUniforms.add(S)},getAndResetRedundantCallInfo(){const _={...m};if(Object.assign(m,Yr),this._checksRemoved)for(const S of Object.keys(_))_[S]="invalid is webgl-lint is no longer running. maxDrawCalls exceeded";return _}}}},idCounts:{},textureManager:new qo(d,m),vertexArrayManager:new Ko(d,m),bufferToIndices:new Map,ignoredUniforms:new Set,locationsToNamesMap:new Map,webglObjectToNamesMap:new Map,programToUnsetUniformsMap:new Map,programToUniformInfoMap:new Map,programToLocationsMap:new Map,programToUniformSamplerValues:new Map,defaultVertexArray:E,webglState:{currentProgram:null,buffers:{},currentReadFramebuffer:null,currentDrawFramebuffer:null,currentRenderbuffer:null,textureUnits:[],enabled:{}},redundantStateSetting:m};return T}const k=R.sharedState||N(a);R.sharedState=k;const{apis:W,baseContext:G,bufferToIndices:j,config:L,ignoredUniforms:K,locationsToNamesMap:de,programToLocationsMap:Se,programToUniformInfoMap:Ne,programToUniformSamplerValues:Ie,programToUnsetUniformsMap:ve,textureManager:ye,vertexArrayManager:ot,webglObjectToNamesMap:nt,idCounts:Tt,webglState:ne,redundantStateSetting:be}=k;({oes_texture_float(...u){ye.addExtension(...u)},oes_texture_float_linear(...u){ye.addExtension(...u)},OES_texture_half_float(...u){ye.addExtension(...u)},oes_texture_half_float_linear(...u){ye.addExtension(...u)}}[b]||ee)(b);const ze={enable:{1:{enums:[0]}},disable:{1:{enums:[0]}},getParameter:{1:{enums:[0]}},drawArrays:{3:{enums:[0],numbers:[1,2]}},drawElements:{4:{enums:[0,2],numbers:[1,3]}},drawArraysInstanced:{4:{enums:[0],numbers:[1,2,3]}},drawElementsInstanced:{5:{enums:[0,2],numbers:[1,3,4]}},drawRangeElements:{6:{enums:[0,4],numbers:[1,2,3,5]}},createShader:{1:{enums:[0]}},getActiveAttrib:{2:{numbers:[1]}},getActiveUniform:{2:{numbers:[1]}},getShaderParameter:{2:{enums:[1]}},getProgramParameter:{2:{enums:[1]}},getShaderPrecisionFormat:{2:{enums:[0,1]}},bindAttribLocation:{3:{numbers:[1]}},getVertexAttrib:{2:{enums:[1],numbers:[0]}},vertexAttribPointer:{6:{enums:[2],numbers:[0,1,4,5]}},vertexAttribIPointer:{5:{enums:[2],numbers:[0,1,3,4]}},vertexAttribDivisor:{2:{numbers:[0,1]}},disableVertexAttribArray:{1:{numbers:[0]}},enableVertexAttribArray:{1:{numbers:[0]}},bindTexture:{2:{enums:[0],undef:[1]}},activeTexture:{1:{enums:[0,1]}},getTexParameter:{2:{enums:[0,1]}},texParameterf:{3:{enums:[0,1]}},texParameteri:{3:{enums:[0,1,2]}},texImage2D:{9:{enums:[0,2,6,7],numbers:[1,3,4,5],arrays:[-8]},6:{enums:[0,2,3,4]},10:{enums:[0,2,6,7],numbers:[1,3,4,5,9],arrays:{8:oa}}},texImage3D:{10:{enums:[0,2,7,8],numbers:[1,3,4,5]},11:{enums:[0,2,7,8],numbers:[1,3,4,5,10],arrays:{9:Sn}}},texSubImage2D:{9:{enums:[0,6,7],numbers:[1,2,3,4,5]},7:{enums:[0,4,5],numbers:[1,2,3]},10:{enums:[0,6,7],numbers:[1,2,3,4,5,9],arrays:{9:Sn}}},texSubImage3D:{11:{enums:[0,8,9],numbers:[1,2,3,4,5,6,7]},12:{enums:[0,8,9],numbers:[1,2,3,4,5,6,7,11],arrays:{10:Sn}}},texStorage2D:{5:{enums:[0,2],numbers:[1,3,4]}},texStorage3D:{6:{enums:[0,2],numbers:[1,3,4,6]}},copyTexImage2D:{8:{enums:[0,2],numbers:[1,3,4,5,6,7]}},copyTexSubImage2D:{8:{enums:[0],numbers:[1,2,3,4,5,6,7]}},copyTexSubImage3D:{9:{enums:[0],numbers:[1,2,3,4,5,6,7,8]}},generateMipmap:{1:{enums:[0]}},compressedTexImage2D:{7:{enums:[0,2],numbers:[1,3,4,5]},8:{enums:[0,2],numbers:[1,3,4,5,7]},9:{enums:[0,2],numbers:[1,3,4,5,7,8]}},compressedTexSubImage2D:{8:{enums:[0,6],numbers:[1,2,3,4,5]},9:{enums:[0,6],numbers:[1,2,3,4,5,8]},10:{enums:[0,6],numbers:[1,2,3,4,5,8,9]}},compressedTexImage3D:{8:{enums:[0,2],numbers:[1,3,4,5,6]},9:{enums:[0,2],numbers:[1,3,4,5,6,-7,8]},10:{enums:[0,2],numbers:[1,3,4,5,6,8,9]}},compressedTexSubImage3D:{12:{enums:[0,8],numbers:[1,2,3,4,5,6,7,8,10,11]},11:{enums:[0,8],numbers:[1,2,3,4,5,6,7,8,-9,10]},10:{enums:[0,8],numbers:[1,2,3,4,5,6,7,8]}},bindBuffer:{2:{enums:[0],undef:[1]}},bufferData:{3:{enums:[0,2],numbers:[-1],arrays:[-1]},4:{enums:[0,2],numbers:[-1,3],arrays:{1:Kr}},5:{enums:[0,2],numbers:[-1,3,4],arrays:{1:Zr}}},bufferSubData:{3:{enums:[0],numbers:[1],arrays:{2:ia}},4:{enums:[0],numbers:[1,3],arrays:{2:Kr}},5:{enums:[0],numbers:[1,3,4],arrays:{2:Zr}}},copyBufferSubData:{5:{enums:[0],numbers:[2,3,4]}},getBufferParameter:{2:{enums:[0,1]}},getBufferSubData:{3:{enums:[0],numbers:[1]},4:{enums:[0],numbers:[1,3]},5:{enums:[0],numbers:[1,3,4]}},pixelStorei:{2:{enums:[0,1],numbers:[1]}},readPixels:{7:{enums:[4,5],numbers:[0,1,2,3,-6]},8:{enums:[4,5],numbers:[0,1,2,3,7]}},bindRenderbuffer:{2:{enums:[0],undef:[1]}},bindFramebuffer:{2:{enums:[0],undef:[1]}},blitFramebuffer:{10:{enums:{8:Xr,9:!0},numbers:[0,1,2,3,4,5,6,7]}},checkFramebufferStatus:{1:{enums:[0]}},framebufferRenderbuffer:{4:{enums:[0,1,2]}},framebufferTexture2D:{5:{enums:[0,1,2],numbers:[4]}},framebufferTextureLayer:{5:{enums:[0,1],numbers:[3,4]}},getFramebufferAttachmentParameter:{3:{enums:[0,1,2]}},getInternalformatParameter:{3:{enums:[0,1,2]}},getRenderbufferParameter:{2:{enums:[0,1]}},invalidateFramebuffer:{2:{enums:{0:!0,1:c}}},invalidateSubFramebuffer:{6:{enums:{0:!0,1:c},numbers:[2,3,4,5]}},readBuffer:{1:{enums:[0]}},renderbufferStorage:{4:{enums:[0,1],numbers:[2,3]}},renderbufferStorageMultisample:{5:{enums:[0,2],numbers:[1,3,4]}},bindVertexBuffer:{1:{undef:[1]}},bindVertexBufferOES:{1:{undef:[1]}},lineWidth:{1:{numbers:[0]}},polygonOffset:{2:{numbers:[0,1]}},scissor:{4:{numbers:[0,1,2,3]}},viewport:{4:{numbers:[0,1,2,3]}},clear:{1:{enums:{0:Xr}}},clearColor:{4:{numbers:[0,1,2,3]}},clearDepth:{1:{numbers:[0]}},clearStencil:{1:{numbers:[0]}},depthFunc:{1:{enums:[0]}},depthRange:{2:{numbers:[0,1]}},blendColor:{4:{numbers:[0,1,2,3]}},blendFunc:{2:{enums:[0,1]}},blendFuncSeparate:{4:{enums:[0,1,2,3]}},blendEquation:{1:{enums:[0]}},blendEquationSeparate:{2:{enums:[0,1]}},stencilFunc:{3:{enums:[0],numbers:[1,2]}},stencilFuncSeparate:{4:{enums:[0,1],numberS:[2,3]}},stencilMask:{1:{numbers:[0]}},stencilMaskSeparate:{2:{enums:[0],numbers:[1]}},stencilOp:{3:{enums:[0,1,2]}},stencilOpSeparate:{4:{enums:[0,1,2,3]}},cullFace:{1:{enums:[0]}},frontFace:{1:{enums:[0]}},drawArraysInstancedANGLE:{4:{enums:[0],numbers:[1,2,3]}},drawElementsInstancedANGLE:{5:{enums:[0,2],numbers:[1,3,4]}},blendEquationEXT:{1:{enums:[0]}},drawBuffersWebGL:{1:{enums:{0:c},arrays:[0]}},drawBuffers:{1:{enums:{0:c},arrays:[0]}},clearBufferfv:{3:{enums:[0],numbers:[1],arrays:[2]},4:{enums:[0],numbers:[1,3],arrays:[2]}},clearBufferiv:{3:{enums:[0],numbers:[1],arrays:[2]},4:{enums:[0],numbers:[1,3],arrays:[2]}},clearBufferuiv:{3:{enums:[0],numbers:[1],arrays:[2]},4:{enums:[0],numbers:[1,3],arrays:[2]}},clearBufferfi:{4:{enums:[0],numbers:[1,2,3]}},uniform1f:{2:{numbers:[1]}},uniform2f:{3:{numbers:[1,2]}},uniform3f:{4:{numbers:[1,2,3]}},uniform4f:{5:{numbers:[1,2,3,4]}},uniform1i:{2:{numbers:[1]}},uniform2i:{3:{numbers:[1,2]}},uniform3i:{4:{numbers:[1,2,3]}},uniform4i:{5:{numbers:[1,2,3,4]}},uniform1fv:{2:{arrays:{1:Fe(1)}},3:{arrays:{1:ge(1)},numbers:[2]},4:{arrays:{1:_e(1)},numbers:[2,3]}},uniform2fv:{2:{arrays:{1:Fe(2)}},3:{arrays:{1:ge(2)},numbers:[2]},4:{arrays:{1:_e(2)},numbers:[2,3]}},uniform3fv:{2:{arrays:{1:Fe(3)}},3:{arrays:{1:ge(3)},numbers:[2]},4:{arrays:{1:_e(3)},numbers:[2,3]}},uniform4fv:{2:{arrays:{1:Fe(4)}},3:{arrays:{1:ge(4)},numbers:[2]},4:{arrays:{1:_e(4)},numbers:[2,3]}},uniform1iv:{2:{arrays:{1:Fe(1)}},3:{arrays:{1:ge(1)},numbers:[2]},4:{arrays:{1:_e(1)},numbers:[2,3]}},uniform2iv:{2:{arrays:{1:Fe(2)}},3:{arrays:{1:ge(2)},numbers:[2]},4:{arrays:{1:_e(2)},numbers:[2,3]}},uniform3iv:{2:{arrays:{1:Fe(3)}},3:{arrays:{1:ge(3)},numbers:[2]},4:{arrays:{1:_e(3)},numbers:[2,3]}},uniform4iv:{2:{arrays:{1:Fe(4)}},3:{arrays:{1:ge(4)},numbers:[2]},4:{arrays:{1:_e(4)},numbers:[2,3]}},uniformMatrix2fv:{3:{arrays:{2:Fe(4)}},4:{arrays:{2:ge(4)},numbers:[3]},5:{arrays:{2:_e(4)},numbers:[3,4]}},uniformMatrix3fv:{3:{arrays:{2:Fe(9)}},4:{arrays:{2:ge(9)},numbers:[3]},5:{arrays:{2:_e(9)},numbers:[3,4]}},uniformMatrix4fv:{3:{arrays:{2:Fe(16)}},4:{arrays:{2:ge(16)},numbers:[3]},5:{arrays:{2:_e(16)},numbers:[3,4]}},uniform1ui:{2:{numbers:[1]}},uniform2ui:{3:{numbers:[1,2]}},uniform3ui:{4:{numbers:[1,2,3]}},uniform4ui:{5:{numbers:[1,2,3,4]}},uniform1uiv:{2:{arrays:{1:Fe(1)}},3:{arrays:{1:ge(1)},numbers:[2]},4:{arrays:{1:_e(1)},numbers:[2,3]}},uniform2uiv:{2:{arrays:{1:Fe(2)}},3:{arrays:{1:ge(2)},numbers:[2]},4:{arrays:{1:_e(2)},numbers:[2,3]}},uniform3uiv:{2:{arrays:{1:Fe(3)}},3:{arrays:{1:ge(3)},numbers:[2]},4:{arrays:{1:_e(3)},numbers:[2,3]}},uniform4uiv:{2:{arrays:{1:Fe(4)}},3:{arrays:{1:ge(4)},numbers:[2]},4:{arrays:{1:_e(4)},numbers:[2,3]}},uniformMatrix3x2fv:{3:{arrays:{2:Fe(6)}},4:{arrays:{2:ge(6)},numbers:[3]},5:{arrays:{2:_e(6)},numbers:[3,4]}},uniformMatrix4x2fv:{3:{arrays:{2:Fe(8)}},4:{arrays:{2:ge(8)},numbers:[3]},5:{arrays:{2:_e(8)},numbers:[3,4]}},uniformMatrix2x3fv:{3:{arrays:{2:Fe(6)}},4:{arrays:{2:ge(6)},numbers:[3]},5:{arrays:{2:_e(6)},numbers:[3,4]}},uniformMatrix4x3fv:{3:{arrays:{2:Fe(12)}},4:{arrays:{2:ge(12)},numbers:[3]},5:{arrays:{2:_e(12)},numbers:[3,4]}},uniformMatrix2x4fv:{3:{arrays:{2:Fe(8)}},4:{arrays:{2:ge(8)},numbers:[3]},5:{arrays:{2:_e(8)},numbers:[3,4]}},uniformMatrix3x4fv:{3:{arrays:{2:Fe(12)}},4:{arrays:{2:ge(12)},numbers:[3]},5:{arrays:{2:_e(12)},numbers:[3,4]}},vertexAttrib1f:{2:{numbers:[0,1]}},vertexAttrib2f:{3:{numbers:[0,1,2]}},vertexAttrib3f:{4:{numbers:[0,1,2,3]}},vertexAttrib4f:{5:{numbers:[0,1,2,3,4]}},vertexAttrib1fv:{2:{numbers:[0],arrays:[1]}},vertexAttrib2fv:{2:{numbers:[0],arrays:[1]}},vertexAttrib3fv:{2:{numbers:[0],arrays:[1]}},vertexAttrib4fv:{2:{numbers:[0],arrays:[1]}},vertexAttribI4i:{5:{numbers:[0,1,2,3,4]}},vertexAttribI4iv:{2:{numbers:[0],arrays:[1]}},vertexAttribI4ui:{5:{numbers:[0,1,2,3,4]}},vertexAttribI4uiv:{2:{numbers:[0],arrays:[1]}},beginQuery:{2:{enums:[0]}},endQuery:{1:{enums:[0]}},getQuery:{2:{enums:[0,1]}},getQueryParameter:{2:{enums:[1]}},samplerParameteri:{3:{enums:[1]}},samplerParameterf:{3:{enums:[1]}},getSamplerParameter:{2:{enums:[1]}},clientWaitSync:{3:{enums:{1:o(["SYNC_FLUSH_COMMANDS_BIT"])},numbers:[2]}},fenceSync:{2:{enums:[0]}},getSyncParameter:{2:{enums:[1]}},bindTransformFeedback:{2:{enums:[0],undef:[1]}},beginTransformFeedback:{1:{enums:[0]}},bindBufferBase:{3:{enums:[0],numbers:[1]}},bindBufferRange:{5:{enums:[0],numbers:[1,3,4]}},getIndexedParameter:{2:{enums:[0],numbers:[1]}},getActiveUniforms:{3:{enums:[2]},arrays:[1]},getActiveUniformBlockParameter:{3:{enums:[2],numbers:[1]}},getActiveUniformBlockName:{2:{numbers:[1]}},transformFeedbackVaryings:{3:{enums:[2]}},uniformBlockBinding:{3:{numbers:[1,2]}}};for(const[u,E]of Object.entries(ze)){for(const m of Object.values(E))Kt(m,"enums"),Kt(m,"numbers"),Kt(m,"arrays"),Kt(m,"undef");/uniform(\d|Matrix)/.test(u)&&(E.errorHelper=Zo)}const $={},V={};function w(u){const E=Se.get(u);E&&E.forEach(m=>de.delete(m)),Se.set(u,new Set),ve.delete(u),Ne.delete(u),Ie.delete(u)}function B(){for(const{ctx:u,origFuncs:E}of Object.values(W))Object.assign(u,E),Fn.delete(u);k.apis.gman_debug_helper._checksRemoved=!0;for(const u of[...Object.keys(k)])delete k[u]}function O(u,E,m){const{vertCount:d,instances:x}=Zn(E,m);d===0&&console.warn(Jt(u,E,m,`count for ${E} is 0!`)),x===0&&console.warn(Jt(u,E,m,`instanceCount for ${E} is 0!`)),--L.maxDrawCalls,L.maxDrawCalls===0&&B()}function ee(){}function Q(u){return function(E,m,d,x){if(L.makeDefaultTags){const T=(Tt[u]||0)+1;Tt[u]=T,nt.set(x,`*UNTAGGED:${u}${T}*`)}}}function ae(u){const E=Vi(new Error().stack),m=E?`${E.url}:${E.lineNo}: ${u}`:u;if(L.throwOnError)throw new Error(m);console.error(m)}function re(u,E,m){u?ae(m):E&&console.warn(m)}function se(u){return typeof u=="number"}const De=34229;function Re(){const u=G;return typeof WebGL2RenderingContext<"u"&&u instanceof WebGL2RenderingContext||W.oes_vertex_array_object?u.getParameter(De):null}function Ye(u,E,m){if(!L.failUnsetUniforms)return;const d=ve.get(ne.currentProgram);if(d){const x=[];for(const[T,{index:_,unset:S}]of d)S.has(_)&&x.push(T);ce(u,E,m,`uniforms "${x.join('", "')}" have not been set
See docs at https://github.com/greggman/webgl-lint/ for how to turn off this check using "failUnsetUniforms": false`)}}function Ce(u,E,m){return E>1||m>1?`${u}[${m}]`:u}function mt(u,E,m){if(!L.failUnrenderableTextures)return;const d=Ie.get(ne.currentProgram),x=ye.numTextureUnits;for(const{type:T,values:_,name:S}of d){const P=_i(T);for(let D=0;D<_.length;++D){const H=_[D];if(H>=x){ce(u,E,m,`uniform ${Bt(T).name} ${Ce(S,_.length,D)} is set to ${H} which is out of range. There are only ${x} texture units`);return}const oe=ye.getTextureUnitUnrenderableReason(T,H,P,tt);if(oe){const me=ye.getTextureForTextureUnit(H,P);ce(u,E,m,me?`texture ${tt(me)} on texture unit ${H} referenced by uniform ${ar(T)} ${Ce(S,_.length,D)} is not renderable: ${oe}`:`no texture on texture unit ${H} referenced by uniform ${Ce(S,_.length,D)}`);return}}}}function rt(u,E,m){const d=Ie.get(ne.currentProgram),x=new Map;for(const{type:T,values:_,name:S}of d){const P=_[0],D=x.get(P);if(!D)x.set(P,T);else if(D!==T){ce(u,E,m,`Two textures of different types can't use the same sampler location. uniform ${Bt(T).name} ${Ce(S,_.length,0)} is not ${Bt(D).name}`);return}}}function Be(u,E,m){if(!ne.currentProgram){ce(u,E,m,"no current program");return}Ye(u,E,m),mt(u,E,m),rt(u,E,m)}function $e(u,E,m){const[d,x,T,_=0,S=0]=m,P=G.getBufferParameter(d,u.BUFFER_SIZE),D=T instanceof DataView||T instanceof ArrayBuffer,H=S||(D?T.byteLength-_:T.length-_);if(P<x+H){const oe=jn(d),me=G.getParameter(oe);ce(u,E,m,P===0?`buffer ${tt(me)} has 0 size. You need to call bufferData before calling bufferSubData.`:`buffer ${tt(me)} buffer is too small for data [bufferSize:${P} dstByteOffset(${x}) + copyLength(${H}) = ${x+H}]`)}}const st={bufferSubData:$e,drawArrays:Be,drawElements:Be,drawArraysInstanced:Be,drawElementsInstanced:Be,drawArraysInstancedANGLE:Be,drawElementsInstancedANGLE:Be,drawRangeElements:Be};function Je(u,E){if(!u){re(L.failUndefinedUniforms,L.warnUndefinedUniforms,`attempt to set non-existent uniform on ${tt(ne.currentProgram)}
See docs at https://github.com/greggman/webgl-lint/ for how to turn off this check using "warnUndefinedUniforms: false"`);return}const m=ve.get(ne.currentProgram);if(!m)return;const d=de.get(u),x=m.get(d);if(x){for(let T=0;T<E;++T)x.unset.delete(x.index+T);if(!x.unset.size){for(const[T]of x.altNames)m.delete(T);m.size||ve.delete(ne.currentProgram)}}}function Te(u){return function(E,m,d){const[x,T,_=0,S=0]=d,P=S||T.length-_;Je(x,P/u|0)}}function pt(u){return K.has(u)}function ht(u){return pt(de.get(u))}function et(u,E){const[m,d]=E;return e(u)&&u.getUniformIndices(m,[d])[0]!==u.INVALID_INDEX}function at(u){return function(E,m,d){const[x,T,_,S=0,P=0]=d,H=(P||_.length-S)/u|0;if(L.failZeroMatrixUniforms&&!ht(x))for(let oe=0;oe<H;++oe){let me=!0;const Et=S+u*oe;for(let Ge=0;Ge<u;++Ge)if(_[Et+Ge]){me=!1;break}if(me){ce(E,m,[x,T,...d],`matrix is all zeros
See docs at https://github.com/greggman/webgl-lint/ for how to turn off this check using "failZeroMatrixUniforms": false`);return}}Je(x,H)}}function ea(u){const E=Te(u);return function(m,d,x){E(m,d,x);const[T,_]=x;Hr(T,_)}}function Ze(u,E,m){const[d]=m;Je(d,1)}function ta(u,E,m){Ze(u,E,m);const[d,x]=m;Hr(d,[x])}function Hr(u,E){const m=de.get(u),d=Ne.get(ne.currentProgram),{index:x,type:T,values:_}=d.get(m);if(!Lt(T))return;const S=Math.min(E.length,_.length-x);for(let P=0;P<S;++P)_[P]=E[P]}function it(u,E,m){const[d]=m;nt.delete(d)}const na=/ERROR:\s*\d+:(\d+)/gi;function qr(u,E=""){const m=[...E.matchAll(na)],d=new Map(m.map((x,T)=>{const _=parseInt(x[1]),S=m[T+1],P=S?S.index:E.length,D=E.substring(x.index,P);return[_-1,D]}));return u.split(`
`).map((x,T)=>{const _=d.get(T);return`${T+1}: ${x}${_?`

^^^ ${_}`:""}`}).join(`
`)}const Mn={enable(u,E,m){const[d]=m;ne.enabled[d]?++be.enableDisable:ne.enabled[d]=!0},disable(u,E,m){const[d]=m;ne.enabled[d]?ne.enabled[d]=!1:++be.enableDisable},bindBuffer(u,E,m){const[d,x]=m;switch(d){case u.ELEMENT_ARRAY_BUFFER:break;default:ut(ne.buffers[d],x)?++be.bindBuffer:ne.buffers[d]=ct(x)}},bindFramebuffer(u,E,m){const[d,x]=m;switch(d){case u.READ_FRAMEBUFFER:ut(ne.currentReadFramebuffer,x)?++be.bindFramebuffer:ne.currentReadFramebuffer=ct(x);break;case u.DRAW_FRAMEBUFFER:ut(ne.currentDrawFramebuffer,x)?++be.bindFramebuffer:ne.currentDrawFramebuffer=ct(x);break;case u.FRAMEBUFFER:ut(ne.currentDrawFramebuffer,x)&&ut(ne.currentDrawFramebuffer,x)?++be.bindFramebuffer:(ne.currentDrawFramebuffer=ct(x),ne.currentReadFramebuffer=ct(x))}},bindRenderbuffer(u,E,m){const[,d]=m;ut(ne.currentRenderbuffer,d)?++be.bindRenderbuffer:ne.currentRenderbuffer=ct(d)},bufferData(u,E,m){const[d,x,,T=0,_=0]=m;if(d!==u.ELEMENT_ARRAY_BUFFER)return;const S=G.getParameter(u.ELEMENT_ARRAY_BUFFER_BINDING);if(se(x))j.set(S,new ArrayBuffer(x));else{const P=x instanceof DataView,D=_||(P?x.byteLength-T:x.length-T),H=P?1:x.BYTES_PER_ELEMENT,oe=D*H,me=x.buffer?x.buffer:x,Ge=(x.byteOffset||0)+T*H;j.set(S,me.slice(Ge,Ge+oe))}},bufferSubData(u,E,m){const[d,x,T,_=0,S=0]=m;if(d!==u.ELEMENT_ARRAY_BUFFER)return;const P=G.getParameter(u.ELEMENT_ARRAY_BUFFER_BINDING),D=j.get(P),H=new Uint8Array(D),oe=T instanceof DataView,me=S||(oe?T.byteLength-_:T.length-_),Et=oe?1:T.BYTES_PER_ELEMENT,Ge=me*Et,Nt=T.buffer?T.buffer:T,vt=(T.byteOffset||0)+_*Et,dt=new Uint8Array(Nt,vt,Ge);H.set(dt,x)},compileShader(u,E,m){if(!L.failBadShadersAndPrograms)return;const[d]=m;if(!G.getShaderParameter(d,u.COMPILE_STATUS)){const T=G.getShaderInfoLog(d),_=qr(G.getShaderSource(d),T),S=G.getShaderParameter(d,u.SHADER_TYPE),P=`failed to compile ${f(S)}: ${T}
------[ shader source ]------
${_}`;ce(u,E,m,P)}},createBuffer:Q("Buffer"),createFramebuffer:Q("Framebuffer"),createProgram:Q("Program"),createQuery:Q("Query"),createRenderbuffer:Q("Renderbuffer"),createShader:Q("Shader"),createTexture:Q("Texture"),createTransformFeedback:Q("TransformFeedback"),createSampler:Q("Sampler"),createVertexArray:Q("VertexArray"),createVertexArrayOES:Q("VertexArray"),drawArrays:O,drawElements:O,drawArraysInstanced:O,drawElementsInstanced:O,drawArraysInstancedANGLE:O,drawElementsInstancedANGLE:O,drawRangeElements:O,fenceSync:Q("Sync"),uniform1f:Ze,uniform2f:Ze,uniform3f:Ze,uniform4f:Ze,uniform1i:ta,uniform2i:Ze,uniform3i:Ze,uniform4i:Ze,uniform1fv:Te(1),uniform2fv:Te(2),uniform3fv:Te(3),uniform4fv:Te(4),uniform1iv:ea(1),uniform2iv:Te(2),uniform3iv:Te(3),uniform4iv:Te(4),uniformMatrix2fv:at(4),uniformMatrix3fv:at(9),uniformMatrix4fv:at(16),uniform1ui:Ze,uniform2ui:Ze,uniform3ui:Ze,uniform4ui:Ze,uniform1uiv:Te(1),uniform2uiv:Te(2),uniform3uiv:Te(3),uniform4uiv:Te(4),uniformMatrix3x2fv:at(6),uniformMatrix4x2fv:at(8),uniformMatrix2x3fv:at(6),uniformMatrix4x3fv:at(12),uniformMatrix2x4fv:at(8),uniformMatrix3x4fv:at(12),getSupportedExtensions(u,E,m,d){d.push("GMAN_debug_helper")},getUniformLocation(u,E,m,d){const[x,T]=m;d?(de.set(d,T),Se.get(x).add(d)):!pt(T)&&!et(u,m)&&ca(u,E,m,`uniform '${T}' does not exist in ${tt(x)}`,L.failUndefinedUniforms,L.warnUndefinedUniforms)},linkProgram(u,E,m){const[d]=m;if(G.getProgramParameter(d,u.LINK_STATUS)){w(d);const T=new Map,_=new Map,S=[],P=G.getProgramParameter(d,u.ACTIVE_UNIFORMS);for(let D=0;D<P;++D){const{name:H,type:oe,size:me}=a.getActiveUniform(d,D);if(t(H)||!G.getUniformLocation(d,H))continue;const Ge=new Map([[H,0]]),Nt=H.endsWith("[0]");let Ft=H;if(Nt&&(Ft=H.substr(0,H.length-3),Ge.set(Ft,0)),me>1)for(let ke=0;ke<me;++ke)Ge.set(`${Ft}[${ke}]`,ke);const vt=(!Lt(oe)||L.failUnsetSamplerUniforms)&&!K.has(H),dt=Lt(oe)?new Array(me).fill(0):void 0;dt&&S.push({type:oe,values:dt,name:Ft});const Bn=new Set(ma(0,me));for(const[ke,Jr]of Ge)vt&&T.set(ke,{index:Jr,unset:Bn,altNames:Ge}),_.set(ke,{index:Jr,type:oe,size:me,...dt&&{values:dt}})}Ie.set(d,S),Ne.set(d,_),T.size&&ve.set(d,T)}else if(L.failBadShadersAndPrograms){const _=G.getAttachedShaders(d).map(D=>{const H=qr(G.getShaderSource(D)),oe=G.getShaderParameter(D,u.SHADER_TYPE);return`-------[ ${f(oe)} ${tt(D)} ]-------
${H}`}).join(`
`),P=`failed to link program: ${G.getProgramInfoLog(d)}
${_}`;ce(u,E,m,P)}},useProgram(u,E,m){const[d]=m;ne.currentProgram===d?++be.useProgram:ne.currentProgram=d},deleteProgram(u,E,m){const[d]=m;ne.currentProgram===d&&(ne.currentProgram=void 0),w(d)},deleteBuffer(u,E,m){const[d]=m;j.delete(d)},deleteFramebuffer:it,deleteRenderbuffer:it,deleteTexture:it,deleteShader:it,deleteQuery:it,deleteSampler:it,deleteSync:it,deleteTransformFeedback:it,deleteVertexArray:it,deleteVertexArrayOES:it};[ye,ot].forEach(u=>{Object.entries(u.postChecks).forEach(([E,m])=>{const d=Mn[E]||ee;Mn[E]=function(...x){d(...x),L.failUnrenderableTextures&&m(...x)}})});function tt(u){const E=nt.get(u)||"*unnamed*";return`${u.constructor.name}(${s(E)})`}function ra(u){return j.get(u)}function sa(u,E,m,d,x){const T=nt.get(x);if(T)return`${x.constructor.name}("${T}")`;if(x instanceof WebGLUniformLocation)return`WebGLUniformLocation("${de.get(x)}")`;const _=ze[E];if(_!==void 0){const S=_[m];if(S!==void 0){const P=S.enums;if(P){const D=P[d];if(D!==void 0){if(typeof D=="function")return D(u,x);if(!E.startsWith("bind")&&d===0){const H=jn(x);if(H){const oe=G.getParameter(H);if(oe)return`${f(x)}{${tt(oe)}}`}}return f(x)}}}}return x===null?"null":x===void 0?"undefined":Array.isArray(x)||n(x)?x.length<=32?`[${Array.from(x.slice(0,32)).join(", ")}]`:`${x.constructor.name}(${x.length!==void 0?x.length:x.byteLength})`:x.toString()}function Ut(u,E,m,d,x,T,_){if(!n(d)){ce(u,E,m,`argument ${x} must be a TypedArray`);return}if(!r(d))return;const S=T,P=T+_;for(let D=S;D<P;++D)if(d[D]===void 0){ce(u,E,m,`element ${D} of argument ${x} is undefined`);return}else if(isNaN(d[D])){ce(u,E,m,`element ${D} of argument ${x} is NaN`);return}}function Sn(u,E,m,d,x){const T=m[m.length-1],_=d.length-T;Ut(u,E,m,d,x,T,_)}function ia(u,E,m,d,x){if(n(d)&&r(d)){const _=d.length-0;Ut(u,E,m,d,x,0,_)}else Array.isArray(d)&&ce(u,E,m,`argument ${x} is not an ArrayBufferView or ArrayBuffer`)}function Kr(u,E,m,d,x){if(n(d)&&r(d)){const T=m[m.length-1],_=d.length-T;Ut(u,E,m,d,x,T,_)}else Array.isArray(d)&&ce(u,E,m,`argument ${x} is not an ArrayBufferView or ArrayBuffer`)}function Zr(u,E,m,d,x){if(n(d)&&r(d)){const T=m[m.length-2],_=m[m.length-1];Ut(u,E,m,d,x,T,_)}else Array.isArray(d)&&ce(u,E,m,`argument ${x} is not an ArrayBufferView or ArrayBuffer`)}function oa(u,E,m,d,x){if(Array.isArray(d)||n(d)){const T=m[m.length-1],_=d.length-T;Ut(u,E,m,d,x,T,_)}}function In(u,E,m,d,x,T,_,S){const P=m[0];if(!P)return;const D=Ne.get(ne.currentProgram);if(!D)return;const H=de.get(P),{type:oe,size:me,index:Et}=D.get(H),Ge=Bt(oe).size;S!==Ge&&ce(u,E,m,`uniform "${H}" is ${Bt(oe).name} which is wrong for ${E}`);const Nt=me-Et,vt=Math.min(_/S|0,Nt)*S,dt=T,Bn=T+vt;for(let ke=dt;ke<Bn;++ke)if(d[ke]===void 0){ce(u,E,m,`element ${ke} of argument ${x} is undefined`);return}else if(ua(d[ke])){ce(u,E,m,`element ${ke} of argument ${x} is an array. WebGL expects flat arrays`);return}else if(isNaN(d[ke])){ce(u,E,m,`element ${ke} of argument ${x} is NaN`);return}}function _e(u){return function(E,m,d,x,T){const _=d[d.length-2],S=d[d.length-1];In(E,m,d,x,T,_,S,u)}}function ge(u){return function(E,m,d,x,T){const _=d[d.length-1],S=x.length-_;In(E,m,d,x,T,_,S,u)}}function Fe(u){return function(E,m,d,x,T){const S=x.length;In(E,m,d,x,T,0,S,u)}}function aa(u,E,m){const d=m.length;return m.map(function(T,_){let S=sa(u,E,d,_,T);return S.length>200&&(S=S.substring(0,200)+"..."),S}).join(", ")}function Jt(u,E,m,d){const x=G,T=[d],_=ze[E];if(_&&_.errorHelper&&T.push(_.errorHelper(u,E,m,k)),E.includes("draw")){const P=x.getParameter(x.CURRENT_PROGRAM);P?T.push(`with ${tt(P)} as current program`):T.push("no shader program in use!")}if(E.includes("vertexAttrib")||xn(E)){const P=Re(),D=nt.get(P),H=`WebGLVertexArrayObject(${s(D||"*unnamed*")})`;T.push(`with ${P?H:"the default vertex array"} bound`)}const S=aa(u,E,m);return`error in ${E}(${S}): ${T.join(`
`)}`}function ca(u,E,m,d,x,T){re(x,T,Jt(u,E,m,d))}function ce(u,E,m,d){ae(Jt(u,E,m,d))}const ua=u=>Array.isArray(u)||n(u);function Aa(u,E,m){const d=ze[E];if(d){const x=d[m.length];if(x){const{numbers:T={},arrays:_={},undef:S={}}=x;for(let P=0;P<m.length;++P){const D=m[P];if(D===void 0&&!S[P]){ce(u,E,m,`argument ${P} is undefined`);return}if(T[P]!==void 0){if(T[P]>=0){if(typeof D!="number"&&!(D instanceof Number)&&D!==!1&&D!==!0||isNaN(D)){ce(u,E,m,`argument ${P} is not a number`);return}}else if(!(D instanceof Object)&&isNaN(D)){ce(u,E,m,`argument ${P} is NaN`);return}}const H=_[P];if(H!==void 0){const oe=Array.isArray(D)||n(D);if(H>=0&&!oe){ce(u,E,m,`argument ${P} is not an array or typedarray`);return}if(oe&&r(D)){if(typeof H=="function")H(u,E,m,D,P);else for(let me=0;me<D.length;++me)if(D[me]===void 0){ce(u,E,m,`element ${me} of argument ${P} is undefined`);return}else if(isNaN(D[me])){ce(u,E,m,`element ${me} of argument ${P} is NaN`);return}}}}}else{ce(u,E,m,`no version of function '${E}' takes ${m.length} arguments`);return}}}const fa={getExtension(u,E){const m=u[E];u[E]=function(...d){const x=d[0].toLowerCase(),T=W[x];if(T)return T.ctx;const _=m.call(u,...d);return _&&jr(_,x,{...R,origGLErrorFn:M}),_}}};function la(u,E){const m=u[E],d=st[E]||ee,x=Mn[E]||ee;u[E]=function(..._){if(d(u,E,_),Aa(u,E,_),ne.currentProgram&&xn(E)){const H=hi(G,E,_,tt,ra);H.length&&ce(u,E,_,H.join(`
`))}const S=m.call(u,..._),P=G,D=M.call(P);if(D!==0){$[D]=!0;const H=[f(D)];xn(E)&&ne.currentProgram&&H.push(...ki(P,tt)),ce(u,E,_,H.join(`
`))}else x(u,E,_,S);return S};const T=fa[E];T&&T(u,E,M)}function ma(u,E){const m=[];for(let d=u;d<E;++d)m.push(d);return m}for(const u in a)typeof a[u]=="function"&&(V[u]=a[u],la(a,u));a.getError&&(a.getError=function(){for(const u of Object.keys($))if($[u])return $[u]=!1,u;return a.NO_ERROR}),W[b.toLowerCase()]={ctx:a,origFuncs:V}}console.log("webgl-lint running");function Qr(a){const b=a.prototype.getContext;a.prototype.getContext=function(R,...M){const N=b.call(this,R,...M);if(N&&N.bindTexture){jr(N,R,{maxDrawCalls:1e3,throwOnError:!0,failBadShadersAndPrograms:!0,failUnsetUniforms:!0,failUnsetSamplerUniforms:!1,failZeroMatrixUniforms:!0,failUnrenderableTextures:!0,failUndefinedUniforms:!1,warnUndefinedUniforms:!0,makeDefaultTags:!0,ignoreUniforms:[]});const W=N.getExtension("GMAN_debug_helper");document.querySelectorAll("[data-gman-debug-helper]").forEach(G=>{const j=G.dataset.gmanDebugHelper;let L;try{L=JSON.parse(j)}catch(K){throw K.message+=`
${j}
failed to parse data-gman-debug-helper as JSON in: ${G.outerHTML}`,K}L&&W.setConfiguration(L)})}return N}}typeof HTMLCanvasElement<"u"&&Qr(HTMLCanvasElement),typeof OffscreenCanvas<"u"&&Qr(OffscreenCanvas)});class ha{constructor(){this.setAction=(e,n)=>{const r=this.actions.get(e);r.justPressed=n&&!r.down,r.down=n,this.actions.set(e,r)},this.addKeyAction=(e,n)=>(this.keys.set(e,n),this.actions.get(n)||this.actions.set(n,{down:!1,justPressed:!1}),this),this.addButtonAction=(e,n)=>(this.buttons.set(e,n),this.actions.get(n)||this.actions.set(n,{down:!1,justPressed:!1}),this),this.setKeyFromKeyCode=(e,n)=>{const r=this.keys.get(e);return r?(this.setAction(r,n),!0):(n&&console.log(e),!1)},this.keys=new Map,this.actions=new Map,this.buttons=new Map,this.addKeyAction("a","left"),this.addKeyAction("d","right"),this.addKeyAction("w","forward"),this.addKeyAction("s","back"),this.addKeyAction("f","flashlight"),this.addButtonAction(5,"flashlight"),this.addButtonAction(4,"sprint"),this.addKeyAction("shift","sprint"),window.addEventListener("keydown",e=>{this.setKeyFromKeyCode(e.key.toLowerCase(),!0)&&e.preventDefault()}),window.addEventListener("keyup",e=>{this.setKeyFromKeyCode(e.key.toLowerCase(),!1)&&e.preventDefault()})}getFromKey(e){return this.actions.get(this.keys.get(e))}getFromAction(e){return this.actions.get(e)}setActionFromButton(e,n){const r=this.buttons.get(e);if(!r){n&&console.log(e);return}this.setAction(r,n)}update(){this.actions.forEach(e=>{e.justPressed&&(e.justPressed=!1)})}}const es="/assets/heccinded-DGOZxDYC.png",Ea=()=>(On.useEffect(()=>{document.exitPointerLock(),document.exitFullscreen()},[]),ue.jsxs("div",{className:" relative h-[inherit] w-full",children:[ue.jsx("div",{className:"bg-cover bg-center h-[inherit] w-full",style:{backgroundImage:`url(${es})`},onClick:()=>{It("menu")}}),es]})),da={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0,_cartographicRadians:!1};globalThis.mathgl=globalThis.mathgl||{config:{...da}};const Ve=globalThis.mathgl.config;function xa(t,{precision:e=Ve.precision}={}){return t=ba(t),"".concat(parseFloat(t.toPrecision(e)))}function Mt(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function as(t,e,n){return pa(t,r=>Math.max(e,Math.min(n,r)))}function cs(t,e,n){const r=Ve.EPSILON;n&&(Ve.EPSILON=n);try{if(t===e)return!0;if(Mt(t)&&Mt(e)){if(t.length!==e.length)return!1;for(let s=0;s<t.length;++s)if(!cs(t[s],e[s]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):typeof t=="number"&&typeof e=="number"?Math.abs(t-e)<=Ve.EPSILON*Math.max(1,Math.abs(t),Math.abs(e)):!1}finally{Ve.EPSILON=r}}function ba(t){return Math.round(t/Ve.EPSILON)*Ve.EPSILON}function Ta(t){return t.clone?t.clone():new Array(t.length)}function pa(t,e,n){if(Mt(t)){const r=t;n=n||Ta(r);for(let s=0;s<n.length&&s<r.length;++s){const i=typeof t=="number"?t:t[s];n[s]=e(i,s,n)}return n}return e(t)}function ya(t){function e(){var n=Reflect.construct(t,Array.from(arguments));return Object.setPrototypeOf(n,Object.getPrototypeOf(this)),n}return e.prototype=Object.create(t.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t,e}class us extends ya(Array){clone(){return new this.constructor().copy(this)}fromArray(e,n=0){for(let r=0;r<this.ELEMENTS;++r)this[r]=e[r+n];return this.check()}toArray(e=[],n=0){for(let r=0;r<this.ELEMENTS;++r)e[n+r]=this[r];return e}toObject(e){return e}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}to(e){return e===this?this:Mt(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(Ve)}formatString(e){let n="";for(let r=0;r<this.ELEMENTS;++r)n+=(r>0?", ":"")+xa(this[r],e);return"".concat(e.printTypes?this.constructor.name:"","[").concat(n,"]")}equals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(!cs(this[n],e[n]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(this[n]!==e[n])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,n,r){if(r===void 0)return this.lerp(this,e,n);for(let s=0;s<this.ELEMENTS;++s){const i=e[s],c=typeof n=="number"?n:n[s];this[s]=i+r*(c-i)}return this.check()}min(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(e[n],this[n]);return this.check()}max(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.max(e[n],this[n]);return this.check()}clamp(e,n){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e[r]),n[r]);return this.check()}add(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]+=n[r];return this.check()}subtract(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]-=n[r];return this.check()}scale(e){if(typeof e=="number")for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;else for(let n=0;n<this.ELEMENTS&&n<e.length;++n)this[n]*=e[n];return this.check()}multiplyByScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}check(){if(Ve.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let e=this.length===this.ELEMENTS;for(let n=0;n<this.ELEMENTS;++n)e=e&&Number.isFinite(this[n]);return e}sub(e){return this.subtract(e)}setScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=e;return this.check()}addScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}divideScalar(e){return this.multiplyByScalar(1/e)}clampScalar(e,n){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e),n);return this.check()}get elements(){return this}}function Ra(t,e){if(t.length!==e)return!1;for(let n=0;n<t.length;++n)if(!Number.isFinite(t[n]))return!1;return!0}function pe(t){if(!Number.isFinite(t))throw new Error("Invalid number ".concat(JSON.stringify(t)));return t}function wn(t,e,n=""){if(Ve.debug&&!Ra(t,e))throw new Error("math.gl: ".concat(n," some fields set to invalid numbers'"));return t}function ts(t,e){if(!t)throw new Error("math.gl assertion ".concat(e))}class As extends us{get x(){return this[0]}set x(e){this[0]=pe(e)}get y(){return this[1]}set y(e){this[1]=pe(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let n=0;n<this.ELEMENTS;++n)e+=this[n]*this[n];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let n=0;for(let r=0;r<this.ELEMENTS;++r){const s=this[r]-e[r];n+=s*s}return pe(n)}dot(e){let n=0;for(let r=0;r<this.ELEMENTS;++r)n+=this[r]*e[r];return pe(n)}normalize(){const e=this.magnitude();if(e!==0)for(let n=0;n<this.ELEMENTS;++n)this[n]/=e;return this.check()}multiply(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]*=n[r];return this.check()}divide(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]/=n[r];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return ts(e>=0&&e<this.ELEMENTS,"index is out of range"),pe(this[e])}setComponent(e,n){return ts(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=n,this.check()}addVectors(e,n){return this.copy(e).add(n)}subVectors(e,n){return this.copy(e).subtract(n)}multiplyVectors(e,n){return this.copy(e).multiply(n)}addScaledVector(e,n){return this.add(new this.constructor(e).multiplyScalar(n))}}const un=1e-6;let St=typeof Float32Array<"u"?Float32Array:Array;function _a(){const t=new St(2);return St!=Float32Array&&(t[0]=0,t[1]=0),t}function ga(t,e,n){const r=e[0],s=e[1];return t[0]=n[0]*r+n[4]*s+n[12],t[1]=n[1]*r+n[5]*s+n[13],t}(function(){const t=_a();return function(e,n,r,s,i,c){let o,l;for(n||(n=2),r||(r=0),s?l=Math.min(s*n+r,e.length):l=e.length,o=r;o<l;o+=n)t[0]=e[o],t[1]=e[o+1],i(t,t,c),e[o]=t[0],e[o+1]=t[1];return e}})();function Fa(t,e,n){const r=e[0],s=e[1],i=n[3]*r+n[7]*s||1;return t[0]=(n[0]*r+n[4]*s)/i,t[1]=(n[1]*r+n[5]*s)/i,t}function fs(t,e,n){const r=e[0],s=e[1],i=e[2],c=n[3]*r+n[7]*s+n[11]*i||1;return t[0]=(n[0]*r+n[4]*s+n[8]*i)/c,t[1]=(n[1]*r+n[5]*s+n[9]*i)/c,t[2]=(n[2]*r+n[6]*s+n[10]*i)/c,t}function Ma(t,e,n){const r=e[0],s=e[1];return t[0]=n[0]*r+n[2]*s,t[1]=n[1]*r+n[3]*s,t[2]=e[2],t}function Sa(t,e,n){const r=e[0],s=e[1];return t[0]=n[0]*r+n[2]*s,t[1]=n[1]*r+n[3]*s,t[2]=e[2],t[3]=e[3],t}function Ia(t,e,n){const r=e[0],s=e[1],i=e[2];return t[0]=n[0]*r+n[3]*s+n[6]*i,t[1]=n[1]*r+n[4]*s+n[7]*i,t[2]=n[2]*r+n[5]*s+n[8]*i,t[3]=e[3],t}function Ba(){const t=new St(3);return St!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function wa(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Pa(t,e,n){const r=e[0],s=e[1],i=e[2],c=n[0],o=n[1],l=n[2];return t[0]=s*l-i*o,t[1]=i*c-r*l,t[2]=r*o-s*c,t}function zn(t,e,n){const r=e[0],s=e[1],i=e[2];let c=n[3]*r+n[7]*s+n[11]*i+n[15];return c=c||1,t[0]=(n[0]*r+n[4]*s+n[8]*i+n[12])/c,t[1]=(n[1]*r+n[5]*s+n[9]*i+n[13])/c,t[2]=(n[2]*r+n[6]*s+n[10]*i+n[14])/c,t}function Ua(t,e,n){const r=e[0],s=e[1],i=e[2];return t[0]=r*n[0]+s*n[3]+i*n[6],t[1]=r*n[1]+s*n[4]+i*n[7],t[2]=r*n[2]+s*n[5]+i*n[8],t}function ls(t,e,n){const r=n[0],s=n[1],i=n[2],c=n[3],o=e[0],l=e[1],h=e[2];let f=s*h-i*l,A=i*o-r*h,p=r*l-s*o,F=s*p-i*A,U=i*f-r*p,z=r*A-s*f;const X=c*2;return f*=X,A*=X,p*=X,F*=2,U*=2,z*=2,t[0]=o+f+F,t[1]=l+A+U,t[2]=h+p+z,t}function Na(t,e,n,r){const s=[],i=[];return s[0]=e[0]-n[0],s[1]=e[1]-n[1],s[2]=e[2]-n[2],i[0]=s[0],i[1]=s[1]*Math.cos(r)-s[2]*Math.sin(r),i[2]=s[1]*Math.sin(r)+s[2]*Math.cos(r),t[0]=i[0]+n[0],t[1]=i[1]+n[1],t[2]=i[2]+n[2],t}function va(t,e,n,r){const s=[],i=[];return s[0]=e[0]-n[0],s[1]=e[1]-n[1],s[2]=e[2]-n[2],i[0]=s[2]*Math.sin(r)+s[0]*Math.cos(r),i[1]=s[1],i[2]=s[2]*Math.cos(r)-s[0]*Math.sin(r),t[0]=i[0]+n[0],t[1]=i[1]+n[1],t[2]=i[2]+n[2],t}function Da(t,e,n,r){const s=[],i=[];return s[0]=e[0]-n[0],s[1]=e[1]-n[1],s[2]=e[2]-n[2],i[0]=s[0]*Math.cos(r)-s[1]*Math.sin(r),i[1]=s[0]*Math.sin(r)+s[1]*Math.cos(r),i[2]=s[2],t[0]=i[0]+n[0],t[1]=i[1]+n[1],t[2]=i[2]+n[2],t}function Ca(t,e){const n=t[0],r=t[1],s=t[2],i=e[0],c=e[1],o=e[2],l=Math.sqrt((n*n+r*r+s*s)*(i*i+c*c+o*o)),h=l&&wa(t,e)/l;return Math.acos(Math.min(Math.max(h,-1),1))}(function(){const t=Ba();return function(e,n,r,s,i,c){let o,l;for(n||(n=3),r||(r=0),s?l=Math.min(s*n+r,e.length):l=e.length,o=r;o<l;o+=n)t[0]=e[o],t[1]=e[o+1],t[2]=e[o+2],i(t,t,c),e[o]=t[0],e[o+1]=t[1],e[o+2]=t[2];return e}})();const Pn=[0,0,0];let en;class Ee extends As{static get ZERO(){return en||(en=new Ee(0,0,0),Object.freeze(en)),en}constructor(e=0,n=0,r=0){super(-0,-0,-0),arguments.length===1&&Mt(e)?this.copy(e):(Ve.debug&&(pe(e),pe(n),pe(r)),this[0]=e,this[1]=n,this[2]=r)}set(e,n,r){return this[0]=e,this[1]=n,this[2]=r,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return Ve.debug&&(pe(e.x),pe(e.y),pe(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=pe(e)}angle(e){return Ca(this,e)}cross(e){return Pa(this,this,e),this.check()}rotateX({radians:e,origin:n=Pn}){return Na(this,this,n,e),this.check()}rotateY({radians:e,origin:n=Pn}){return va(this,this,n,e),this.check()}rotateZ({radians:e,origin:n=Pn}){return Da(this,this,n,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return zn(this,this,e),this.check()}transformAsVector(e){return fs(this,this,e),this.check()}transformByMatrix3(e){return Ua(this,this,e),this.check()}transformByMatrix2(e){return Ma(this,this,e),this.check()}transformByQuaternion(e){return ls(this,this,e),this.check()}}let tn;class $n extends As{static get ZERO(){return tn||(tn=new $n(0,0,0,0),Object.freeze(tn)),tn}constructor(e=0,n=0,r=0,s=0){super(-0,-0,-0,-0),Mt(e)&&arguments.length===1?this.copy(e):(Ve.debug&&(pe(e),pe(n),pe(r),pe(s)),this[0]=e,this[1]=n,this[2]=r,this[3]=s)}set(e,n,r,s){return this[0]=e,this[1]=n,this[2]=r,this[3]=s,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}fromObject(e){return Ve.debug&&(pe(e.x),pe(e.y),pe(e.z),pe(e.w)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this[3]=e.w,this}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e.w=this[3],e}get ELEMENTS(){return 4}get z(){return this[2]}set z(e){this[2]=pe(e)}get w(){return this[3]}set w(e){this[3]=pe(e)}transform(e){return zn(this,this,e),this.check()}transformByMatrix3(e){return Ia(this,this,e),this.check()}transformByMatrix2(e){return Sa(this,this,e),this.check()}transformByQuaternion(e){return ls(this,this,e),this.check()}applyMatrix4(e){return e.transform(this,this),this}}class La extends us{toString(){let e="[";if(Ve.printRowMajor){e+="row-major:";for(let n=0;n<this.RANK;++n)for(let r=0;r<this.RANK;++r)e+=" ".concat(this[r*this.RANK+n])}else{e+="column-major:";for(let n=0;n<this.ELEMENTS;++n)e+=" ".concat(this[n])}return e+="]",e}getElementIndex(e,n){return n*this.RANK+e}getElement(e,n){return this[n*this.RANK+e]}setElement(e,n,r){return this[n*this.RANK+e]=pe(r),this}getColumn(e,n=new Array(this.RANK).fill(-0)){const r=e*this.RANK;for(let s=0;s<this.RANK;++s)n[s]=this[r+s];return n}setColumn(e,n){const r=e*this.RANK;for(let s=0;s<this.RANK;++s)this[r+s]=n[s];return this}}function Oa(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function za(t,e){if(t===e){const n=e[1],r=e[2],s=e[3],i=e[6],c=e[7],o=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=i,t[11]=e[14],t[12]=s,t[13]=c,t[14]=o}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function $a(t,e){const n=e[0],r=e[1],s=e[2],i=e[3],c=e[4],o=e[5],l=e[6],h=e[7],f=e[8],A=e[9],p=e[10],F=e[11],U=e[12],z=e[13],X=e[14],y=e[15],g=n*o-r*c,v=n*l-s*c,C=n*h-i*c,I=r*l-s*o,Y=r*h-i*o,xe=s*h-i*l,Ae=f*z-A*U,fe=f*X-p*U,le=f*y-F*U,Z=A*X-p*z,J=A*y-F*z,ie=p*y-F*X;let q=g*ie-v*J+C*Z+I*le-Y*fe+xe*Ae;return q?(q=1/q,t[0]=(o*ie-l*J+h*Z)*q,t[1]=(s*J-r*ie-i*Z)*q,t[2]=(z*xe-X*Y+y*I)*q,t[3]=(p*Y-A*xe-F*I)*q,t[4]=(l*le-c*ie-h*fe)*q,t[5]=(n*ie-s*le+i*fe)*q,t[6]=(X*C-U*xe-y*v)*q,t[7]=(f*xe-p*C+F*v)*q,t[8]=(c*J-o*le+h*Ae)*q,t[9]=(r*le-n*J-i*Ae)*q,t[10]=(U*Y-z*C+y*g)*q,t[11]=(A*C-f*Y-F*g)*q,t[12]=(o*fe-c*Z-l*Ae)*q,t[13]=(n*Z-r*fe+s*Ae)*q,t[14]=(z*v-U*I-X*g)*q,t[15]=(f*I-A*v+p*g)*q,t):null}function ka(t){const e=t[0],n=t[1],r=t[2],s=t[3],i=t[4],c=t[5],o=t[6],l=t[7],h=t[8],f=t[9],A=t[10],p=t[11],F=t[12],U=t[13],z=t[14],X=t[15],y=e*c-n*i,g=e*o-r*i,v=n*o-r*c,C=h*U-f*F,I=h*z-A*F,Y=f*z-A*U,xe=e*Y-n*I+r*C,Ae=i*Y-c*I+o*C,fe=h*v-f*g+A*y,le=F*v-U*g+z*y;return l*xe-s*Ae+X*fe-p*le}function ns(t,e,n){const r=e[0],s=e[1],i=e[2],c=e[3],o=e[4],l=e[5],h=e[6],f=e[7],A=e[8],p=e[9],F=e[10],U=e[11],z=e[12],X=e[13],y=e[14],g=e[15];let v=n[0],C=n[1],I=n[2],Y=n[3];return t[0]=v*r+C*o+I*A+Y*z,t[1]=v*s+C*l+I*p+Y*X,t[2]=v*i+C*h+I*F+Y*y,t[3]=v*c+C*f+I*U+Y*g,v=n[4],C=n[5],I=n[6],Y=n[7],t[4]=v*r+C*o+I*A+Y*z,t[5]=v*s+C*l+I*p+Y*X,t[6]=v*i+C*h+I*F+Y*y,t[7]=v*c+C*f+I*U+Y*g,v=n[8],C=n[9],I=n[10],Y=n[11],t[8]=v*r+C*o+I*A+Y*z,t[9]=v*s+C*l+I*p+Y*X,t[10]=v*i+C*h+I*F+Y*y,t[11]=v*c+C*f+I*U+Y*g,v=n[12],C=n[13],I=n[14],Y=n[15],t[12]=v*r+C*o+I*A+Y*z,t[13]=v*s+C*l+I*p+Y*X,t[14]=v*i+C*h+I*F+Y*y,t[15]=v*c+C*f+I*U+Y*g,t}function Ga(t,e,n){const r=n[0],s=n[1],i=n[2];let c,o,l,h,f,A,p,F,U,z,X,y;return e===t?(t[12]=e[0]*r+e[4]*s+e[8]*i+e[12],t[13]=e[1]*r+e[5]*s+e[9]*i+e[13],t[14]=e[2]*r+e[6]*s+e[10]*i+e[14],t[15]=e[3]*r+e[7]*s+e[11]*i+e[15]):(c=e[0],o=e[1],l=e[2],h=e[3],f=e[4],A=e[5],p=e[6],F=e[7],U=e[8],z=e[9],X=e[10],y=e[11],t[0]=c,t[1]=o,t[2]=l,t[3]=h,t[4]=f,t[5]=A,t[6]=p,t[7]=F,t[8]=U,t[9]=z,t[10]=X,t[11]=y,t[12]=c*r+f*s+U*i+e[12],t[13]=o*r+A*s+z*i+e[13],t[14]=l*r+p*s+X*i+e[14],t[15]=h*r+F*s+y*i+e[15]),t}function Va(t,e,n){const r=n[0],s=n[1],i=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*s,t[5]=e[5]*s,t[6]=e[6]*s,t[7]=e[7]*s,t[8]=e[8]*i,t[9]=e[9]*i,t[10]=e[10]*i,t[11]=e[11]*i,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Xa(t,e,n,r){let s=r[0],i=r[1],c=r[2],o=Math.sqrt(s*s+i*i+c*c),l,h,f,A,p,F,U,z,X,y,g,v,C,I,Y,xe,Ae,fe,le,Z,J,ie,q,he;return o<un?null:(o=1/o,s*=o,i*=o,c*=o,h=Math.sin(n),l=Math.cos(n),f=1-l,A=e[0],p=e[1],F=e[2],U=e[3],z=e[4],X=e[5],y=e[6],g=e[7],v=e[8],C=e[9],I=e[10],Y=e[11],xe=s*s*f+l,Ae=i*s*f+c*h,fe=c*s*f-i*h,le=s*i*f-c*h,Z=i*i*f+l,J=c*i*f+s*h,ie=s*c*f+i*h,q=i*c*f-s*h,he=c*c*f+l,t[0]=A*xe+z*Ae+v*fe,t[1]=p*xe+X*Ae+C*fe,t[2]=F*xe+y*Ae+I*fe,t[3]=U*xe+g*Ae+Y*fe,t[4]=A*le+z*Z+v*J,t[5]=p*le+X*Z+C*J,t[6]=F*le+y*Z+I*J,t[7]=U*le+g*Z+Y*J,t[8]=A*ie+z*q+v*he,t[9]=p*ie+X*q+C*he,t[10]=F*ie+y*q+I*he,t[11]=U*ie+g*q+Y*he,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function Wa(t,e,n){const r=Math.sin(n),s=Math.cos(n),i=e[4],c=e[5],o=e[6],l=e[7],h=e[8],f=e[9],A=e[10],p=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=i*s+h*r,t[5]=c*s+f*r,t[6]=o*s+A*r,t[7]=l*s+p*r,t[8]=h*s-i*r,t[9]=f*s-c*r,t[10]=A*s-o*r,t[11]=p*s-l*r,t}function Ya(t,e,n){const r=Math.sin(n),s=Math.cos(n),i=e[0],c=e[1],o=e[2],l=e[3],h=e[8],f=e[9],A=e[10],p=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=i*s-h*r,t[1]=c*s-f*r,t[2]=o*s-A*r,t[3]=l*s-p*r,t[8]=i*r+h*s,t[9]=c*r+f*s,t[10]=o*r+A*s,t[11]=l*r+p*s,t}function ja(t,e,n){const r=Math.sin(n),s=Math.cos(n),i=e[0],c=e[1],o=e[2],l=e[3],h=e[4],f=e[5],A=e[6],p=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=i*s+h*r,t[1]=c*s+f*r,t[2]=o*s+A*r,t[3]=l*s+p*r,t[4]=h*s-i*r,t[5]=f*s-c*r,t[6]=A*s-o*r,t[7]=p*s-l*r,t}function Qa(t,e){const n=e[0],r=e[1],s=e[2],i=e[3],c=n+n,o=r+r,l=s+s,h=n*c,f=r*c,A=r*o,p=s*c,F=s*o,U=s*l,z=i*c,X=i*o,y=i*l;return t[0]=1-A-U,t[1]=f+y,t[2]=p-X,t[3]=0,t[4]=f-y,t[5]=1-h-U,t[6]=F+z,t[7]=0,t[8]=p+X,t[9]=F-z,t[10]=1-h-A,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Ha(t,e,n,r,s,i,c){const o=1/(n-e),l=1/(s-r),h=1/(i-c);return t[0]=i*2*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i*2*l,t[6]=0,t[7]=0,t[8]=(n+e)*o,t[9]=(s+r)*l,t[10]=(c+i)*h,t[11]=-1,t[12]=0,t[13]=0,t[14]=c*i*2*h,t[15]=0,t}function qa(t,e,n,r,s){const i=1/Math.tan(e/2);if(t[0]=i/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,s!=null&&s!==1/0){const c=1/(r-s);t[10]=(s+r)*c,t[14]=2*s*r*c}else t[10]=-1,t[14]=-2*r;return t}const Ka=qa;function Za(t,e,n,r,s,i,c){const o=1/(e-n),l=1/(r-s),h=1/(i-c);return t[0]=-2*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*h,t[11]=0,t[12]=(e+n)*o,t[13]=(s+r)*l,t[14]=(c+i)*h,t[15]=1,t}const Ja=Za;function ec(t,e,n,r){let s,i,c,o,l,h,f,A,p,F;const U=e[0],z=e[1],X=e[2],y=r[0],g=r[1],v=r[2],C=n[0],I=n[1],Y=n[2];return Math.abs(U-C)<un&&Math.abs(z-I)<un&&Math.abs(X-Y)<un?Oa(t):(A=U-C,p=z-I,F=X-Y,s=1/Math.sqrt(A*A+p*p+F*F),A*=s,p*=s,F*=s,i=g*F-v*p,c=v*A-y*F,o=y*p-g*A,s=Math.sqrt(i*i+c*c+o*o),s?(s=1/s,i*=s,c*=s,o*=s):(i=0,c=0,o=0),l=p*o-F*c,h=F*i-A*o,f=A*c-p*i,s=Math.sqrt(l*l+h*h+f*f),s?(s=1/s,l*=s,h*=s,f*=s):(l=0,h=0,f=0),t[0]=i,t[1]=l,t[2]=A,t[3]=0,t[4]=c,t[5]=h,t[6]=p,t[7]=0,t[8]=o,t[9]=f,t[10]=F,t[11]=0,t[12]=-(i*U+c*z+o*X),t[13]=-(l*U+h*z+f*X),t[14]=-(A*U+p*z+F*X),t[15]=1,t)}function tc(){const t=new St(4);return St!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function nc(t,e,n){const r=e[0],s=e[1],i=e[2],c=e[3];return t[0]=n[0]*r+n[4]*s+n[8]*i+n[12]*c,t[1]=n[1]*r+n[5]*s+n[9]*i+n[13]*c,t[2]=n[2]*r+n[6]*s+n[10]*i+n[14]*c,t[3]=n[3]*r+n[7]*s+n[11]*i+n[15]*c,t}(function(){const t=tc();return function(e,n,r,s,i,c){let o,l;for(n||(n=4),r||(r=0),s?l=Math.min(s*n+r,e.length):l=e.length,o=r;o<l;o+=n)t[0]=e[o],t[1]=e[o+1],t[2]=e[o+2],t[3]=e[o+3],i(t,t,c),e[o]=t[0],e[o+1]=t[1],e[o+2]=t[2],e[o+3]=t[3];return e}})();var Dn;(function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL0ROW3=3]="COL0ROW3",t[t.COL1ROW0=4]="COL1ROW0",t[t.COL1ROW1=5]="COL1ROW1",t[t.COL1ROW2=6]="COL1ROW2",t[t.COL1ROW3=7]="COL1ROW3",t[t.COL2ROW0=8]="COL2ROW0",t[t.COL2ROW1=9]="COL2ROW1",t[t.COL2ROW2=10]="COL2ROW2",t[t.COL2ROW3=11]="COL2ROW3",t[t.COL3ROW0=12]="COL3ROW0",t[t.COL3ROW1=13]="COL3ROW1",t[t.COL3ROW2=14]="COL3ROW2",t[t.COL3ROW3=15]="COL3ROW3"})(Dn||(Dn={}));const rc=45*Math.PI/180,sc=1,Un=.1,Nn=500,ic=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class je extends La{static get IDENTITY(){return ac()}static get ZERO(){return oc()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return Dn}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,n,r,s,i,c,o,l,h,f,A,p,F,U,z,X){return this[0]=e,this[1]=n,this[2]=r,this[3]=s,this[4]=i,this[5]=c,this[6]=o,this[7]=l,this[8]=h,this[9]=f,this[10]=A,this[11]=p,this[12]=F,this[13]=U,this[14]=z,this[15]=X,this.check()}setRowMajor(e,n,r,s,i,c,o,l,h,f,A,p,F,U,z,X){return this[0]=e,this[1]=i,this[2]=h,this[3]=F,this[4]=n,this[5]=c,this[6]=f,this[7]=U,this[8]=r,this[9]=o,this[10]=A,this[11]=z,this[12]=s,this[13]=l,this[14]=p,this[15]=X,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(ic)}fromObject(e){return this.check()}fromQuaternion(e){return Qa(this,e),this.check()}frustum(e){const{left:n,right:r,bottom:s,top:i,near:c=Un,far:o=Nn}=e;return o===1/0?cc(this,n,r,s,i,c):Ha(this,n,r,s,i,c,o),this.check()}lookAt(e){const{eye:n,center:r=[0,0,0],up:s=[0,1,0]}=e;return ec(this,n,r,s),this.check()}ortho(e){const{left:n,right:r,bottom:s,top:i,near:c=Un,far:o=Nn}=e;return Ja(this,n,r,s,i,c,o),this.check()}orthographic(e){const{fovy:n=rc,aspect:r=sc,focalDistance:s=1,near:i=Un,far:c=Nn}=e;rs(n);const o=n/2,l=s*Math.tan(o),h=l*r;return this.ortho({left:-h,right:h,bottom:-l,top:l,near:i,far:c})}perspective(e){const{fovy:n=45*Math.PI/180,aspect:r=1,near:s=.1,far:i=500}=e;return rs(n),Ka(this,n,r,s,i),this.check()}determinant(){return ka(this)}getScale(e=[-0,-0,-0]){return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(e=[-0,-0,-0]){return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const r=this.getScale(n),s=1/r[0],i=1/r[1],c=1/r[2];return e[0]=this[0]*s,e[1]=this[1]*i,e[2]=this[2]*c,e[3]=0,e[4]=this[4]*s,e[5]=this[5]*i,e[6]=this[6]*c,e[7]=0,e[8]=this[8]*s,e[9]=this[9]*i,e[10]=this[10]*c,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const r=this.getScale(n),s=1/r[0],i=1/r[1],c=1/r[2];return e[0]=this[0]*s,e[1]=this[1]*i,e[2]=this[2]*c,e[3]=this[4]*s,e[4]=this[5]*i,e[5]=this[6]*c,e[6]=this[8]*s,e[7]=this[9]*i,e[8]=this[10]*c,e}transpose(){return za(this,this),this.check()}invert(){return $a(this,this),this.check()}multiplyLeft(e){return ns(this,e,this),this.check()}multiplyRight(e){return ns(this,this,e),this.check()}rotateX(e){return Wa(this,this,e),this.check()}rotateY(e){return Ya(this,this,e),this.check()}rotateZ(e){return ja(this,this,e),this.check()}rotateXYZ(e){return this.rotateX(e[0]).rotateY(e[1]).rotateZ(e[2])}rotateAxis(e,n){return Xa(this,this,e,n),this.check()}scale(e){return Va(this,this,Array.isArray(e)?e:[e,e,e]),this.check()}translate(e){return Ga(this,this,e),this.check()}transform(e,n){return e.length===4?(n=nc(n||[-0,-0,-0,-0],e,this),wn(n,4),n):this.transformAsPoint(e,n)}transformAsPoint(e,n){const{length:r}=e;let s;switch(r){case 2:s=ga(n||[-0,-0],e,this);break;case 3:s=zn(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return wn(s,e.length),s}transformAsVector(e,n){let r;switch(e.length){case 2:r=Fa(n||[-0,-0],e,this);break;case 3:r=fs(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return wn(r,e.length),r}transformPoint(e,n){return this.transformAsPoint(e,n)}transformVector(e,n){return this.transformAsPoint(e,n)}transformDirection(e,n){return this.transformAsVector(e,n)}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,n,r){return this.identity().translate([e,n,r])}}let nn,rn;function oc(){return nn||(nn=new je([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(nn)),nn}function ac(){return rn||(rn=new je,Object.freeze(rn)),rn}function rs(t){if(t>Math.PI*2)throw Error("expected radians")}function cc(t,e,n,r,s,i){const c=2*i/(n-e),o=2*i/(s-r),l=(n+e)/(n-e),h=(s+r)/(s-r),f=-1,A=-1,p=-2*i;return t[0]=c,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=l,t[9]=h,t[10]=f,t[11]=A,t[12]=0,t[13]=0,t[14]=p,t[15]=0,t}const ss=t=>{const e=t.clientWidth,n=t.clientHeight;return t.width!==e||t.height!==n?(t.width=e,t.height=n,!0):!1},sn=(t,e,n)=>{const r=t.createShader(t.VERTEX_SHADER);if(!r)throw new Error("Vertex shader could not be created.");if(t.shaderSource(r,e),t.compileShader(r),!t.getShaderParameter(r,t.COMPILE_STATUS))throw new Error("Vertex shader could not be compiled."+t.getShaderInfoLog(r));const s=t.createShader(t.FRAGMENT_SHADER);if(!s)throw new Error("Fragment shader could not be created.");if(t.shaderSource(s,n),t.compileShader(s),!t.getShaderParameter(s,t.COMPILE_STATUS))throw new Error("Fragment shader could not be compiled."+t.getShaderInfoLog(s));const i=t.createProgram();if(t.attachShader(i,r),t.attachShader(i,s),t.linkProgram(i),!t.getProgramParameter(i,t.LINK_STATUS))throw new Error("Shader program could not be linked.");return i},vn=(t,e,n)=>{const r=[],s=[];if(t.length>3||e.length>3)return console.error("makeBlock called incorrectly given "+t+" and "+e),{vbo:[],ibo:[]};n||(n=0);const i=Math.min(t[0],e[0]),c=Math.max(t[0],e[0]);if(i==c)return console.error("Front and Back identical "+i),{vbo:[],ibo:[]};const o=Math.min(t[1],e[1]),l=Math.max(t[1],e[1]);if(o==l)return console.error("Down and Up identical "+o),{vbo:[],ibo:[]};const h=Math.min(t[2],e[2]),f=Math.max(t[2],e[2]);if(h==f)return console.error("Left and Right identical "+h),{vbo:[],ibo:[]};const A=[i,c,o,l,h,f];for(let p=0;p<A.length;p++){const F=A[p],U=Math.floor(p/2);console.log(U);const z=[0,0,0];z[U]=p%2?-1:1;const X=(U+1)%3,y=(U+2)%3;for(let g=0;g<2;g++){let v=[n+g*3,n+1+g,n+2-g];p%2&&v.reverse(),s.push(...v);for(let C=0;C<2;C++){const I=[0,0,0];I[U]=F,I[X]=A[2*X+g],I[y]=A[2*y+C],r.push(...I),r.push(...z.reverse())}}n+=4}return{vbo:r,ibo:s}},uc=`#version 300 es\r
precision highp float;\r
\r
layout(location=0) in vec3 aPosition;\r
layout(location=1) in vec3 aNormal;\r
uniform mat4 uLightViewProjection;\r
uniform mat4 uModelView;\r
uniform mat4 uProjection;\r
\r
out vec3 v_position;\r
out vec3 v_normal;\r
out vec4 vLposition; // position of a fragment in normalized light coordinates [-1,1]^3\r
\r
void main() {\r
    // multiply the vertex position by the matrix to get the final \r
    // point in normalized screen coordinates\r
    gl_Position = uProjection * uModelView *  vec4(aPosition,1.0);\r
    v_position = aPosition;\r
    v_normal = aNormal;\r
    vLposition = uLightViewProjection * vec4(aPosition,1.0);\r
}\r
`,Ac=`#version 300 es\r
precision highp float;\r
\r
in vec3 v_position;\r
in vec3 v_normal;\r
in vec4 vLposition;\r
\r
uniform vec3 u_lightDirection;\r
uniform vec3 lightPosition;\r
uniform float u_limit;          // in dot space\r
uniform float u_outerLimit;\r
uniform sampler2D uTexture;\r
uniform sampler2D uFloor;\r
uniform sampler2D uCeiling;\r
uniform sampler2D uShadow;\r
uniform bool uFlashlight;\r
\r
out vec4 fColor;\r
\r
\r
void main() {\r
  vec3 normal = normalize(v_normal);\r
  //Calculating bias\r
  float bias = 0.0006*tan(acos(clamp(\r
    dot(normal,normalize(u_lightDirection))\r
    ,0.,1.)));\r
  bias = clamp(bias, 0.0001,0.02);\r
  //Calculating shadowm locations and so on\r
  vec3 projectedTexcoord = 0.5f * (vLposition.xyz / vLposition.w) + 0.5f;\r
  float currentDepth = projectedTexcoord.z;\r
  bool inRange =\r
      projectedTexcoord.x >= 0.0 &&\r
      projectedTexcoord.x <= 1.0 &&\r
      projectedTexcoord.y >= 0.0 &&\r
      projectedTexcoord.y <= 1.0;\r
  float texDepth = texture(uShadow, projectedTexcoord.xy).r + bias;\r
  //Making light\r
  float shadow = 0.0;\r
  vec2 texelSize = 1.0 / vec2(textureSize(uShadow, 0));\r
  int size = 10;\r
    for(int x = -size; x <= size; ++x)\r
    {\r
        for(int y = -size; y <= size; ++y)\r
        {\r
            float pcfDepth = texture(uShadow, projectedTexcoord.xy + vec2(x, y) * texelSize).r; \r
            shadow += currentDepth - bias > pcfDepth ? 1.0 : 0.0;        \r
        }    \r
    }\r
  shadow /= pow(float(size*2+1),2.);\r
  float shadowLight = (inRange && texDepth <= currentDepth) ? 0.01f : 1.0f - shadow;\r
  float light = 0.0;\r
  vec3 surfaceToLightDirection = normalize(lightPosition - v_position);\r
  float limitRange = u_limit - u_outerLimit;\r
  float dotFromDirection = dot(surfaceToLightDirection,-u_lightDirection);\r
  float inLight = clamp((dotFromDirection - u_outerLimit) / limitRange, 0.0, 1.0);\r
  float d = length(lightPosition - v_position);\r
  if (uFlashlight && dotFromDirection >= u_limit) {\r
    light = (1.-pow(((1.-dotFromDirection)/(1. - u_limit)),4.)) * shadowLight;\r
  }\r
  light = clamp(light,0.01,1.);\r
  vec2 uv = v_position.xy;\r
  if(abs(normal.y)<0.01){\r
      if(normal.x!=0.)\r
          uv.x = v_position.z;\r
      uv.x += .5;\r
      uv.y += .25;\r
      fColor  = texture(uTexture,uv);\r
      if(abs(.5-uv.y)>0.58)\r
        fColor.rgb *= 0.4;\r
  } else{\r
    if(v_normal.y>0.)\r
        fColor = texture(uFloor,v_position.xz);\r
    if(v_normal.y<0.)\r
        fColor = texture(uCeiling,v_position.zx);\r
        }\r
    fColor.rgb *= min(light/d,1.);\r
   //fColor.a = 0.3;\r
}`,fc=`#version 300 es\r
precision highp float;\r
\r
layout(location=0) in vec3 aPosition;\r
uniform mat4 uModelView;\r
uniform mat4 uProjection;\r
uniform mat4 uPosition;\r
uniform mat4 uRotation;\r
\r
out vec3 v_position;\r
out vec3 rPosition;\r
\r
void main() {\r
    gl_Position = uProjection * uModelView * uPosition * uRotation * vec4(aPosition,1.0);\r
    v_position = aPosition;\r
    rPosition =  (uPosition * uRotation * vec4(aPosition,1.0)).xyz;\r
}\r
`,lc=`#version 300 es\r
precision highp float;\r
\r
in vec3 v_position;\r
in vec3 rPosition;\r
\r
uniform samplerCube uTexture;\r
uniform vec3 lightPosition;\r
uniform vec3 u_lightDirection;\r
uniform float u_limit;          // in dot space\r
uniform bool uFlashlight;\r
\r
out vec4 fColor;\r
\r
void main() {\r
    vec2 uv = vec2(0);\r
    vec3 position = normalize(v_position);\r
    // Convert normalized XYZ to spherical coordinates\r
    float theta = acos(position.z);\r
    float phi = atan(position.y, position.x);\r
\r
        // Map spherical coordinates to UV coordinates\r
    uv.x = (phi+ 3.14159) / (2.0 * 3.14159); // Normalize phi to range [0, 1]\r
    uv.y = theta / 3.14159;        // Normalize theta to range [0, 1]\r
    fColor = texture(uTexture,position);\r
\r
    vec3 surfaceToLightDirection = normalize(lightPosition - rPosition);\r
    float dotFromDirection = dot(surfaceToLightDirection,-u_lightDirection);\r
    if (uFlashlight && dotFromDirection >= u_limit) {\r
        \r
        discard;\r
    }\r
}`,mc=`#version 300 es\r
precision highp float;\r
\r
layout(location=0) in vec3 aPosition;\r
\r
uniform mat4 uLightViewProjection;\r
void main() {\r
    gl_Position = uLightViewProjection * vec4(aPosition,1.0);\r
}\r
\r
`,hc=`#version 300 es\r
precision highp float;\r
\r
in vec4 vLposition;\r
void main(void) {\r
    gl_FragDepth = gl_FragCoord.z;\r
}\r
\r
`,Ec=`#version 300 es\r
precision highp float;\r
\r
layout(location=0) in vec3 aPosition;\r
layout(location=1) in vec3 aNormal;\r
\r
uniform mat4 uModelView;\r
uniform mat4 uProjection;\r
  out vec3 v_position;\r
  out vec3 v_normal;\r
void main() {\r
    // multiply the vertex position by the matrix to get the final \r
    // point in normalized screen coordinates\r
    gl_Position = uProjection * uModelView * vec4(aPosition,1.0);\r
    v_position = aPosition;\r
    v_normal = aNormal;\r
}\r
`,dc=`#version 300 es\r
precision highp float;\r
\r
in vec3 v_position;\r
in vec3 v_normal;\r
uniform vec4 ucolor;\r
uniform vec3 lightPosition;\r
uniform vec3 u_lightDirection;\r
uniform float u_limit;          // in dot space\r
uniform bool uFlashlight;\r
out vec4 fColor;\r
\r
void main() {\r
    fColor  = vec4(ucolor);\r
    vec3 surfaceToLightDirection = normalize(lightPosition - v_position);\r
    float dotFromDirection = dot(surfaceToLightDirection,-u_lightDirection);\r
    float light = 0.01;\r
\r
    if (uFlashlight && dotFromDirection >= u_limit) {\r
        light = (1.-pow(((1.-dotFromDirection)/(1. - u_limit)),4.));\r
\r
    }\r
    fColor.xyz *= light;\r
}\r
\r
`;/* @license twgl.js 5.5.4 Copyright (c) 2015, Gregg Tavares All Rights Reserved.
Available via the MIT license.
see: http://github.com/greggman/twgl.js for details */const is=new Map;function xc(t,e){if(!t||typeof t!="object")return!1;let n=is.get(e);n||(n=new WeakMap,is.set(e,n));let r=n.get(t);if(r===void 0){const s=Object.prototype.toString.call(t);r=s.substring(8,s.length-1)===e,n.set(t,r)}return r}function ms(t,e){return typeof WebGLTexture<"u"&&xc(e,"WebGLTexture")}function hs(t){return!!t.texStorage2D}const ln=33984,bc=35718,Tc=5126,pc=35664,yc=35665,Rc=35666,_c=5124,gc=35667,Fc=35668,Mc=35669,Sc=35670,Ic=35671,Bc=35672,wc=35673,Pc=35674,Uc=35675,Nc=35676,vc=35678,Dc=35680,Cc=35679,Lc=35682,Oc=35685,zc=35686,$c=35687,kc=35688,Gc=35689,Vc=35690,Xc=36289,Wc=36292,Yc=36293,jc=5125,Qc=36294,Hc=36295,qc=36296,Kc=36298,Zc=36299,Jc=36300,eu=36303,tu=36306,nu=36307,ru=36308,su=36311,mn=3553,hn=34067,kn=32879,En=35866,te={};function Es(t,e){return te[e].bindPoint}function iu(t,e){return function(n){t.uniform1f(e,n)}}function ou(t,e){return function(n){t.uniform1fv(e,n)}}function au(t,e){return function(n){t.uniform2fv(e,n)}}function cu(t,e){return function(n){t.uniform3fv(e,n)}}function uu(t,e){return function(n){t.uniform4fv(e,n)}}function ds(t,e){return function(n){t.uniform1i(e,n)}}function xs(t,e){return function(n){t.uniform1iv(e,n)}}function bs(t,e){return function(n){t.uniform2iv(e,n)}}function Ts(t,e){return function(n){t.uniform3iv(e,n)}}function ps(t,e){return function(n){t.uniform4iv(e,n)}}function Au(t,e){return function(n){t.uniform1ui(e,n)}}function fu(t,e){return function(n){t.uniform1uiv(e,n)}}function lu(t,e){return function(n){t.uniform2uiv(e,n)}}function mu(t,e){return function(n){t.uniform3uiv(e,n)}}function hu(t,e){return function(n){t.uniform4uiv(e,n)}}function Eu(t,e){return function(n){t.uniformMatrix2fv(e,!1,n)}}function du(t,e){return function(n){t.uniformMatrix3fv(e,!1,n)}}function xu(t,e){return function(n){t.uniformMatrix4fv(e,!1,n)}}function bu(t,e){return function(n){t.uniformMatrix2x3fv(e,!1,n)}}function Tu(t,e){return function(n){t.uniformMatrix3x2fv(e,!1,n)}}function pu(t,e){return function(n){t.uniformMatrix2x4fv(e,!1,n)}}function yu(t,e){return function(n){t.uniformMatrix4x2fv(e,!1,n)}}function Ru(t,e){return function(n){t.uniformMatrix3x4fv(e,!1,n)}}function _u(t,e){return function(n){t.uniformMatrix4x3fv(e,!1,n)}}function Xe(t,e,n,r){const s=Es(t,e);return hs(t)?function(i){let c,o;!i||ms(t,i)?(c=i,o=null):(c=i.texture,o=i.sampler),t.uniform1i(r,n),t.activeTexture(ln+n),t.bindTexture(s,c),t.bindSampler(n,o)}:function(i){t.uniform1i(r,n),t.activeTexture(ln+n),t.bindTexture(s,i)}}function We(t,e,n,r,s){const i=Es(t,e),c=new Int32Array(s);for(let o=0;o<s;++o)c[o]=n+o;return hs(t)?function(o){t.uniform1iv(r,c),o.forEach(function(l,h){t.activeTexture(ln+c[h]);let f,A;!l||ms(t,l)?(f=l,A=null):(f=l.texture,A=l.sampler),t.bindSampler(n,A),t.bindTexture(i,f)})}:function(o){t.uniform1iv(r,c),o.forEach(function(l,h){t.activeTexture(ln+c[h]),t.bindTexture(i,l)})}}te[Tc]={Type:Float32Array,size:4,setter:iu,arraySetter:ou};te[pc]={Type:Float32Array,size:8,setter:au,cols:2};te[yc]={Type:Float32Array,size:12,setter:cu,cols:3};te[Rc]={Type:Float32Array,size:16,setter:uu,cols:4};te[_c]={Type:Int32Array,size:4,setter:ds,arraySetter:xs};te[gc]={Type:Int32Array,size:8,setter:bs,cols:2};te[Fc]={Type:Int32Array,size:12,setter:Ts,cols:3};te[Mc]={Type:Int32Array,size:16,setter:ps,cols:4};te[jc]={Type:Uint32Array,size:4,setter:Au,arraySetter:fu};te[Qc]={Type:Uint32Array,size:8,setter:lu,cols:2};te[Hc]={Type:Uint32Array,size:12,setter:mu,cols:3};te[qc]={Type:Uint32Array,size:16,setter:hu,cols:4};te[Sc]={Type:Uint32Array,size:4,setter:ds,arraySetter:xs};te[Ic]={Type:Uint32Array,size:8,setter:bs,cols:2};te[Bc]={Type:Uint32Array,size:12,setter:Ts,cols:3};te[wc]={Type:Uint32Array,size:16,setter:ps,cols:4};te[Pc]={Type:Float32Array,size:32,setter:Eu,rows:2,cols:2};te[Uc]={Type:Float32Array,size:48,setter:du,rows:3,cols:3};te[Nc]={Type:Float32Array,size:64,setter:xu,rows:4,cols:4};te[Oc]={Type:Float32Array,size:32,setter:bu,rows:2,cols:3};te[zc]={Type:Float32Array,size:32,setter:pu,rows:2,cols:4};te[$c]={Type:Float32Array,size:48,setter:Tu,rows:3,cols:2};te[kc]={Type:Float32Array,size:48,setter:Ru,rows:3,cols:4};te[Gc]={Type:Float32Array,size:64,setter:yu,rows:4,cols:2};te[Vc]={Type:Float32Array,size:64,setter:_u,rows:4,cols:3};te[vc]={Type:null,size:0,setter:Xe,arraySetter:We,bindPoint:mn};te[Dc]={Type:null,size:0,setter:Xe,arraySetter:We,bindPoint:hn};te[Cc]={Type:null,size:0,setter:Xe,arraySetter:We,bindPoint:kn};te[Lc]={Type:null,size:0,setter:Xe,arraySetter:We,bindPoint:mn};te[Xc]={Type:null,size:0,setter:Xe,arraySetter:We,bindPoint:En};te[Wc]={Type:null,size:0,setter:Xe,arraySetter:We,bindPoint:En};te[Yc]={Type:null,size:0,setter:Xe,arraySetter:We,bindPoint:hn};te[Kc]={Type:null,size:0,setter:Xe,arraySetter:We,bindPoint:mn};te[Zc]={Type:null,size:0,setter:Xe,arraySetter:We,bindPoint:kn};te[Jc]={Type:null,size:0,setter:Xe,arraySetter:We,bindPoint:hn};te[eu]={Type:null,size:0,setter:Xe,arraySetter:We,bindPoint:En};te[tu]={Type:null,size:0,setter:Xe,arraySetter:We,bindPoint:mn};te[nu]={Type:null,size:0,setter:Xe,arraySetter:We,bindPoint:kn};te[ru]={Type:null,size:0,setter:Xe,arraySetter:We,bindPoint:hn};te[su]={Type:null,size:0,setter:Xe,arraySetter:We,bindPoint:En};function gu(t){const e=t.name;return e.startsWith("gl_")||e.startsWith("webgl_")}const Fu=/(\.|\[|]|\w+)/g,Mu=t=>t>="0"&&t<="9";function Su(t,e,n,r){const s=t.split(Fu).filter(o=>o!=="");let i=0,c="";for(;;){const o=s[i++];c+=o;const l=Mu(o[0]),h=l?parseInt(o):o;if(l&&(c+=s[i++]),i===s.length){n[h]=e;break}else{const A=s[i++],p=A==="[",F=n[h]||(p?[]:{});n[h]=F,n=F,r[c]=r[c]||function(U){return function(z){ys(U,z)}}(F),c+=A}}}function An(t,e){let n=0;function r(o,l,h){const f=l.name.endsWith("[0]"),A=l.type,p=te[A];if(!p)throw new Error(`unknown type: 0x${A.toString(16)}`);let F;if(p.bindPoint){const U=n;n+=l.size,f?F=p.arraySetter(t,A,U,h,l.size):F=p.setter(t,A,U,h,l.size)}else p.arraySetter&&f?F=p.arraySetter(t,h):F=p.setter(t,h);return F.location=h,F}const s={},i={},c=t.getProgramParameter(e,bc);for(let o=0;o<c;++o){const l=t.getActiveUniform(e,o);if(gu(l))continue;let h=l.name;h.endsWith("[0]")&&(h=h.substr(0,h.length-3));const f=t.getUniformLocation(e,l.name);if(f){const A=r(e,l,f);s[h]=A,Su(h,A,i,s)}}return s}function ys(t,e){for(const n in e){const r=t[n];typeof r=="function"?r(e[n]):ys(t[n],e[n])}}function dn(t,...e){const n=t.uniformSetters||t,r=e.length;for(let s=0;s<r;++s){const i=e[s];if(Array.isArray(i)){const c=i.length;for(let o=0;o<c;++o)dn(n,i[o])}else for(const c in i){const o=n[c];o&&o(i[c])}}}function Iu(t){const e=new Ee([0,0,0]),n=t.inputManager,r=t.controllerIndex;if(t.controllerIndex!==null){const s=navigator.getGamepads()[r],i=s.buttons;for(let A=0;A<i.length;A++)n.setActionFromButton(A,i[A].pressed);const c=.4,o=s.axes[0];Math.abs(o)>=c&&e.add(new Ee([o,0,0]));const l=s.axes[1];Math.abs(l)>=c&&e.add(new Ee([0,0,l]));const h=s.axes[2];Math.abs(h)>=c&&(t.phi+=h*2);const f=s.axes[3];Math.abs(f)>=c&&(t.theta=as(t.theta+f*2,-80,80))}if(n.getFromAction("flashlight").justPressed&&(t.flashlight=!t.flashlight),n.getFromAction("forward").down&&e.add(new Ee([0,0,-1])),n.getFromAction("back").down&&e.add(new Ee([0,0,1])),n.getFromAction("left").down&&e.add(new Ee([-1,0,0])),n.getFromAction("right").down&&e.add(new Ee([1,0,0])),e.magnitude()>0){e.magnitude()>1&&e.normalize();let s=t.player.position.clone();n.getFromAction("sprint").down&&e.scale(1.8);const i=Bu(t.phi,e.scale(.007)),c=Math.floor(s.x+.5),o=Math.round(s.z);(!(t.maze.mazemap[c][o]&2)||Math.abs(s.z-o)>t.maze.roomSize*.9)&&i.x>0&&s.x-c>t.maze.roomSize*.8&&(i.x=0),(!(t.maze.mazemap[c][o]&1)||Math.abs(s.z-o)>t.maze.roomSize*.9)&&i.x<0&&s.x-c<-t.maze.roomSize*.8&&(i.x=0),(!(t.maze.mazemap[c][o]&8)||Math.abs(s.x-c)>t.maze.roomSize*.9)&&i.z>0&&s.z-o>t.maze.roomSize*.8&&(i.z=0),(!(t.maze.mazemap[c][o]&4)||Math.abs(s.x-c)>t.maze.roomSize*.9)&&i.z<0&&s.z-o<-t.maze.roomSize*.8&&(i.z=0),t.player.position.add(i)}}function Bu(t,e){let n=new je().identity();return n.rotateY(-t*Math.PI/180),n.translate(e),n.rotateY(t*Math.PI/180),new Ee(n.getTranslation())}function on(t,e,n){let r,s;return typeof e=="number"?(r=e,s=n):(r=e.x,s=e.z),t===1?r-=1:t===2?r+=1:t===4?s-=1:t===8&&(s+=1),new Ee(r,0,s)}const an=1024;class wu{constructor(e,n){this.drawShadowMap=(i,c,o)=>{i.bindFramebuffer(i.FRAMEBUFFER,this.shadowMapFBO),i.useProgram(this.prShadowMap),i.viewport(0,0,an,an),i.clear(i.DEPTH_BUFFER_BIT);const l=i.getUniformLocation(this.prShadowMap,"uLightViewProjection");i.uniformMatrix4fv(l,!1,o),i.cullFace(i.FRONT),c.objects.forEach(h=>{h.shadow(c)}),i.bindFramebuffer(i.FRAMEBUFFER,null),i.cullFace(i.BACK),i.viewport(0,0,i.canvas.width,i.canvas.height),i.clear(i.COLOR_BUFFER_BIT|i.DEPTH_BUFFER_BIT)},this.shadowMapTex=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this.shadowMapTex),Le(e),e.texImage2D(e.TEXTURE_2D,0,e.DEPTH_COMPONENT32F,an,an,0,e.DEPTH_COMPONENT,e.FLOAT,null),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST);const r=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,r),e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,this.shadowMapTex,0),e.checkFramebufferStatus(e.FRAMEBUFFER)!==e.FRAMEBUFFER_COMPLETE&&console.error("Framebuffer is not complete"),this.shadowMapFBO=r,this.prShadowMap=n,e.bindFramebuffer(e.FRAMEBUFFER,null)}}const Le=t=>{t.getError()>0&&console.log(t.getError())};class xt{constructor(e,n){this.x=e,this.y=n}distance(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}direction(e){if(this.distance(e)!==1)return 0;if(this.x>e.x)return 1;if(this.x<e.x)return 2;if(this.y>e.y)return 4;if(this.y<e.y)return 8}adjacent(){return[this.up(),this.down(),this.left(),this.right()]}up(){return new xt(this.x,this.y+1)}down(){return new xt(this.x,this.y-1)}left(){return new xt(this.x-1,this.y)}right(){return new xt(this.x+1,this.y)}valid(e){return this.x<e.length&&this.x>=0&&this.y<e[this.x].length&&this.y>=0}retrieve(e){if(this.valid(e))return e[this.x][this.y]}insert(e,n){this.valid(e)&&(e[this.x][this.y]|=n)}add(e,n){this.valid(e)&&(e[this.x][this.y]=e[this.x][this.y]+n)}equals(e){return e!==void 0&&this.x===e.x&&this.y===e.y}pos(){return"X: "+this.x+" Y: "+this.y}copy(){return new xt(this.x,this.y)}vec3(){return new Ee(this.x,0,this.y)}}function Cn(t,e,n){let r=t[t.length-1],s=n!==void 0?n-1:void 0;if(e[r.x][r.y]>0||s===0)return{finished:!0,into:r,path:t};if(t.slice(0,-1).some(c=>c.equals(r)))return{finished:!1,into:r,path:t.slice(0,-1)};let i=Gn(r.adjacent()).filter(c=>c.valid(e));for(let c=0;c<i.length;c++){const o=i[c];let l=new Array(...t);l.push(o);let h=Cn(l,e,s);if(h.finished)return h.into.insert(e,h.into.direction(r)),r.insert(e,r.direction(h.into)),{finished:!0,into:r,path:l};if(!r.equals(h.into))return{finished:!1,into:h.into,path:t}}return Cn(t,e,s)}const Gn=t=>{for(let e=t.length-1;e>0;e--){const n=Math.floor(Math.random()*(e+1));[t[e],t[n]]=[t[n],t[e]]}return t};class Pu{constructor(e,n){const r=new Array(n).fill(0);for(let y=0;y<n;y++)r[y]=new Array(n).fill(0);let s=new Array;for(let y=0;y<n;y++)for(let g=0;g<n;g++)s.push(new xt(y,g));Gn(s);let i=new Array;for(this.start=s.pop(),this.start.insert(r,16);s.length>0;){const y=s.pop(),g=Cn([y],r).path;for(this.goal===void 0&&y.distance(this.start)>n/2&&(this.goal=y),g.length>1&&y.x>0&&y.y>0&&y.x<n-1&&y.y<n-1&&i.push(y);g.length>0;){const v=g.shift();s=s.filter(C=>!C.equals(v))}}for(;i.length>0;){const y=i.pop(),g=y.retrieve(r),v=[1,2,4,8];let C=0;if(v.forEach(I=>{I&g&&(C+=1)}),C==1){let I;switch(g){case 1:I=y.right();break;case 2:I=y.left();break;case 4:I=y.down();break;case 8:I=y.up();break}I.valid(r)&&(y.insert(r,y.direction(I)),I.insert(r,I.direction(y)))}}let c=[],o=[];const l=.5,h=.15,f=.45,A=1;for(let y=0;y<n;y++)for(let g=0;g<n;g++){r[y][g]===0&&console.debug(y+" "+g);const v=[(y-f)*A,(h-l)*A,(g-f)*A],C=[(y+f)*A,(h-l)*A,(g-f)*A],I=[(y+f)*A,(h-l)*A,(g+f)*A],Y=[(y-f)*A,(h-l)*A,(g+f)*A],xe=[(y-f)*A,(h+l)*A,(g-f)*A],Ae=[(y+f)*A,(h+l)*A,(g-f)*A],fe=[(y+f)*A,(h+l)*A,(g+f)*A],le=[(y-f)*A,(h+l)*A,(g+f)*A],Z=[0,-1,0],J=[0,1,0],ie=[-1,0,0],q=[1,0,0],he=[0,0,-1],Me=[0,0,1];if(c=c.concat(le,Ae,fe,le,xe,Ae,Y,I,C,C,v,Y),o=o.concat(Z,Z,Z,Z,Z,Z,J,J,J,J,J,J),r[y][g]%2>0){const we=[(y-(1-f))*A,(h+l)*A,(g-f)*A],Oe=[(y-(1-f))*A,(h-l)*A,(g-f)*A],Pe=[(y-(1-f))*A,(h+l)*A,(g+f)*A],Qe=[(y-(1-f))*A,(h-l)*A,(g+f)*A];c=c.concat(Pe,le,Y,Pe,Y,Qe,v,xe,we,v,we,Oe,Pe,we,le,we,xe,le,Qe,Oe,Y,Oe,v,Y),o=o.concat(he,he,he,he,he,he,Me,Me,Me,Me,Me,Me,Z,Z,Z,Z,Z,Z,J,J,J,J,J,J)}else c=c.concat(v,xe,le,v,le,Y),o=o.concat(q,q,q,q,q,q);if(r[y][g]%4>1){const we=[(y+(1-f))*A,(h+l)*A,(g-f)*A],Oe=[(y+(1-f))*A,(h-l)*A,(g-f)*A],Pe=[(y+(1-f))*A,(h+l)*A,(g+f)*A],Qe=[(y+(1-f))*A,(h-l)*A,(g+f)*A];c=c.concat(I,Pe,fe,Qe,Pe,I,C,Ae,we,Oe,we,C,fe,we,Pe,Ae,we,fe,I,Qe,Oe,Oe,C,I),o=o.concat(he,he,he,he,he,he,Me,Me,Me,Me,Me,Me,Z,Z,Z,Z,Z,Z,J,J,J,J,J,J)}else c=c.concat(C,fe,Ae,fe,C,I),o=o.concat(ie,ie,ie,ie,ie,ie);if(r[y][g]%8>3){const we=[(y+f)*A,(h+l)*A,(g-(1-f))*A],Oe=[(y+f)*A,(h-l)*A,(g-(1-f))*A],Pe=[(y-f)*A,(h+l)*A,(g-(1-f))*A],Qe=[(y-f)*A,(h-l)*A,(g-(1-f))*A];c=c.concat(C,Ae,we,we,Oe,C,v,Pe,xe,Qe,Pe,v,Ae,we,Pe,Pe,xe,Ae,Qe,v,Oe,Oe,v,C),o=o.concat(ie,ie,ie,ie,ie,ie,q,q,q,q,q,q,Z,Z,Z,Z,Z,Z,J,J,J,J,J,J)}else c=c.concat(Ae,xe,v,v,C,Ae),o=o.concat(Me,Me,Me,Me,Me,Me);if(r[y][g]%16>7){const we=[(y+f)*A,(h+l)*A,(g+(1-f))*A],Oe=[(y+f)*A,(h-l)*A,(g+(1-f))*A],Pe=[(y-f)*A,(h+l)*A,(g+(1-f))*A],Qe=[(y-f)*A,(h-l)*A,(g+(1-f))*A];c=c.concat(I,fe,we,we,Oe,I,Y,le,Pe,Pe,Qe,Y,we,Pe,fe,fe,Pe,le,Qe,Y,Oe,Oe,I,Y),o=o.concat(ie,ie,ie,ie,ie,ie,q,q,q,q,q,q,Z,Z,Z,Z,Z,Z,J,J,J,J,J,J)}else c=c.concat(le,fe,I,I,Y,le),o=o.concat(he,he,he,he,he,he)}const p=[];this.iboSize=c.length/3;for(let y=0;y<this.iboSize;y++)p.push(p.length);const F=[];for(let y=0;y<p.length;y++)F.push(...c.slice(y*3,y*3+3).concat(...o.slice(y*3,y*3+3)));const U=e.createVertexArray();e.bindVertexArray(U);const z=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,z),e.bufferData(e.ARRAY_BUFFER,new Float32Array(F),e.STATIC_DRAW),e.enableVertexAttribArray(0),e.vertexAttribPointer(0,3,e.FLOAT,!1,6*4,0),e.enableVertexAttribArray(1),e.vertexAttribPointer(1,3,e.FLOAT,!1,6*4,3*4);const X=e.createBuffer();e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,X),e.bufferData(e.ELEMENT_ARRAY_BUFFER,new Uint32Array(p),e.STATIC_DRAW),this.mazemap=r,this.vao=U,this.roomSize=f,this.iboSize=p.length}loadTextures(e,n){const r=e.createTexture();e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,r),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n[0]),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_LINEAR),e.generateMipmap(e.TEXTURE_2D),e.activeTexture(e.TEXTURE1);const s=e.createTexture();e.bindTexture(e.TEXTURE_2D,s),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n[1]),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_LINEAR),e.generateMipmap(e.TEXTURE_2D),e.activeTexture(e.TEXTURE2);const i=e.createTexture();e.bindTexture(e.TEXTURE_2D,i),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n[2]),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_LINEAR),e.generateMipmap(e.TEXTURE_2D),this.textures=[r,s,i]}shadow(e){const n=e.gl;n.bindVertexArray(this.vao),n.drawElements(n.TRIANGLES,this.iboSize,n.UNSIGNED_INT,0),Le(n)}update(e){const n=e.gl,r=this.program;n.useProgram(r),Le(n),dn(this.uniformSetter,e.globalUniforms),Le(n),n.bindTexture(n.TEXTURE_2D,e.player.shadowMapTex),n.activeTexture(n.TEXTURE1),Le(n),n.bindTexture(n.TEXTURE_2D,this.textures[0]),Le(n);let s=n.getUniformLocation(r,"uTexture");Le(n),n.uniform1i(s,1),Le(n),n.activeTexture(n.TEXTURE2),Le(n),n.bindTexture(n.TEXTURE_2D,this.textures[1]),Le(n);let i=n.getUniformLocation(r,"uFloor");Le(n),n.uniform1i(i,2),Le(n),n.activeTexture(n.TEXTURE3),Le(n),n.bindTexture(n.TEXTURE_2D,this.textures[2]),Le(n);let c=n.getUniformLocation(r,"uCeiling");Le(n),n.uniform1i(c,3),Le(n),n.bindVertexArray(this.vao),n.drawElements(n.TRIANGLES,this.iboSize,n.UNSIGNED_INT,0),Le(n)}}const Uu="/assets/wallpaper2-BDww3Sdk.png",Nu="/assets/floor-B5gazqXr.png",vu="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIACAIAAAB7GkOtAAABhWlDQ1BJQ0MgcHJvZmlsZQAAKJF9kT1Iw0AcxV9TpSIVBwt+4JChOlkQFREnqWIRLJS2QqsOJpd+QZOGJMXFUXAtOPixWHVwcdbVwVUQBD9AnB2cFF2kxP8lhRYxHhz34929x907QKiXmWp2jAOqZhnJWFTMZFfFwCv86EcQsxiUmKnHU4tpeI6ve/j4ehfhWd7n/hw9Ss5kgE8knmO6YRFvEE9vWjrnfeIQK0oK8TnxmEEXJH7kuuzyG+eCwwLPDBnp5DxxiFgstLHcxqxoqMRTxGFF1ShfyLiscN7irJarrHlP/sJgTltJcZ3mMGJYQhwJiJBRRQllWIjQqpFiIkn7UQ//kONPkEsmVwmMHAuoQIXk+MH/4He3Zn5ywk0KRoHOF9v+GAECu0CjZtvfx7bdOAH8z8CV1vJX6sDMJ+m1lhY+Anq3gYvrlibvAZc7wMCTLhmSI/lpCvk88H5G35QF+m6B7jW3t+Y+Th+ANHW1fAMcHAKjBcpe93h3V3tv/55p9vcDwqdyx7W4IIIAAAAJcEhZcwAALiMAAC4jAXilP3YAAAAHdElNRQfoAxcOFCpDJhUwAAAAGXRFWHRDb21tZW50AENyZWF0ZWQgd2l0aCBHSU1QV4EOFwAABhdJREFUeNrt2bENAyEQRUHbgpxKaO/6pBJyEqd7OQIJZjLSnzzt3fd5ng8A9/mZAEAAABAAAE6X4iP3ZpGVRqnGN77xDbJrfBcAwKUEAEAAABAAAAQAAAEAQAAAEAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAQAAAEAQAAAEAAABAAAAQBAAAAQAAAEAEAAABAAAAQAAAEAQAAAEAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAQAAAEAQAAAEAAABAAAAQBAAAAQAAAEAEAATAAgAAAIAAACAIAAACAAAAgAAAIAgAAAIAAACAAAAgCAAAAgAAAIAAACAIAAACAAAAgAAAIAgAAAIAAACAAAAgAgAAAIAAACAIAAACAAAAgAAAIAgAAAIAAACAAAAgCAAAAgAAAIAAACAIAAACAAAAgAAAIAgAAAIAAACAAAAgAgAAAIAAACAIAAACAAAAgAAAIAgAAAIAAACAAAAgCAAAAgAAAIAAACAIAAACAAAAgAAAIAgAAAIAAACAAAAgCAAAAIAAACAIAAAHCsFB+jVIvsYnzjGx8XAAACAIAAADDX6x9A7s0iK8Wvn8Y3vvFZPL4LAOBSAgAgAAAIAAACAIAAACAAAAgAAAIAgAAAIAAACAAAAgCAAAAgAAAIAAACAIAAACAAAAgAAAIAgAAAIAAACAAAAgAgAAAIAAACAIAAACAAAAgAAAIAgAAAIAAACAAAAgCAAAAgAAAIAAACAIAAACAAAAgAAAIAgAAAIAAACAAAAgAgACYAEAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAQAAAEAQAAAEAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAQAAAEAEAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAQAAAEAQAAAEAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAQAAAEAEAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAQAAAEAQAAAEAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAQAAAEAQAAABAAAAQBAAAA4VoqPUapFdjG+8Y2PCwAAAQBAAACY6/UPIPdmkZXi10/jG9/4LB7fBQBwKQEAEAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAQAAAEAQAAAEAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAQAAAEAEAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAQAAAEAQAAAEAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAQAAAEAEAATAAgAAAIAgAAAIAAACAAAAgCAAAAgAAAIAAACAIAAACAAAAgAAAIAgAAAIAAACAAAAgCAAAAgAAAIAAACAIAAAAgAAAIAgAAAIAAACAAAAgCAAAAgAAAIAAACAIAAACAAAAgAAAIAgAAAIAAACAAAAgCAAAAgAAAIAAACAIAAAAgAAAIAgAAAIAAACAAAAgCAAAAgAAAIAAACAIAAACAAAAgAAAIAgAAAIAAACAAAAgCAAAAgAAAIAAACAIAAACAAAAIAgAAAIAAAHCvFxyjVIrsY3/jGxwUAgAAAIAAAzPX6B5B7s8hK8eun8Y1vfBaP7wIAuJQAAAgAAAIAgAAAIAAACAAAAgCAAAAgAAAIAAACAIAAACAAAAgAAAIAgAAAIAAACAAAAgCAAAAgAAAIAAACAIAAAAgAAAIAgAAAIAAACAAAAgCAAAAgAAAIAAACAIAAACAAAAgAAAIAgAAAIAAACAAAAgCAAAAgAAAIAAACAIAAAAiACQAEAAABAEAAABAAAAQAAAEAQAAAEAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAQAAAEAQAAAEAAABAAAAQBAAAAEAAABAEAAABAAAAQAAAEAQAAAEAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAQAAAEAQAAAEAAABAAAAQBAAAAEAAABAEAAABAAAAQAAAEAQAAAEAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAQAAAEAQAAAEAAABAAAAQBAAAAQAAABAEAAABAAAI6V4mOUapFdjG984+MCAEAAABAAAOb6A48KSQUZwwR0AAAAAElFTkSuQmCC",Du="/assets/eyes-BN1QhFwl.png";class Cu{update(e){const n=new Ee(this.position.getTranslation()),r=Math.floor(n.x+.5),s=Math.round(n.z);this.timer++;let i=0;switch(this.state){case"idle":if(this.timer%60===0){Math.random()>.7&&(this.state="wander");const l=[1,2,4,8];let h=[];const f=e.maze.mazemap;for(const A of l)f[r][s]&A&&h.push(on(A,r,s));this.goingTo=Gn(h).pop()}break;case"wander":i=.005,this.goingTo.distance(this.position.getTranslation())<.01&&(this.state="idle",this.position=new je().identity().translate(this.goingTo));break;case"chase":i=.015,this.goingTo.distance(this.position.getTranslation())<.01&&(this.position=new je().identity().translate(this.goingTo),this.target.loc.distance(this.goingTo)<.01?this.state="idle":this.goingTo=on(this.target.dir,this.goingTo))}const c=e.player.position.clone(),o=this.inSight(c,e.maze.mazemap);if(o===15&&c.distance(this.position.getTranslation())<.6&&(e.gameOver=!0),o&&(this.state="chase",c.x=Math.round(c.x),c.z=Math.round(c.z),this.target={loc:c,dir:o},this.goingTo.distance(on(o,r,s))&&(this.goingTo=on(0,r,s))),i>0){const l=this.goingTo.clone().subtract(this.position.getTranslation()).normalize().scale(i);this.position.translate(l)}this.draw(e)}inSight(e,n){const r=new Ee(this.position.getTranslation()),s=Math.floor(r.x+.5),i=Math.round(r.z);function c(h,f,A){if(h<0||f<0||h>=n.length||f>=n.length)return 0;let p=h,F=f;return Math.round(e.x)==h&&Math.round(e.z)==f?A:n[h][f]&A?(A===1?p=h-1:A===2?p=h+1:A===4?F=f-1:A===8&&(F=f+1),c(p,F,A)):0}let o=0;const l=[1,2,4,8];for(const h of l)o|=c(s,i,h);return o}shadow(e){}draw(e){const n=e.gl,r=this.program;this.angleX+=(Math.random()+Math.random())/10,this.angleY+=Math.random()/10,n.useProgram(r),n.bindVertexArray(this.vao);let s=n.getUniformLocation(r,"uPosition");n.uniformMatrix4fv(s,!1,this.position);let i=n.getUniformLocation(r,"uRotation");const c=new je().identity().rotateY(this.angleY).rotateX(this.angleX).scale(.1);n.activeTexture(n.TEXTURE0),n.bindTexture(n.TEXTURE_CUBE_MAP,this.texture);let o=n.getUniformLocation(r,"uTexture");n.uniform1i(o,0),n.uniformMatrix4fv(i,!1,c),dn(this.uniformSetter,e.globalUniforms),n.drawElements(n.TRIANGLE_STRIP,this.iboSize,n.UNSIGNED_INT,0)}constructor(e){let s=[],i=[],c=0;for(let p=0;p<=32;p++){const F=Math.cos(c),U=Math.sin(c);let z=0;for(let X=0;X<64;X++){const y=Math.cos(z),g=Math.sin(z),v=U*y,C=U*g,I=F;s.push(v,C,I),s.push(v,C,I),z+=2*Math.PI/64}c+=Math.PI/32}let o=0;for(let p=0;p<32;p++){for(let F=0;F<64;F++)i.push(o+F),i.push(o+F+64);i.push(o+0),i.push(o+64),o+=64}const l=i.length,h=e.createVertexArray();e.bindVertexArray(h);const f=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,f),e.bufferData(e.ARRAY_BUFFER,new Float32Array(s),e.STATIC_DRAW),e.enableVertexAttribArray(0),e.vertexAttribPointer(0,3,e.FLOAT,!1,6*4,0),e.enableVertexAttribArray(1),e.vertexAttribPointer(1,3,e.FLOAT,!1,6*4,3*4);const A=e.createBuffer();e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,A),e.bufferData(e.ELEMENT_ARRAY_BUFFER,new Uint32Array(i),e.DYNAMIC_DRAW),this.vao=h,this.iboSize=l,this.angleX=0,this.angleY=0,this.position=new je().identity(),this.state="idle",this.timer=0,this.goingTo=new Ee}loadTextures(e,n){e.useProgram(this.program),e.activeTexture(e.TEXTURE0);const r=e.createTexture();e.bindTexture(e.TEXTURE_CUBE_MAP,r),e.texImage2D(e.TEXTURE_CUBE_MAP_NEGATIVE_X,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n),e.bindTexture(e.TEXTURE_CUBE_MAP,r),e.texImage2D(e.TEXTURE_CUBE_MAP_NEGATIVE_Y,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n),e.bindTexture(e.TEXTURE_CUBE_MAP,r),e.texImage2D(e.TEXTURE_CUBE_MAP_NEGATIVE_Z,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n),e.bindTexture(e.TEXTURE_CUBE_MAP,r),e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n),e.bindTexture(e.TEXTURE_CUBE_MAP,r),e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_Y,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n),e.bindTexture(e.TEXTURE_CUBE_MAP,r),e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_Z,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n),e.bindTexture(e.TEXTURE_CUBE_MAP,r),e.generateMipmap(e.TEXTURE_CUBE_MAP),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_WRAP_R,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_LINEAR),this.texture=r}}class Lu{update(e){const n=e.gl,r=this.program;n.useProgram(r),dn(this.uniformSetter,e.globalUniforms);let s=n.getUniformLocation(r,"ucolor");n.uniform4fv(s,new $n(.4,0,1,1)),n.bindVertexArray(this.vao),n.drawElements(n.TRIANGLES,this.iboSize,n.UNSIGNED_INT,0)}shadow(e){const n=e.gl;n.bindVertexArray(this.vao),n.drawElements(n.TRIANGLES,this.iboSize,n.UNSIGNED_INT,0)}constructor(e,n,r){this.program=n,this.position=r;const s=[.2,0,0],i=new Ee([-.01,-.5,-.01]),c=new Ee(i).add([.02,.75,.02]),o=[],l=[];{const p=vn(new Ee(i).add(r).add(s),new Ee(c).add(r).add(s),o.length/6);o.push(...p.vbo),l.push(...p.ibo)}{const p=vn(new Ee(i).add(r).subtract(s),new Ee(c).add(r).subtract(s),o.length/6);o.push(...p.vbo),l.push(...p.ibo)}{const p=vn(new Ee(c).add(r).add(s),new Ee(c).add(r).subtract(s).subtract([.02,.02,.02]),o.length/6);o.push(...p.vbo),l.push(...p.ibo)}const h=e.createVertexArray();e.bindVertexArray(h);const f=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,f),e.bufferData(e.ARRAY_BUFFER,new Float32Array(o),e.STATIC_DRAW),e.enableVertexAttribArray(0),e.vertexAttribPointer(0,3,e.FLOAT,!1,6*4,0),e.enableVertexAttribArray(1),e.vertexAttribPointer(1,3,e.FLOAT,!1,6*4,3*4);const A=e.createBuffer();e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,A),e.bufferData(e.ELEMENT_ARRAY_BUFFER,new Uint32Array(l),e.STATIC_DRAW),this.vao=h,this.iboSize=l.length,this.uniformSetter=An(e,n)}}const Ou=t=>{const e=t.gl,n=new je().identity();let r=.01,s=100,i=e.canvas.width/e.canvas.height;e.viewport(0,0,e.canvas.width,e.canvas.height),Le(e);const c=new je().perspective({fovy:Math.PI/3,aspect:i,near:r,far:s}),o=new je().perspective({fovy:60*Math.PI/180,aspect:i,near:.2,far:50}),l=4;new je().ortho({left:-l,right:l,bottom:-l,top:l,near:.1,far:20}),n.identity(),n.rotateX(t.theta*Math.PI/180),n.rotateY(t.phi*Math.PI/180),n.multiplyRight(new je().identity().translate(t.player.position.clone().scale(-1))),e.colorMask(!0,!0,!0,!0);let h=new je().identity();h.rotateY(-t.phi*Math.PI/180),h.rotateX(-t.theta*Math.PI/180),h.translate([0,0,-.091]),h.rotateX(t.theta*Math.PI/180),h.rotateY(t.phi*Math.PI/180);const f=o.clone();f.multiplyRight(n),f.multiplyRight(h),f.multiplyRight(new je().identity().translate([0,.02,0])),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),e.cullFace(e.FRONT),t.player.drawShadowMap(e,t,f),e.cullFace(e.BACK),n.getRotation();const A={uProjection:c.clone(),uModelView:n.clone(),lightPosition:t.player.position.clone().add([0,-.02,0]).add(new Ee(h.getTranslation()).scale(-1)),u_lightDirection:new Ee(h.getTranslation()).normalize(),u_limit:Math.cos(18*Math.PI/180),uFlashlight:t.flashlight,uShadowMap:t.player.shadowMapTex,uLightViewProjection:f,u_outerLimit:Math.cos(32*Math.PI/180)};t.globalUniforms=A,t.objects.forEach(p=>{p.update(t)})},zu=()=>{const t=cn.useRef(),e=cn.useRef(),n=()=>{if(!e.current)return;const o=e.current;if(o.gameOver){o.gl.clearColor(0,0,0,1),It("over");return}if(o.player.position.distance(o.goal.position)<.2){o.gl.clearColor(0,0,0,1),It("victory");return}Iu(o),Ou(o),o.inputManager.update(),requestAnimationFrame(n)},r=()=>{e.current&&document.body.requestPointerLock()},s=o=>{if(!e.current)return;const l=e.current,h=10;l.phi+=o.movementX/h,l.theta=as(l.theta+o.movementY/h,-80,80)},i=o=>{if(console.log("Connected"),!e.current)return;const l=e.current;l.controllerIndex=o.gamepad.index},c=async()=>{const o=t.current.getContext("webgl2",{antialias:!0,preserveDrawingBuffer:!0});if(!o)return;const l=[];for(const v of o.getSupportedExtensions())l.push(o.getExtension(v));console.log(l),o.enable(o.CULL_FACE),o.enable(o.DEPTH_TEST),o.clearColor(0,0,0,1),o.enable(o.BLEND),o.blendFunc(o.SRC_ALPHA,o.ONE_MINUS_SRC_ALPHA);const h=sn(o,mc,hc);o.useProgram(h);const f=new Array,A=9,p=new Pu(o,A);p.program=sn(o,uc,Ac);const F=await $u();p.loadTextures(o,F),f.push(p);const U=new Cu(o);U.program=sn(o,fc,lc);for(var z=p.start.copy();z.distance(p.start)<A-1;)z=new xt(Math.floor(Math.random()*A),Math.floor(Math.random()*A));U.position.translate(z.vec3()),U.loadTextures(o,await fn(Du)),f.push(U);const X=new Lu(o,sn(o,Ec,dc),p.goal.vec3());f.push(X);const y=new wu(o,h);y.position=new Ee(p.start.x,0,p.start.y),y.uniformSetter=An(o,y.prShadowMap),t.current.addEventListener("mousedown",r),document.addEventListener("mousemove",s,!1),window.addEventListener("gamepadconnected",i),p.uniformSetter=An(o,p.program),U.uniformSetter=An(o,U.program),e.current={gl:o,goal:X,inputManager:Ln,maze:p,phi:270,theta:5,gameOver:!1,globalUniforms:new Array,objects:f,controllerIndex:null,flashlight:!0,player:y},ss(t.current);const g=()=>{o.viewport(0,0,o.canvas.width,o.canvas.height)};window.addEventListener("resize",()=>{ss(t.current)&&g()}),requestAnimationFrame(n)};return cn.useEffect(()=>{c()},[]),ue.jsx("div",{className:"relative bg-black h-[inherit] w-full",children:ue.jsx("canvas",{ref:t,className:"w-full h-[inherit]"})})},fn=async t=>{const e=new Image;return await new Promise((n,r)=>{e.onload=()=>{n()},e.onerror=function(){console.log(t,"not found."),r()},e.src=t}),e},$u=async()=>{const t=new Array;return t.push(await fn(Uu)),t.push(await fn(Nu)),t.push(await fn(vu)),t},os=t=>ue.jsx("button",{...t,onClick:t.onClick,className:"bg-dingusGreen uppercase p-2 text-neutral-50 transition-all hover:bg-dingusOrange active:scale-100 hover:scale-110 duration-200 ease-in-out rounded-xl pr-4 pl-4 pointer-events-auto w-36 h-36",children:t.children??ue.jsx(ue.Fragment,{children:" "})}),ku=t=>ue.jsx("div",{className:"w-full pt-24 h-[inherit] flex justify-center items-center flex-wrap gap-2",children:t.children}),Gu=()=>{const[t,e]=On.useState("english");return console.log(),ue.jsx("div",{className:t=="french"?"relative place-content-center flex flex-col h-full w-full bg-gradient-to-r from-blue-800  via-red-50  to-red-800":"relative place-content-center flex flex-col bg-black h-full w-full",children:ue.jsxs("div",{className:"h-fit justify-center",children:[ue.jsx("div",{className:"relative w-full flex justify-center items-center flex-wrap gap-2 text-9xl "+(t=="french"?"text-neutral-700":"text-neutral-50"),children:t=="french"?"La Byrinthe":"Labyrinth"}),ue.jsxs("div",{className:"pt-24 w-full flex flex-col justify-center items-center flex-wrap gap-2 text-xl "+(t=="french"?"text-neutral-700":"text-neutral-50"),children:[ue.jsx("div",{children:"Controls: "}),ue.jsx("div",{children:t=="french"?"ZQSD - Le Move":"WASD - Move"}),ue.jsx("div",{className:"text-yellow-300 animate-pulse",children:"F - Flashlight"}),ue.jsx("div",{children:t=="french"?"je ma pal - shift to run":"Shift to run"}),ue.jsx("div",{children:"🎮 - Supported "}),ue.jsx("div",{children:t=="french"?"le-ft l’épaule - le nyuum":"left shoulder - sprint"}),ue.jsx("div",{children:t=="french"?"droit l’épaule - la-mp off":"right shoulder - toggle flashlight"})]}),ue.jsxs(ku,{children:[ue.jsx(os,{onClick:()=>{It("game"),document.body.requestFullscreen().then(()=>{document.body.requestPointerLock()})},children:t=="french"?"Baguette":"Start"}),ue.jsx(os,{onClick:()=>{Ln.addKeyAction("q","left"),Ln.addKeyAction("z","forward"),e("french")},children:t=="french"?"Hon Hon":"French Mode"})]})]})})},Vu="/assets/win-C35m3YYV.png",Xu=()=>(On.useEffect(()=>{document.exitPointerLock(),document.exitFullscreen()},[]),ue.jsx("div",{className:" relative h-[inherit] w-full",children:ue.jsx("div",{className:"bg-cover bg-center h-[inherit] w-full",style:{backgroundImage:`url(${Vu})`},onClick:()=>{It("menu")}})}));let It,Ln=new ha;const Yu=()=>{const[t,e]=cn.useState("menu");switch(It=e,t){case"menu":return ue.jsx(Gu,{});case"game":return ue.jsx(zu,{});case"victory":return ue.jsx(Xu,{});default:return ue.jsx(Ea,{})}};export{Yu as default,Ln as inManager,It as setScene};
