import{R as ca,j as _e,r as en}from"./index-DcHf0UW2.js";(function(t){typeof define=="function"&&define.amd?define(t):t()})(function(){function t(o){return o.startsWith("gl_")||o.startsWith("webgl_")}function e(o){return!!o.texImage3D}function n(o){return o&&o.buffer&&o.buffer instanceof ArrayBuffer}function r(o){return Array.isArray(o)||o instanceof Float32Array||o instanceof Float64Array}function s(o){return o?`"${o}"`:""}const i={};function a(o,b){const y=[];if(b.length){for(let F=0;F<b.length;++F)b.push(m(b[F]));return"["+y.join(", ")+"]"}return y.toString()}function c(o){return function(b,y){let F=0;const P=[];for(let L=0;L<o.length;++L){const k=i[o[L]];y&k&&(F|=k,P.push(m(k)))}return F===y?P.join(" | "):m(y)}}const u=new Map;function d(o){for(const b in o){const y=o[b];typeof y=="number"&&(u.has(y)||u.set(y,new Set),u.get(y).add(b))}}function m(o){const b=u.get(o);return b?[...b.keys()].map(y=>`${y}`).join(" | "):`/*UNKNOWN WebGL ENUM*/ ${typeof o=="number"?`0x${o.toString(16)}`:o}`}const f=5126,_=35664,I=35665,O=35666,p=5124,g=35667,X=35668,ee=35669,w=35670,$=35671,W=35672,Y=35673,le=35674,Ae=35675,H=35676,q=35678,ie=35680,oe=35679,ae=35682,K=35685,he=35686,Ne=35687,Ie=35688,ke=35689,hs=35690,Es=36289,ds=36292,xs=36293,Pt=5125,wn=36294,Nn=36295,Dn=36296,bs=36298,Ts=36299,ps=36300,ys=36303,Rs=36306,_s=36307,gs=36308,Fs=36311,Ms=new Map([[f,{size:1,name:"float"}],[_,{size:2,name:"vec2"}],[I,{size:3,name:"vec3"}],[O,{size:4,name:"vec4"}],[p,{size:1,name:"int"}],[g,{size:2,name:"ivec2"}],[X,{size:3,name:"ivec3"}],[ee,{size:4,name:"ivec4"}],[Pt,{size:1,name:"uint"}],[wn,{size:2,name:"uvec2"}],[Nn,{size:3,name:"uvec3"}],[Dn,{size:4,name:"uvec4"}],[w,{size:1,name:"bool"}],[$,{size:2,name:"bvec2"}],[W,{size:3,name:"bvec3"}],[Y,{size:4,name:"bvec4"}],[le,{size:4,name:"mat2"}],[Ae,{size:9,name:"mat3"}],[H,{size:16,name:"mat4"}],[K,{size:6,name:"mat2x3"}],[he,{size:8,name:"mat2x4"}],[Ne,{size:6,name:"mat3x2"}],[Ie,{size:12,name:"mat3x4"}],[ke,{size:8,name:"mat4x2"}],[hs,{size:12,name:"mat4x3"}],[q,{size:1,name:"sampler2D"}],[ie,{size:1,name:"samplerCube"}],[oe,{size:1,name:"sampler3D"}],[ae,{size:1,name:"sampler2DShadow"}],[Es,{size:1,name:"sampler2DArray"}],[ds,{size:1,name:"sampler2DArrayShadow"}],[xs,{size:1,name:"samplerCubeShadow"}],[bs,{size:1,name:"isampler2D"}],[Ts,{size:1,name:"isampler3D"}],[ps,{size:1,name:"isamplerCube"}],[ys,{size:1,name:"isampler2DArray"}],[Rs,{size:1,name:"usampler2D"}],[_s,{size:1,name:"usampler3D"}],[gs,{size:1,name:"usamplerCube"}],[Fs,{size:1,name:"usampler2DArray"}]]);function gt(o){return Ms.get(o)}const Is=32873,Ss=34068,Bs=32874,Us=35869,Ps=34962,ws=34963,Ns=34964,Ds=34965,Cs=3553,vs=32879,Ls=35866,Os=34067,zs=36160,$s=36161,Cn=36006,Gs=36007,ks=35982,Vs=35983,Xs=36009,Ws=36008,Ys=36010,Qs=35345,js=35368,Hs=36386,qs=36389,Ks=new Map([[Ps,Ns],[ws,Ds],[Cs,Is],[Os,Ss],[vs,Bs],[Ls,Us],[$s,Gs],[zs,Cn],[Xs,Cn],[Ws,Ys],[Qs,js],[ks,Vs],[Hs,qs]]);function vn(o){return Ks.get(o)}const Zs=5120,Js=5122,Ln=5121,On=5123,ei=new Map([[w,1],[Zs,1],[Ln,1],[Js,2],[On,2],[p,4],[Pt,4],[f,4]]);function zn(o){return ei.get(o)||0}const ti=new Map([[Ln,Uint8Array],[On,Uint16Array],[Pt,Uint32Array]]);function ni(o){return ti.get(o)}const $n={drawArrays(o,b,y){return{startOffset:b,vertCount:y,instances:1}},drawElements(o,b,y,F){return{startOffset:F,vertCount:b,instances:1,indexType:y}},drawArraysInstanced(o,b,y,F){return{startOffset:b,vertCount:y,instances:F}},drawElementsInstanced(o,b,y,F,P){return{startOffset:F,vertCount:b,instances:P,indexType:y}},drawArraysInstancedANGLE(o,b,y,F){return{startOffset:b,vertCount:y,instances:F}},drawElementsInstancedANGLE(o,b,y,F,P){return{startOffset:F,vertCount:b,instances:P,indexType:y}},drawRangeElements(o,b,y,F,P,L){return{startOffset:L,vertCount:F,instances:1,indexType:P}}};function Gn(o,b){return $n[o](...b)}function un(o){return!!$n[o]}const ri=new Map([[f,{size:4}],[_,{size:8}],[I,{size:12}],[O,{size:16}],[p,{size:4}],[g,{size:8}],[X,{size:12}],[ee,{size:16}],[Pt,{size:4}],[wn,{size:8}],[Nn,{size:12}],[Dn,{size:16}],[w,{size:4}],[$,{size:8}],[W,{size:12}],[Y,{size:16}],[le,{size:4,count:2}],[Ae,{size:9,count:3}],[H,{size:16,count:4}]]);function si(o){return ri.get(o)}const it=o=>o?new WeakRef(o):null,ot=(o,b)=>{const y=o==null?void 0:o.deref();return!!y!=!!b?!1:y?y===b:!0};function kn(o,b){return o==="undefined"?b:o}const ii=35070;function oi(o,b){return o+b-1}function ai(o,b,y,F,P,L,k,z,V){const D=o.getParameter(o.ELEMENT_ARRAY_BUFFER_BINDING);if(!D){V.push("No ELEMENT_ARRAY_BUFFER bound");return}const Z=zn(L),Ee=o.getBufferParameter(o.ELEMENT_ARRAY_BUFFER,o.BUFFER_SIZE),ge=y+F*Z;if(ge>Ee){V.push(`offset: ${y} and count: ${F} with index type: ${m(L)} passed to ${b} are out of range for current ELEMENT_ARRAY_BUFFER.
Those parameters require ${ge} bytes but the current ELEMENT_ARRAY_BUFFER ${k(D)} only has ${Ee} bytes`);return}const Be=z(D),Fe=ni(L),Ue=new Fe(Be,y);let be=Ue[0];for(let rt=1;rt<F;++rt)be=Math.max(be,Ue[rt]);return be}function ci(o,b,y,F,P){const{vertCount:L,startOffset:k,indexType:z,instances:V}=Gn(b,y);if(L<=0||V<=0)return[];const D=o.getParameter(o.CURRENT_PROGRAM),Z=[],Ee=z?ai(o,b,k,L,V,z,F,P,Z):oi(k,L);if(Z.length)return Z;const ge=e(o)||o.getExtension("ANGLE_instanced_arrays"),Be=o.getProgramParameter(D,o.ACTIVE_ATTRIBUTES),Fe=o.getParameter(o.ARRAY_BUFFER_BINDING);for(let Ue=0;Ue<Be;++Ue){const{name:be,type:rt}=o.getActiveAttrib(D,Ue);if(t(be))continue;const Je=o.getAttribLocation(D,be),{count:Et}={count:1,...si(rt)};for(let ne=0;ne<Et;++ne){const de=Je+ne;if(!o.getVertexAttrib(de,o.VERTEX_ATTRIB_ARRAY_ENABLED))continue;const De=o.getVertexAttrib(de,o.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING);if(!De){Z.push(`no buffer bound to attribute (${be}) location: ${Je}`);continue}const v=o.getVertexAttrib(de,o.VERTEX_ATTRIB_ARRAY_SIZE),G=o.getVertexAttrib(de,o.VERTEX_ATTRIB_ARRAY_TYPE),B=zn(G)*v,S=o.getVertexAttribOffset(de,o.VERTEX_ATTRIB_ARRAY_POINTER),C=o.getVertexAttrib(de,o.VERTEX_ATTRIB_ARRAY_STRIDE),J=C||B,Q=ge?o.getVertexAttrib(de,ii):0;o.bindBuffer(o.ARRAY_BUFFER,De);const ue=o.getBufferParameter(o.ARRAY_BUFFER,o.BUFFER_SIZE),re=Q>0?((V+Q-1)/Q|0)-1:Ee,se=S+re*J+B;se>ue&&Z.push(`${F(De)} assigned to attribute ${de} used as attribute '${be}' in current program is too small for draw parameters.
index of highest vertex accessed: ${re}
attribute size: ${v}, type: ${m(G)}, stride: ${C}, offset: ${S}, divisor: ${Q}
needs ${se} bytes for draw but buffer is only ${ue} bytes`)}}return o.bindBuffer(o.ARRAY_BUFFER,Fe),Z}const Vn=35678,Xn=35680,Wn=35679,Yn=35682,Qn=36289,jn=36292,Hn=36293,Ai=36298,ui=36299,fi=36300,li=36303,mi=36306,hi=36307,Ei=36308,di=36311,wt=new Map([[Vn,{uniformType:"sampler2D",numberType:"float/normalized",bindPoint:"2D"}],[Xn,{uniformType:"samplerCube",numberType:"float/normalized",bindPoint:"CUBE"}],[Wn,{uniformType:"sampler3D",numberType:"float/normalized",bindPoint:"3D"}],[Yn,{uniformType:"sampler2D",numberType:"float/normalized",bindPoint:"2D"}],[Qn,{uniformType:"sampler2DArray",numberType:"float/normalized",bindPoint:"2D_ARRAY"}],[jn,{uniformType:"sampler2DArray",numberType:"float/normalized",bindPoint:"2D_ARRAY"}],[Hn,{uniformType:"samplerCube",numberType:"float/normalized",bindPoint:"CUBE"}],[Ai,{uniformType:"isampler2D",numberType:"int",bindPoint:"2D"}],[ui,{uniformType:"isampler3D",numberType:"int",bindPoint:"3D"}],[fi,{uniformType:"isamplerCube",numberType:"int",bindPoint:"CUBE"}],[li,{uniformType:"isampler2DArray",numberType:"int",bindPoint:"2D_ARRAY"}],[mi,{uniformType:"usampler2D",numberType:"unsigned int",bindPoint:"2D"}],[hi,{uniformType:"usampler3D",numberType:"unsigned int",bindPoint:"3D"}],[Ei,{uniformType:"usamplerCube",numberType:"unsigned int",bindPoint:"CUBE"}],[di,{uniformType:"usampler2DArray",numberType:"unsigned int",bindPoint:"2D_ARRAY"}]]);function xi(o){return wt.get(o).bindPoint}function Nt(o){return wt.has(o)}function bi(o){return wt.get(o).numberType}function qn(o){return wt.get(o).uniformType}const Ti=3553,pi=32879,yi=35866,Ri=34067,_i=34069,gi=34070,Fi=34071,Mi=34072,Ii=34073,Si=34074,Bi=new Map([[Ti,"2D"],[pi,"3D"],[Ri,"CUBE"],[_i,"CUBE"],[gi,"CUBE"],[Fi,"CUBE"],[Mi,"CUBE"],[Ii,"CUBE"],[Si,"CUBE"],[yi,"2D_ARRAY"]]);function Kn(o){return Bi.get(o)}const Zn=32873,Jn=34068,Ui=32874,er=35869,Pi=new Map([[Vn,Zn],[Yn,Zn],[Wn,Ui],[Qn,er],[jn,er],[Xn,Jn],[Hn,Jn]]);function wi(o,b,y){o.activeTexture(o.TEXTURE0+b);const F=Pi.get(y);return o.getParameter(F)}const Ni=36063;function Di(o){return!e(o)&&!o.getExtension("WEBGL_draw_buffers")?1:o.getParameter(Ni)}function Dt(o,b,y){if(o.getFramebufferAttachmentParameter(o.FRAMEBUFFER,b,o.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE)===o.NONE)return;const P=o.getFramebufferAttachmentParameter(o.FRAMEBUFFER,b,o.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME);P instanceof WebGLTexture&&(y.has(P)||y.set(P,[]),y.get(P).push(b))}function Ci(o,b){const y=o.getParameter(o.FRAMEBUFFER_BINDING);if(!y)return[];const F=Di(o),P=new Map;for(let D=0;D<F;++D)Dt(o,o.COLOR_ATTACHMENT0+D,P);Dt(o,o.DEPTH_ATTACHMENT,P),Dt(o,o.STENCIL_ATTACHMENT,P),e(o)||Dt(o,o.DEPTH_STENCIL_ATTACHMENT,P);const L=o.getParameter(o.ACTIVE_TEXTURE),k=o.getParameter(o.CURRENT_PROGRAM),z=o.getProgramParameter(k,o.ACTIVE_UNIFORMS),V=[];for(let D=0;D<z;++D){const{name:Z,type:Ee,size:ge}=o.getActiveUniform(k,D);if(!(t(Z)||!Nt(Ee)))if(ge>1){const Be=Z.substr(-3)==="[0]"?Z.substr(0,Z.length-3):Z;for(let Fe=0;Fe<ge;++Fe)V.push(...tr(o,y,P,k,`${Be}[${Fe}]`,Ee,b))}else V.push(...tr(o,y,P,k,Z,Ee,b))}return o.activeTexture(L),V}function tr(o,b,y,F,P,L,k){const z=o.getUniformLocation(F,P),V=o.getUniform(F,z),D=wi(o,V,L),Z=y.get(D);return Z?[`${k(D)} on uniform: ${P} bound to texture unit ${V} is also attached to ${k(b)} on attachment: ${Z.map(Ee=>m(Ee)).join(", ")}`]:[]}function vi(){const o=navigator.userAgent;let b=o.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];if(/trident/i.test(b[1]))return b=/\brv[ :]+(\d+)/g.exec(o)||[],{name:"IE",version:b[1]};if(b[1]==="Chrome"){const F=o.match(/\b(OPR|Edge)\/(\d+)/);if(F)return{name:F[1].replace("OPR","Opera"),version:F[2]}}b=b[2]?[b[1],b[2]]:[navigator.appName,navigator.appVersion,"-?"];const y=o.match(/version\/(\d+)/i);return y&&b.splice(1,1,y[1]),{name:b[0],version:b[1]}}const Li=function(){const o=vi();let b,y;return/chrome|opera/i.test(o.name)?(b=3,y=function(F){const P=/at ([^(]+)*\(*(.*?):(\d+):(\d+)/.exec(F);if(P){let L=P[1],k=P[2];const z=parseInt(P[3]),V=parseInt(P[4]);return k===""&&(k=L,L=""),{url:k,lineNo:z,colNo:V,funcName:L}}}):/firefox|safari/i.test(o.name)&&(b=2,y=function(F){const P=/@(.*?):(\d+):(\d+)/.exec(F);if(P){const L=P[1],k=parseInt(P[2]),z=parseInt(P[3]);return{url:L,lineNo:k,colNo:z}}}),function(P){if(y)try{const L=P.split(`
`);return y(L[b])}catch{}}}();function Oi(o){const b=[],y=o.getParameter(o.MAX_COMBINED_TEXTURE_IMAGE_UNITS);for(let F=0;F<y;++F)b.push(new Map);return b}const zi=33984,fn=3553,ln=32879,at=34067,Ct=34069,nr=34070,rr=34071,sr=34072,ir=34073,or=34074,ar=10241,cr=10240,vt=33084,Ar=33085,ur=10242,fr=10243,lr=10497,mr=35866,Lt=33071,mn=9728,hr=9729,$i=9986,Gi=new Map([[9,function([o,b,y,F,P,,L,k]){return{target:o,level:b,internalFormat:y,width:F,height:P,format:L,type:k}}],[6,function([o,b,y,F,P,L]){return{target:o,level:b,internalFormat:y,width:L.width,height:L.height,format:F,type:P}}],[10,function([o,b,y,F,P,,L,k]){return{target:o,level:b,internalFormat:y,width:F,height:P,format:L,type:k}}]]),Ot=6406,Ye=6407,Qe=6408,zt=6409,$t=6410,hn=6402,Er=34041,dr=new Set([Ot,zt,$t,Ye,Qe]);function Ft(o,b){return dr.has(o)?`${m(o)}/${m(b)}`:m(o)}const xr=new Map([[fn,0],[ln,0],[mr,0],[at,0],[Ct,0],[nr,1],[rr,2],[sr,3],[ir,4],[or,5]]);function En(o,b){return b===at?`(${m(Ct+o)})`:""}const ki=[fn],Vi=[Ct,nr,rr,sr,ir,or],Xi=33321,Wi=36756,br=33325,Tr=33326,Yi=33330,Qi=33329,ji=33338,Hi=33337,qi=33340,Ki=33339,Zi=33323,Ji=36757,pr=33327,yr=33328,eo=33336,to=33335,no=33332,ro=33331,so=33334,io=33333,oo=32849,ao=35905,co=36194,Ao=36758,uo=35898,fo=35901,Rr=34843,_r=34837,lo=36221,mo=36239,ho=36215,Eo=36233,xo=36209,bo=36227,To=32856,po=35907,yo=36759,Ro=32855,_o=32854,go=32857,gr=34842,Fr=34836,Fo=36220,Mo=36238,Io=36975,So=36214,Bo=36232,Uo=36226,Po=36208,wo=33189,No=33190,Do=36012,Co=36013,vo=35056,ct=5120,Se=5121,Gt=5122,Mt=5123,kt=5124,bt=5125,Ve=5126,Mr=32819,Ir=32820,Sr=33635,At=5131,Br=36193,dn=33640,Lo=35899,Oo=35902,zo=36269,$o=34042,Vt=33319,Tt=33320,Xt=6403,pt=36244,yt=36248,ht=36249;function Go(){const o=new Map([[Ot,{textureFormat:Ot,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1,2,2,4],type:[Se]}],[zt,{textureFormat:zt,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1,2,2,4],type:[Se]}],[$t,{textureFormat:$t,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[2,4,4,8],type:[Se]}],[Ye,{textureFormat:Ye,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3,6,6,12,2],type:[Se,Sr]}],[Qe,{textureFormat:Qe,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,8,8,16,2,2],type:[Se,Mr,Ir]}],[Xi,{textureFormat:Xt,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1],type:[Se]}],[Wi,{textureFormat:Xt,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[1],type:[ct]}],[br,{textureFormat:Xt,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[4,2],type:[Ve,At]}],[Tr,{textureFormat:Xt,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[4],type:[Ve]}],[Yi,{textureFormat:pt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[1],type:[Se]}],[Qi,{textureFormat:pt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[1],type:[ct]}],[no,{textureFormat:pt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[Mt]}],[ro,{textureFormat:pt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[Gt]}],[so,{textureFormat:pt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[bt]}],[io,{textureFormat:pt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[kt]}],[Zi,{textureFormat:Vt,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[2],type:[Se]}],[Ji,{textureFormat:Vt,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[2],type:[ct]}],[pr,{textureFormat:Vt,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[8,4],type:[Ve,At]}],[yr,{textureFormat:Vt,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[8],type:[Ve]}],[eo,{textureFormat:Tt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[Se]}],[to,{textureFormat:Tt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[ct]}],[ji,{textureFormat:Tt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Mt]}],[Hi,{textureFormat:Tt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Gt]}],[qi,{textureFormat:Tt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[bt]}],[Ki,{textureFormat:Tt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[kt]}],[oo,{textureFormat:Ye,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3],type:[Se]}],[ao,{textureFormat:Ye,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[3],type:[Se]}],[co,{textureFormat:Ye,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3,2],type:[Se,Sr]}],[Ao,{textureFormat:Ye,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[3],type:[ct]}],[uo,{textureFormat:Ye,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6,4],type:[Ve,At,Lo]}],[fo,{textureFormat:Ye,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6,4],type:[Ve,At,Oo]}],[Rr,{textureFormat:Ye,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6],type:[Ve,At]}],[_r,{textureFormat:Ye,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[Ve]}],[lo,{textureFormat:yt,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[3],type:[Se]}],[mo,{textureFormat:yt,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[3],type:[ct]}],[ho,{textureFormat:yt,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[6],type:[Mt]}],[Eo,{textureFormat:yt,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[6],type:[Gt]}],[xo,{textureFormat:yt,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[bt]}],[bo,{textureFormat:yt,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[kt]}],[To,{textureFormat:Qe,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[Se]}],[po,{textureFormat:Qe,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[Se]}],[yo,{textureFormat:Qe,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[4],type:[ct]}],[Ro,{textureFormat:Qe,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,2,4],type:[Se,Ir,dn]}],[_o,{textureFormat:Qe,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,2],type:[Se,Mr]}],[go,{textureFormat:Qe,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[dn]}],[gr,{textureFormat:Qe,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[16,8],type:[Ve,At]}],[Fr,{textureFormat:Qe,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[16],type:[Ve]}],[Fo,{textureFormat:ht,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Se]}],[Mo,{textureFormat:ht,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[ct]}],[Io,{textureFormat:ht,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[dn]}],[So,{textureFormat:ht,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[Mt]}],[Bo,{textureFormat:ht,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[Gt]}],[Uo,{textureFormat:ht,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[16],type:[kt]}],[Po,{textureFormat:ht,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[16],type:[bt]}],[wo,{textureFormat:hn,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[2,4],type:[Mt,bt]}],[No,{textureFormat:hn,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[bt]}],[Do,{textureFormat:hn,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[Ve]}],[vo,{textureFormat:Er,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[$o]}],[Co,{textureFormat:Er,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[zo]}]]);o.forEach(y=>{y.bytesPerElementMap={},y.bytesPerElement.forEach(function(F,P){const L=y.type[P];y.bytesPerElementMap[L]=F})});const b=new Map;return o.forEach((y,F)=>{dr.has(F)?y.type.forEach(P=>{b.set(Ft(F,P),y)}):b.set(Ft(F),y)}),{textureInternalFormatInfoMap:o,internalFormatStringToFormatInfoMap:b}}function Wt(o){return(o&o-1)===0}function xn(o,b=0,y=0){return(Math.log2(Math.max(o,b,y))|0)+1}function Yt(o,...b){return o?b:[]}function Ur(o,b){return[...Yt(!Wt(o),`width(${o}) is not a power of 2`),...Yt(!Wt(b),`height(${b}) is not a power of 2`)].join(" and ")}function ko(o,b){return[...Yt(o!==Lt,`TEXTURE_WRAP_S (${m(o)}) is not CLAMP_TO_EDGE`),...Yt(b!==Lt,`TEXTURE_WRAP_T (${m(b)}) is not CLAMP_TO_EDGE`)].join(" and ")}function Vo(o){const b=m(o);return b.endsWith("UI")?"unsigned int":b.endsWith("I")?"int":"float/normalized"}function Pr(o,b,y,F){return o===fn||o===at?`${b}x${y}`:`${b}x${y}x${F}`}class Xo{constructor(b,y){this.redundantStateSetting=y;const F=e(b),P=!F,L=new Set,k=new Map,z=new Map,V=Oi(b),D=xn(b.getParameter(b.MAX_TEXTURE_SIZE)),{internalFormatStringToFormatInfoMap:Z}=Go();let Ee=0,ge=V[0];this.numTextureUnits=V.length;function Be(v){v.notRenderable=Ue(v,v.parameters)}function Fe(){k.forEach(Be)}function Ue(v,G){const{type:B,mips:S}=v,C=G.get(vt)||0,J=kn(G.get(Ar),D);if(J<C)return`TEXTURE_MAX_LEVEL(${J}) is less than TEXTURE_BASE_LEVEL(${C})`;const Q=S[C];if(!Q)return"no base level mip ${baseLevel}";const ue=Q[0];if(!ue)return"TEXTURE_CUBE_MAP_POSITIVE_X face does not exist";const{width:re,height:se,depth:Pe,internalFormatString:Te}=ue,Ge=B===at?6:1,we=G.get(ar),ut=Z.get(Te);if(ut&&!ut.textureFilterable){if(we!==mn)return`texture of type (${Te}) is not filterable but TEXTURE_MIN_FILTER is set to ${m(we)}`;{const Ce=G.get(cr);if(Ce!==mn)return`texture of type (${Te}) is not filterable but TEXTURE_MAG_FILTER is set to ${m(Ce)}`}}const et=we===hr||we===mn?1:xn(re,se,Pe);{let Me=re,Ce=se,tt=Pe;const He=Math.min(J,C+et-1);for(let xe=C;xe<=He;++xe){const dt=S[xe];if(!dt)return`filtering is set to use mips from level ${C} to ${He} with (TEXTURE_MIN_FILTER = ${m(we)}) but mip level ${xe} does not exist`;for(let ft=0;ft<Ge;++ft){const qe=dt[ft];if(!qe)return`filtering is set to use mips level ${C} to ${He} with (TEXTURE_MIN_FILTER = ${m(we)}) but mip level ${xe}${En(ft,B)} does not exist`;if(qe.width!==Me||qe.height!==Ce||qe.depth!==tt)return`mip level ${xe}${En(ft,B)} needs to be ${Pr(B,Me,Ce,tt)} but it is ${Pr(B,qe.width,qe.height,qe.depth)}`;if(qe.internalFormatString!==Te)return`mip level ${xe}${En(ft,B)}'s internal format ${qe.internalFormatString} does not match mip level ${C}'s internal format ${Te}`}Me=Math.max(1,Me/2|0),Ce=Math.max(1,Ce/2|0),B!==mr&&(tt=Math.max(1,tt/2|0))}}if(P&&(!Wt(re)||!Wt(se))){if(et>1)return`texture's ${Ur(re,se)} but TEXTURE_MIN_FILTER (${m(we)}) is set to need mips`;const Me=G.get(ur),Ce=G.get(fr);if(Me!==Lt||Ce!==Lt)return`texture's ${Ur(re,se)} but ${ko(Me,Ce)}.`}if(B===at&&re!==se)return`texture is CUBE_MAP but dimensions ${re}x${se} are not square`}function be(v){const G=Kn(v),B=ge.get(G);return k.get(B)}function rt(v,G){const B=be(v),S=xr.get(v);return B.mips[G][S]}function Je(v,G,B){const S=be(v);S.parameters.set(G,B),Be(S)}function Et(v,G){for(let B=0;B<V.length;++B){const S=V[B];S.get(v)===G&&S.set(v,null)}}function ne(v){const{mips:G,parameters:B}=v,S=B.get(vt)||0,C=G[S];if(!C)return"";const J=C[0];return J?J.internalFormatString:""}function de(v,G){const B=L.has(G);[Qe,Ye,zt,$t,Ot].forEach(S=>{Z.set(Ft(S,v),{textureFormat:b.RGBA,textureFilterable:B})})}function jt(v){for(const G of v){const B=Z.get(Ft(G));B.textureFilterable=!0}}this.addExtension=function(v){switch(L.add(v),v){case"oes_texture_float":de(Ve,"oes_texture_float_linear");break;case"oes_texture_float_linear":F?jt([Tr,yr,_r,Fr]):L.has("oes_texture_float")&&de(Ve,"oes_texture_float_linear"),Fe();break;case"oes_texture_half_float":de(At,"oes_texture_half_float_linear"),de(Br,"oes_texture_half_float_linear");break;case"oes_texture_half_float_linear":F?jt([br,pr,Rr,gr]):L.has("oes_texture_half_float")&&(de(At,"oes_texture_half_float_linear"),de(Br,"oes_texture_half_float_linear")),Fe();break;default:return}},this.getTextureForTextureUnit=function(v,G){return V[v].get(G)},this.getTextureUnitUnrenderableReason=function(v,G,B,S){const C=V[G].get(B);if(!C)return`no texture bound to texture unit ${G} ${B}`;const J=k.get(C),{mips:Q,parameters:ue}=J,re=ue.get(vt)||0,se=Q[re];if(!se)return`no mip level ${re}`;const Pe=se[0];if(!Pe)return`TEXTURE_CUBE_MAP_POSITIVE_X face at mip level ${re} does not exist`;const Te=Vo(Pe.internalFormat),Ge=bi(v);if(Te!==Ge)return`uniform ${qn(v)} needs a ${Ge} texture but ${S(C)} on texture unit ${G} is ${Te} texture (${ne(J)})`;const we=V[G].get("SAMPLER");if(we){const ut=z.get(we),et=Ue(J,ut);return et&&`${et} with sampler ${S(we)} bound to texture unit ${G}`}else return J.notRenderable};function De(v,G,B,S,C,J,Q=0){const ue=Ft(B,Q),re=be(v),{mips:se}=re;se[G]||(se[G]=[]);const Pe=xr.get(v);se[G][Pe]={width:S,height:C,depth:J,internalFormatString:ue,internalFormat:B,type:Q},Be(re)}this.postChecks={activeTexture(v,G,B){Ee=B[0]-zi,ge=V[Ee]},bindTexture(v,G,B){const[S,C]=B,J=Kn(S);if(ge.get(J)===C)++y.bindTexture;else if(ge.set(J,C),C){const Q=k.get(C);if(Q.type){if(Q.type!==S)throw new Error("should never get here")}else Q.type=S}},createTexture(v,G,B,S){const C={mips:[],parameters:new Map([[ar,$i],[cr,hr],[ur,lr],[fr,lr]]),renderable:!1};k.set(S,C)},deleteTexture(v,G,B){const[S]=B,{type:C}=k.get(S);k.delete(S),Et(C,S)},createSampler(v,G,B,S){z.set(S,new Map)},deleteSampler(v,G,B){const[S]=B;z.delete(S),Et("SAMPLER",S)},bindSampler(v,G,B){const[S,C]=B;C===V[S].get("SAMPLER")?++y.bindSampler:V[S].set("SAMPLER",C)},samplerParameteri(v,G,B){const[S,C,J]=B;z.get(S).set(C,J)},copyTexImage2D(v,G,B){const[S,C,J,Q,ue]=B,re=v.UNSIGNED_BYTE;De(S,C,J,Q,ue,1,re)},texImage2D(v,G,B){const S=Gi.get(B.length),{target:C,level:J,internalFormat:Q,width:ue,height:re,type:se}=S(B);De(C,J,Q,ue,re,1,se)},texImage3D(v,G,B){const[S,C,J,Q,ue,re,,,se]=B;De(S,C,J,Q,ue,re,se)},texStorage2D(v,G,B){const[S,C,J,Q,ue]=B;let re=Q,se=ue;const Pe=S===at?Vi:ki;for(let Te=0;Te<C;++Te){for(const Ge of Pe)De(Ge,Te,J,re,se,1);re=Math.max(1,re/2|0),se=Math.max(1,se/2|0)}},texStorage3D(v,G,B){const[S,C,J,Q,ue,re]=B;let se=Q,Pe=ue,Te=re;for(let Ge=0;Ge<C;++Ge)De(S,Ge,J,se,Pe,Te),se=Math.max(1,se/2|0),Pe=Math.max(1,Pe/2|0),S===ln&&(Te=Math.max(1,Te/2|0))},generateMipmap(v,G,B){const[S]=B,C=be(S),{parameters:J}=C,Q=J.get(vt)||0,ue=kn(J.get(Ar),D),re=rt(S,Q),{width:se,height:Pe,depth:Te,internalFormat:Ge,type:we}=re,ut=Math.min(xn(se,Pe,Te),ue+1-Q),et=S===at?6:1;let Me=se,Ce=Pe,tt=Te;for(let He=0;He<ut;++He){Me=Math.max(1,Me/2|0),Ce=Math.max(1,Ce/2|0),S===ln&&(tt=Math.max(1,tt/2|0));for(let xe=0;xe<et;++xe){const dt=S===at?Ct+xe:S;De(dt,Q+He,Ge,Me,Ce,tt,we)}}},compressedTexImage2D(v,G,B){const[S,C,J,Q,ue]=B;De(S,C,J,Q,ue,1)},compressedTexImage3D(v,G,B){const[S,C,J,Q,ue,re]=B;De(S,C,J,Q,ue,re)},texParameteri(v,G,B){const[S,C,J]=B;Je(S,C,J)}}}}class wr{constructor(b){this.elementAttribArray=null,this.attribs=[];for(let y=0;y<b;++y)this.attribs.push({size:0,type:0,normalize:!1,stride:0,offset:0,divisor:0,buffer:null,iPointer:!1})}setElementArrayBuffer(b,y){ot(this.elementAttribArray,y)?++b.bindBuffer:this.elementAttribArray=it(y)}setAttrib(b,y,F,P,L,k,z,V,D){const Z=this.attribs[F];ot(Z.buffer,D)&&Z.iPointer===y&&Z.size===P&&Z.type===L&&Z.normalize===k&&Z.stride===z&&Z.offset===V?++b.vertexAttribPointer:Object.assign(Z,{iPointer:y,size:P,type:L,normalize:k,stride:z,offset:V,buffer:it(D)})}}class Wo{constructor(b,y){this.gl=b,this.redundantStateSetting=y,this.numAttribs=b.getParameter(b.MAX_VERTEX_ATTRIBS),this.vertexArrays=new WeakMap,this.defaultVertexArray=new wr(this.numAttribs),this.currentVertexArray=this.defaultVertexArray;const F=(k,z,V,D)=>{this.vertexArrays.set(D,new wr(this.numAttribs))},P=(k,z,V)=>{const[D]=V,Z=this.vertexArrays.get(D);this.currentVertexArray===Z&&(this.currentVertexArray=this.defaultVertexArray),this.vertexArrays.delete(D)},L=(k,z,V)=>{let[D]=V;D=D?this.vertexArrays.get(D):this.defaultVertexArray,D===this.currentVertexArray?++this.redundantStateSetting.bindVertexArray:this.currentVertexArray=D};this.postChecks={createVertexArray:F,createVertexArrayOES:F,bindVertexArray:L,bindVertexArrayOES:L,bindBuffer:(k,z,V)=>{const[D,Z]=V;D===b.ELEMENT_ARRAY_BUFFER&&this.currentVertexArray.setElementArrayBuffer(this.redundantStateSetting,Z)},deleteVertexArray:P,deleteVertexArrayOES:P,vertexAttribPointer:(k,z,V)=>{const[D,Z,Ee,ge,Be,Fe]=V,Ue=this.gl;this.currentVertexArray.setAttrib(this.redundantStateSetting,!1,D,Z,Ee,ge,Be,Fe,Ue.getParameter(Ue.ARRAY_BUFFER_BINDING))},vertexAttribIPointer:(k,z,V)=>{const[D,Z,Ee,ge,Be]=V,Fe=this.gl;this.currentVertexArray.setAttrib(this.redundantStateSetting,!0,D,Z,Ee,!1,ge,Be,Fe.getParameter(Fe.ARRAY_BUFFER_BINDING))}}}}const Nr=c(["COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","STENCIL_BUFFER_BIT"]);function Qt(o,b){Array.isArray(o[b])&&(o[b]=Object.fromEntries(o[b].map(y=>[Math.abs(y),y])))}function Yo(o,b,y,F){const P=y[0],L=F.locationsToNamesMap.get(P),k=o.getParameter(o.CURRENT_PROGRAM),z=[];if(L&&z.push(`trying to set uniform '${L}'`),k){const V=F.webglObjectToNamesMap.get(k);V&&z.push(`on WebGLProgram(${s(V)})`)}else z.push("on ** no current program **");return z.length?`: ${z.join(" ")}`:""}function Dr(o){if(Array.isArray(o)||n(o)||typeof o!="object")throw new Error("not a WebGLObject")}function Qo(){return{elementArrayBuffer:null,vertexAttribs:[]}}const bn=new Set,Cr={useProgram:0,bindBuffer:0,bindFramebuffer:0,bindRenderbuffer:0,bindSampler:0,bindTexture:0,bindVertexArray:0,enableDisable:0,vertexAttribPointer:0};function vr(o,b,y={}){if(bn.has(o))return o;bn.add(o);const F=y.origGLErrorFn||o.getError;d(o);function P(A){const h=Qo(),l={...Cr},E={};for(const R in A){const M=A[R];E[R]=typeof M=="function"?function(...U){return M.call(A,...U)}:M}const T={baseContext:A,config:y,apis:{gman_debug_helper:{ctx:{tagObject(R,M){Dr(R),T.webglObjectToNamesMap.set(R,M)},untagObject(R){Dr(R),T.webglObjectToNamesMap.delete(R)},getTagForObject(R){return T.webglObjectToNamesMap.get(R)},disable(){S()},setConfiguration(R){for(const[M,U]of Object.entries(R)){if(!(M in T.config))throw new Error(`unknown configuration option: ${M}`);T.config[M]=U}for(const M of T.config.ignoreUniforms)T.ignoredUniforms.add(M)},getAndResetRedundantCallInfo(){const R={...l};if(Object.assign(l,Cr),this._checksRemoved)for(const M of Object.keys(R))R[M]="invalid is webgl-lint is no longer running. maxDrawCalls exceeded";return R}}}},idCounts:{},textureManager:new Xo(E,l),vertexArrayManager:new Wo(E,l),bufferToIndices:new Map,ignoredUniforms:new Set,locationsToNamesMap:new Map,webglObjectToNamesMap:new Map,programToUnsetUniformsMap:new Map,programToUniformInfoMap:new Map,programToLocationsMap:new Map,programToUniformSamplerValues:new Map,defaultVertexArray:h,webglState:{currentProgram:null,buffers:{},currentReadFramebuffer:null,currentDrawFramebuffer:null,currentRenderbuffer:null,textureUnits:[],enabled:{}},redundantStateSetting:l};return T}const L=y.sharedState||P(o);y.sharedState=L;const{apis:k,baseContext:z,bufferToIndices:V,config:D,ignoredUniforms:Z,locationsToNamesMap:Ee,programToLocationsMap:ge,programToUniformInfoMap:Be,programToUniformSamplerValues:Fe,programToUnsetUniformsMap:Ue,textureManager:be,vertexArrayManager:rt,webglObjectToNamesMap:Je,idCounts:Et,webglState:ne,redundantStateSetting:de}=L;({oes_texture_float(...A){be.addExtension(...A)},oes_texture_float_linear(...A){be.addExtension(...A)},OES_texture_half_float(...A){be.addExtension(...A)},oes_texture_half_float_linear(...A){be.addExtension(...A)}}[b]||J)(b);const De={enable:{1:{enums:[0]}},disable:{1:{enums:[0]}},getParameter:{1:{enums:[0]}},drawArrays:{3:{enums:[0],numbers:[1,2]}},drawElements:{4:{enums:[0,2],numbers:[1,3]}},drawArraysInstanced:{4:{enums:[0],numbers:[1,2,3]}},drawElementsInstanced:{5:{enums:[0,2],numbers:[1,3,4]}},drawRangeElements:{6:{enums:[0,4],numbers:[1,2,3,5]}},createShader:{1:{enums:[0]}},getActiveAttrib:{2:{numbers:[1]}},getActiveUniform:{2:{numbers:[1]}},getShaderParameter:{2:{enums:[1]}},getProgramParameter:{2:{enums:[1]}},getShaderPrecisionFormat:{2:{enums:[0,1]}},bindAttribLocation:{3:{numbers:[1]}},getVertexAttrib:{2:{enums:[1],numbers:[0]}},vertexAttribPointer:{6:{enums:[2],numbers:[0,1,4,5]}},vertexAttribIPointer:{5:{enums:[2],numbers:[0,1,3,4]}},vertexAttribDivisor:{2:{numbers:[0,1]}},disableVertexAttribArray:{1:{numbers:[0]}},enableVertexAttribArray:{1:{numbers:[0]}},bindTexture:{2:{enums:[0],undef:[1]}},activeTexture:{1:{enums:[0,1]}},getTexParameter:{2:{enums:[0,1]}},texParameterf:{3:{enums:[0,1]}},texParameteri:{3:{enums:[0,1,2]}},texImage2D:{9:{enums:[0,2,6,7],numbers:[1,3,4,5],arrays:[-8]},6:{enums:[0,2,3,4]},10:{enums:[0,2,6,7],numbers:[1,3,4,5,9],arrays:{8:ea}}},texImage3D:{10:{enums:[0,2,7,8],numbers:[1,3,4,5]},11:{enums:[0,2,7,8],numbers:[1,3,4,5,10],arrays:{9:pn}}},texSubImage2D:{9:{enums:[0,6,7],numbers:[1,2,3,4,5]},7:{enums:[0,4,5],numbers:[1,2,3]},10:{enums:[0,6,7],numbers:[1,2,3,4,5,9],arrays:{9:pn}}},texSubImage3D:{11:{enums:[0,8,9],numbers:[1,2,3,4,5,6,7]},12:{enums:[0,8,9],numbers:[1,2,3,4,5,6,7,11],arrays:{10:pn}}},texStorage2D:{5:{enums:[0,2],numbers:[1,3,4]}},texStorage3D:{6:{enums:[0,2],numbers:[1,3,4,6]}},copyTexImage2D:{8:{enums:[0,2],numbers:[1,3,4,5,6,7]}},copyTexSubImage2D:{8:{enums:[0],numbers:[1,2,3,4,5,6,7]}},copyTexSubImage3D:{9:{enums:[0],numbers:[1,2,3,4,5,6,7,8]}},generateMipmap:{1:{enums:[0]}},compressedTexImage2D:{7:{enums:[0,2],numbers:[1,3,4,5]},8:{enums:[0,2],numbers:[1,3,4,5,7]},9:{enums:[0,2],numbers:[1,3,4,5,7,8]}},compressedTexSubImage2D:{8:{enums:[0,6],numbers:[1,2,3,4,5]},9:{enums:[0,6],numbers:[1,2,3,4,5,8]},10:{enums:[0,6],numbers:[1,2,3,4,5,8,9]}},compressedTexImage3D:{8:{enums:[0,2],numbers:[1,3,4,5,6]},9:{enums:[0,2],numbers:[1,3,4,5,6,-7,8]},10:{enums:[0,2],numbers:[1,3,4,5,6,8,9]}},compressedTexSubImage3D:{12:{enums:[0,8],numbers:[1,2,3,4,5,6,7,8,10,11]},11:{enums:[0,8],numbers:[1,2,3,4,5,6,7,8,-9,10]},10:{enums:[0,8],numbers:[1,2,3,4,5,6,7,8]}},bindBuffer:{2:{enums:[0],undef:[1]}},bufferData:{3:{enums:[0,2],numbers:[-1],arrays:[-1]},4:{enums:[0,2],numbers:[-1,3],arrays:{1:$r}},5:{enums:[0,2],numbers:[-1,3,4],arrays:{1:Gr}}},bufferSubData:{3:{enums:[0],numbers:[1],arrays:{2:Jo}},4:{enums:[0],numbers:[1,3],arrays:{2:$r}},5:{enums:[0],numbers:[1,3,4],arrays:{2:Gr}}},copyBufferSubData:{5:{enums:[0],numbers:[2,3,4]}},getBufferParameter:{2:{enums:[0,1]}},getBufferSubData:{3:{enums:[0],numbers:[1]},4:{enums:[0],numbers:[1,3]},5:{enums:[0],numbers:[1,3,4]}},pixelStorei:{2:{enums:[0,1],numbers:[1]}},readPixels:{7:{enums:[4,5],numbers:[0,1,2,3,-6]},8:{enums:[4,5],numbers:[0,1,2,3,7]}},bindRenderbuffer:{2:{enums:[0],undef:[1]}},bindFramebuffer:{2:{enums:[0],undef:[1]}},blitFramebuffer:{10:{enums:{8:Nr,9:!0},numbers:[0,1,2,3,4,5,6,7]}},checkFramebufferStatus:{1:{enums:[0]}},framebufferRenderbuffer:{4:{enums:[0,1,2]}},framebufferTexture2D:{5:{enums:[0,1,2],numbers:[4]}},framebufferTextureLayer:{5:{enums:[0,1],numbers:[3,4]}},getFramebufferAttachmentParameter:{3:{enums:[0,1,2]}},getInternalformatParameter:{3:{enums:[0,1,2]}},getRenderbufferParameter:{2:{enums:[0,1]}},invalidateFramebuffer:{2:{enums:{0:!0,1:a}}},invalidateSubFramebuffer:{6:{enums:{0:!0,1:a},numbers:[2,3,4,5]}},readBuffer:{1:{enums:[0]}},renderbufferStorage:{4:{enums:[0,1],numbers:[2,3]}},renderbufferStorageMultisample:{5:{enums:[0,2],numbers:[1,3,4]}},bindVertexBuffer:{1:{undef:[1]}},bindVertexBufferOES:{1:{undef:[1]}},lineWidth:{1:{numbers:[0]}},polygonOffset:{2:{numbers:[0,1]}},scissor:{4:{numbers:[0,1,2,3]}},viewport:{4:{numbers:[0,1,2,3]}},clear:{1:{enums:{0:Nr}}},clearColor:{4:{numbers:[0,1,2,3]}},clearDepth:{1:{numbers:[0]}},clearStencil:{1:{numbers:[0]}},depthFunc:{1:{enums:[0]}},depthRange:{2:{numbers:[0,1]}},blendColor:{4:{numbers:[0,1,2,3]}},blendFunc:{2:{enums:[0,1]}},blendFuncSeparate:{4:{enums:[0,1,2,3]}},blendEquation:{1:{enums:[0]}},blendEquationSeparate:{2:{enums:[0,1]}},stencilFunc:{3:{enums:[0],numbers:[1,2]}},stencilFuncSeparate:{4:{enums:[0,1],numberS:[2,3]}},stencilMask:{1:{numbers:[0]}},stencilMaskSeparate:{2:{enums:[0],numbers:[1]}},stencilOp:{3:{enums:[0,1,2]}},stencilOpSeparate:{4:{enums:[0,1,2,3]}},cullFace:{1:{enums:[0]}},frontFace:{1:{enums:[0]}},drawArraysInstancedANGLE:{4:{enums:[0],numbers:[1,2,3]}},drawElementsInstancedANGLE:{5:{enums:[0,2],numbers:[1,3,4]}},blendEquationEXT:{1:{enums:[0]}},drawBuffersWebGL:{1:{enums:{0:a},arrays:[0]}},drawBuffers:{1:{enums:{0:a},arrays:[0]}},clearBufferfv:{3:{enums:[0],numbers:[1],arrays:[2]},4:{enums:[0],numbers:[1,3],arrays:[2]}},clearBufferiv:{3:{enums:[0],numbers:[1],arrays:[2]},4:{enums:[0],numbers:[1,3],arrays:[2]}},clearBufferuiv:{3:{enums:[0],numbers:[1],arrays:[2]},4:{enums:[0],numbers:[1,3],arrays:[2]}},clearBufferfi:{4:{enums:[0],numbers:[1,2,3]}},uniform1f:{2:{numbers:[1]}},uniform2f:{3:{numbers:[1,2]}},uniform3f:{4:{numbers:[1,2,3]}},uniform4f:{5:{numbers:[1,2,3,4]}},uniform1i:{2:{numbers:[1]}},uniform2i:{3:{numbers:[1,2]}},uniform3i:{4:{numbers:[1,2,3]}},uniform4i:{5:{numbers:[1,2,3,4]}},uniform1fv:{2:{arrays:{1:Re(1)}},3:{arrays:{1:ye(1)},numbers:[2]},4:{arrays:{1:pe(1)},numbers:[2,3]}},uniform2fv:{2:{arrays:{1:Re(2)}},3:{arrays:{1:ye(2)},numbers:[2]},4:{arrays:{1:pe(2)},numbers:[2,3]}},uniform3fv:{2:{arrays:{1:Re(3)}},3:{arrays:{1:ye(3)},numbers:[2]},4:{arrays:{1:pe(3)},numbers:[2,3]}},uniform4fv:{2:{arrays:{1:Re(4)}},3:{arrays:{1:ye(4)},numbers:[2]},4:{arrays:{1:pe(4)},numbers:[2,3]}},uniform1iv:{2:{arrays:{1:Re(1)}},3:{arrays:{1:ye(1)},numbers:[2]},4:{arrays:{1:pe(1)},numbers:[2,3]}},uniform2iv:{2:{arrays:{1:Re(2)}},3:{arrays:{1:ye(2)},numbers:[2]},4:{arrays:{1:pe(2)},numbers:[2,3]}},uniform3iv:{2:{arrays:{1:Re(3)}},3:{arrays:{1:ye(3)},numbers:[2]},4:{arrays:{1:pe(3)},numbers:[2,3]}},uniform4iv:{2:{arrays:{1:Re(4)}},3:{arrays:{1:ye(4)},numbers:[2]},4:{arrays:{1:pe(4)},numbers:[2,3]}},uniformMatrix2fv:{3:{arrays:{2:Re(4)}},4:{arrays:{2:ye(4)},numbers:[3]},5:{arrays:{2:pe(4)},numbers:[3,4]}},uniformMatrix3fv:{3:{arrays:{2:Re(9)}},4:{arrays:{2:ye(9)},numbers:[3]},5:{arrays:{2:pe(9)},numbers:[3,4]}},uniformMatrix4fv:{3:{arrays:{2:Re(16)}},4:{arrays:{2:ye(16)},numbers:[3]},5:{arrays:{2:pe(16)},numbers:[3,4]}},uniform1ui:{2:{numbers:[1]}},uniform2ui:{3:{numbers:[1,2]}},uniform3ui:{4:{numbers:[1,2,3]}},uniform4ui:{5:{numbers:[1,2,3,4]}},uniform1uiv:{2:{arrays:{1:Re(1)}},3:{arrays:{1:ye(1)},numbers:[2]},4:{arrays:{1:pe(1)},numbers:[2,3]}},uniform2uiv:{2:{arrays:{1:Re(2)}},3:{arrays:{1:ye(2)},numbers:[2]},4:{arrays:{1:pe(2)},numbers:[2,3]}},uniform3uiv:{2:{arrays:{1:Re(3)}},3:{arrays:{1:ye(3)},numbers:[2]},4:{arrays:{1:pe(3)},numbers:[2,3]}},uniform4uiv:{2:{arrays:{1:Re(4)}},3:{arrays:{1:ye(4)},numbers:[2]},4:{arrays:{1:pe(4)},numbers:[2,3]}},uniformMatrix3x2fv:{3:{arrays:{2:Re(6)}},4:{arrays:{2:ye(6)},numbers:[3]},5:{arrays:{2:pe(6)},numbers:[3,4]}},uniformMatrix4x2fv:{3:{arrays:{2:Re(8)}},4:{arrays:{2:ye(8)},numbers:[3]},5:{arrays:{2:pe(8)},numbers:[3,4]}},uniformMatrix2x3fv:{3:{arrays:{2:Re(6)}},4:{arrays:{2:ye(6)},numbers:[3]},5:{arrays:{2:pe(6)},numbers:[3,4]}},uniformMatrix4x3fv:{3:{arrays:{2:Re(12)}},4:{arrays:{2:ye(12)},numbers:[3]},5:{arrays:{2:pe(12)},numbers:[3,4]}},uniformMatrix2x4fv:{3:{arrays:{2:Re(8)}},4:{arrays:{2:ye(8)},numbers:[3]},5:{arrays:{2:pe(8)},numbers:[3,4]}},uniformMatrix3x4fv:{3:{arrays:{2:Re(12)}},4:{arrays:{2:ye(12)},numbers:[3]},5:{arrays:{2:pe(12)},numbers:[3,4]}},vertexAttrib1f:{2:{numbers:[0,1]}},vertexAttrib2f:{3:{numbers:[0,1,2]}},vertexAttrib3f:{4:{numbers:[0,1,2,3]}},vertexAttrib4f:{5:{numbers:[0,1,2,3,4]}},vertexAttrib1fv:{2:{numbers:[0],arrays:[1]}},vertexAttrib2fv:{2:{numbers:[0],arrays:[1]}},vertexAttrib3fv:{2:{numbers:[0],arrays:[1]}},vertexAttrib4fv:{2:{numbers:[0],arrays:[1]}},vertexAttribI4i:{5:{numbers:[0,1,2,3,4]}},vertexAttribI4iv:{2:{numbers:[0],arrays:[1]}},vertexAttribI4ui:{5:{numbers:[0,1,2,3,4]}},vertexAttribI4uiv:{2:{numbers:[0],arrays:[1]}},beginQuery:{2:{enums:[0]}},endQuery:{1:{enums:[0]}},getQuery:{2:{enums:[0,1]}},getQueryParameter:{2:{enums:[1]}},samplerParameteri:{3:{enums:[1]}},samplerParameterf:{3:{enums:[1]}},getSamplerParameter:{2:{enums:[1]}},clientWaitSync:{3:{enums:{1:c(["SYNC_FLUSH_COMMANDS_BIT"])},numbers:[2]}},fenceSync:{2:{enums:[0]}},getSyncParameter:{2:{enums:[1]}},bindTransformFeedback:{2:{enums:[0],undef:[1]}},beginTransformFeedback:{1:{enums:[0]}},bindBufferBase:{3:{enums:[0],numbers:[1]}},bindBufferRange:{5:{enums:[0],numbers:[1,3,4]}},getIndexedParameter:{2:{enums:[0],numbers:[1]}},getActiveUniforms:{3:{enums:[2]},arrays:[1]},getActiveUniformBlockParameter:{3:{enums:[2],numbers:[1]}},getActiveUniformBlockName:{2:{numbers:[1]}},transformFeedbackVaryings:{3:{enums:[2]}},uniformBlockBinding:{3:{numbers:[1,2]}}};for(const[A,h]of Object.entries(De)){for(const l of Object.values(h))Qt(l,"enums"),Qt(l,"numbers"),Qt(l,"arrays"),Qt(l,"undef");/uniform(\d|Matrix)/.test(A)&&(h.errorHelper=Yo)}const v={},G={};function B(A){const h=ge.get(A);h&&h.forEach(l=>Ee.delete(l)),ge.set(A,new Set),Ue.delete(A),Be.delete(A),Fe.delete(A)}function S(){for(const{ctx:A,origFuncs:h}of Object.values(k))Object.assign(A,h),bn.delete(A);L.apis.gman_debug_helper._checksRemoved=!0;for(const A of[...Object.keys(L)])delete L[A]}function C(A,h,l){const{vertCount:E,instances:x}=Gn(h,l);E===0&&console.warn(Ht(A,h,l,`count for ${h} is 0!`)),x===0&&console.warn(Ht(A,h,l,`instanceCount for ${h} is 0!`)),--D.maxDrawCalls,D.maxDrawCalls===0&&S()}function J(){}function Q(A){return function(h,l,E,x){if(D.makeDefaultTags){const T=(Et[A]||0)+1;Et[A]=T,Je.set(x,`*UNTAGGED:${A}${T}*`)}}}function ue(A){const h=Li(new Error().stack),l=h?`${h.url}:${h.lineNo}: ${A}`:A;if(D.throwOnError)throw new Error(l);console.error(l)}function re(A,h,l){A?ue(l):h&&console.warn(l)}function se(A){return typeof A=="number"}const Pe=34229;function Te(){const A=z;return typeof WebGL2RenderingContext<"u"&&A instanceof WebGL2RenderingContext||k.oes_vertex_array_object?A.getParameter(Pe):null}function Ge(A,h,l){if(!D.failUnsetUniforms)return;const E=Ue.get(ne.currentProgram);if(E){const x=[];for(const[T,{index:R,unset:M}]of E)M.has(R)&&x.push(T);fe(A,h,l,`uniforms "${x.join('", "')}" have not been set
See docs at https://github.com/greggman/webgl-lint/ for how to turn off this check using "failUnsetUniforms": false`)}}function we(A,h,l){return h>1||l>1?`${A}[${l}]`:A}function ut(A,h,l){if(!D.failUnrenderableTextures)return;const E=Fe.get(ne.currentProgram),x=be.numTextureUnits;for(const{type:T,values:R,name:M}of E){const U=xi(T);for(let N=0;N<R.length;++N){const j=R[N];if(j>=x){fe(A,h,l,`uniform ${gt(T).name} ${we(M,R.length,N)} is set to ${j} which is out of range. There are only ${x} texture units`);return}const ce=be.getTextureUnitUnrenderableReason(T,j,U,Ke);if(ce){const me=be.getTextureForTextureUnit(j,U);fe(A,h,l,me?`texture ${Ke(me)} on texture unit ${j} referenced by uniform ${qn(T)} ${we(M,R.length,N)} is not renderable: ${ce}`:`no texture on texture unit ${j} referenced by uniform ${we(M,R.length,N)}`);return}}}}function et(A,h,l){const E=Fe.get(ne.currentProgram),x=new Map;for(const{type:T,values:R,name:M}of E){const U=R[0],N=x.get(U);if(!N)x.set(U,T);else if(N!==T){fe(A,h,l,`Two textures of different types can't use the same sampler location. uniform ${gt(T).name} ${we(M,R.length,0)} is not ${gt(N).name}`);return}}}function Me(A,h,l){if(!ne.currentProgram){fe(A,h,l,"no current program");return}Ge(A,h,l),ut(A,h,l),et(A,h,l)}function Ce(A,h,l){const[E,x,T,R=0,M=0]=l,U=z.getBufferParameter(E,A.BUFFER_SIZE),N=T instanceof DataView||T instanceof ArrayBuffer,j=M||(N?T.byteLength-R:T.length-R);if(U<x+j){const ce=vn(E),me=z.getParameter(ce);fe(A,h,l,U===0?`buffer ${Ke(me)} has 0 size. You need to call bufferData before calling bufferSubData.`:`buffer ${Ke(me)} buffer is too small for data [bufferSize:${U} dstByteOffset(${x}) + copyLength(${j}) = ${x+j}]`)}}const tt={bufferSubData:Ce,drawArrays:Me,drawElements:Me,drawArraysInstanced:Me,drawElementsInstanced:Me,drawArraysInstancedANGLE:Me,drawElementsInstancedANGLE:Me,drawRangeElements:Me};function He(A,h){if(!A){re(D.failUndefinedUniforms,D.warnUndefinedUniforms,`attempt to set non-existent uniform on ${Ke(ne.currentProgram)}
See docs at https://github.com/greggman/webgl-lint/ for how to turn off this check using "warnUndefinedUniforms: false"`);return}const l=Ue.get(ne.currentProgram);if(!l)return;const E=Ee.get(A),x=l.get(E);if(x){for(let T=0;T<h;++T)x.unset.delete(x.index+T);if(!x.unset.size){for(const[T]of x.altNames)l.delete(T);l.size||Ue.delete(ne.currentProgram)}}}function xe(A){return function(h,l,E){const[x,T,R=0,M=0]=E,U=M||T.length-R;He(x,U/A|0)}}function dt(A){return Z.has(A)}function ft(A){return dt(Ee.get(A))}function qe(A,h){const[l,E]=h;return e(A)&&A.getUniformIndices(l,[E])[0]!==A.INVALID_INDEX}function st(A){return function(h,l,E){const[x,T,R,M=0,U=0]=E,j=(U||R.length-M)/A|0;if(D.failZeroMatrixUniforms&&!ft(x))for(let ce=0;ce<j;++ce){let me=!0;const lt=M+A*ce;for(let Oe=0;Oe<A;++Oe)if(R[lt+Oe]){me=!1;break}if(me){fe(h,l,[x,T,...E],`matrix is all zeros
See docs at https://github.com/greggman/webgl-lint/ for how to turn off this check using "failZeroMatrixUniforms": false`);return}}He(x,j)}}function jo(A){const h=xe(A);return function(l,E,x){h(l,E,x);const[T,R]=x;Or(T,R)}}function je(A,h,l){const[E]=l;He(E,1)}function Ho(A,h,l){je(A,h,l);const[E,x]=l;Or(E,[x])}function Or(A,h){const l=Ee.get(A),E=Be.get(ne.currentProgram),{index:x,type:T,values:R}=E.get(l);if(!Nt(T))return;const M=Math.min(h.length,R.length-x);for(let U=0;U<M;++U)R[U]=h[U]}function nt(A,h,l){const[E]=l;Je.delete(E)}const qo=/ERROR:\s*\d+:(\d+)/gi;function zr(A,h=""){const l=[...h.matchAll(qo)],E=new Map(l.map((x,T)=>{const R=parseInt(x[1]),M=l[T+1],U=M?M.index:h.length,N=h.substring(x.index,U);return[R-1,N]}));return A.split(`
`).map((x,T)=>{const R=E.get(T);return`${T+1}: ${x}${R?`

^^^ ${R}`:""}`}).join(`
`)}const Tn={enable(A,h,l){const[E]=l;ne.enabled[E]?++de.enableDisable:ne.enabled[E]=!0},disable(A,h,l){const[E]=l;ne.enabled[E]?ne.enabled[E]=!1:++de.enableDisable},bindBuffer(A,h,l){const[E,x]=l;switch(E){case A.ELEMENT_ARRAY_BUFFER:break;default:ot(ne.buffers[E],x)?++de.bindBuffer:ne.buffers[E]=it(x)}},bindFramebuffer(A,h,l){const[E,x]=l;switch(E){case A.READ_FRAMEBUFFER:ot(ne.currentReadFramebuffer,x)?++de.bindFramebuffer:ne.currentReadFramebuffer=it(x);break;case A.DRAW_FRAMEBUFFER:ot(ne.currentDrawFramebuffer,x)?++de.bindFramebuffer:ne.currentDrawFramebuffer=it(x);break;case A.FRAMEBUFFER:ot(ne.currentDrawFramebuffer,x)&&ot(ne.currentDrawFramebuffer,x)?++de.bindFramebuffer:(ne.currentDrawFramebuffer=it(x),ne.currentReadFramebuffer=it(x))}},bindRenderbuffer(A,h,l){const[,E]=l;ot(ne.currentRenderbuffer,E)?++de.bindRenderbuffer:ne.currentRenderbuffer=it(E)},bufferData(A,h,l){const[E,x,,T=0,R=0]=l;if(E!==A.ELEMENT_ARRAY_BUFFER)return;const M=z.getParameter(A.ELEMENT_ARRAY_BUFFER_BINDING);if(se(x))V.set(M,new ArrayBuffer(x));else{const U=x instanceof DataView,N=R||(U?x.byteLength-T:x.length-T),j=U?1:x.BYTES_PER_ELEMENT,ce=N*j,me=x.buffer?x.buffer:x,Oe=(x.byteOffset||0)+T*j;V.set(M,me.slice(Oe,Oe+ce))}},bufferSubData(A,h,l){const[E,x,T,R=0,M=0]=l;if(E!==A.ELEMENT_ARRAY_BUFFER)return;const U=z.getParameter(A.ELEMENT_ARRAY_BUFFER_BINDING),N=V.get(U),j=new Uint8Array(N),ce=T instanceof DataView,me=M||(ce?T.byteLength-R:T.length-R),lt=ce?1:T.BYTES_PER_ELEMENT,Oe=me*lt,St=T.buffer?T.buffer:T,Bt=(T.byteOffset||0)+R*lt,mt=new Uint8Array(St,Bt,Oe);j.set(mt,x)},compileShader(A,h,l){if(!D.failBadShadersAndPrograms)return;const[E]=l;if(!z.getShaderParameter(E,A.COMPILE_STATUS)){const T=z.getShaderInfoLog(E),R=zr(z.getShaderSource(E),T),M=z.getShaderParameter(E,A.SHADER_TYPE),U=`failed to compile ${m(M)}: ${T}
------[ shader source ]------
${R}`;fe(A,h,l,U)}},createBuffer:Q("Buffer"),createFramebuffer:Q("Framebuffer"),createProgram:Q("Program"),createQuery:Q("Query"),createRenderbuffer:Q("Renderbuffer"),createShader:Q("Shader"),createTexture:Q("Texture"),createTransformFeedback:Q("TransformFeedback"),createSampler:Q("Sampler"),createVertexArray:Q("VertexArray"),createVertexArrayOES:Q("VertexArray"),drawArrays:C,drawElements:C,drawArraysInstanced:C,drawElementsInstanced:C,drawArraysInstancedANGLE:C,drawElementsInstancedANGLE:C,drawRangeElements:C,fenceSync:Q("Sync"),uniform1f:je,uniform2f:je,uniform3f:je,uniform4f:je,uniform1i:Ho,uniform2i:je,uniform3i:je,uniform4i:je,uniform1fv:xe(1),uniform2fv:xe(2),uniform3fv:xe(3),uniform4fv:xe(4),uniform1iv:jo(1),uniform2iv:xe(2),uniform3iv:xe(3),uniform4iv:xe(4),uniformMatrix2fv:st(4),uniformMatrix3fv:st(9),uniformMatrix4fv:st(16),uniform1ui:je,uniform2ui:je,uniform3ui:je,uniform4ui:je,uniform1uiv:xe(1),uniform2uiv:xe(2),uniform3uiv:xe(3),uniform4uiv:xe(4),uniformMatrix3x2fv:st(6),uniformMatrix4x2fv:st(8),uniformMatrix2x3fv:st(6),uniformMatrix4x3fv:st(12),uniformMatrix2x4fv:st(8),uniformMatrix3x4fv:st(12),getSupportedExtensions(A,h,l,E){E.push("GMAN_debug_helper")},getUniformLocation(A,h,l,E){const[x,T]=l;E?(Ee.set(E,T),ge.get(x).add(E)):!dt(T)&&!qe(A,l)&&na(A,h,l,`uniform '${T}' does not exist in ${Ke(x)}`,D.failUndefinedUniforms,D.warnUndefinedUniforms)},linkProgram(A,h,l){const[E]=l;if(z.getProgramParameter(E,A.LINK_STATUS)){B(E);const T=new Map,R=new Map,M=[],U=z.getProgramParameter(E,A.ACTIVE_UNIFORMS);for(let N=0;N<U;++N){const{name:j,type:ce,size:me}=o.getActiveUniform(E,N);if(t(j)||!z.getUniformLocation(E,j))continue;const Oe=new Map([[j,0]]),St=j.endsWith("[0]");let Rt=j;if(St&&(Rt=j.substr(0,j.length-3),Oe.set(Rt,0)),me>1)for(let ve=0;ve<me;++ve)Oe.set(`${Rt}[${ve}]`,ve);const Bt=(!Nt(ce)||D.failUnsetSamplerUniforms)&&!Z.has(j),mt=Nt(ce)?new Array(me).fill(0):void 0;mt&&M.push({type:ce,values:mt,name:Rt});const Rn=new Set(aa(0,me));for(const[ve,kr]of Oe)Bt&&T.set(ve,{index:kr,unset:Rn,altNames:Oe}),R.set(ve,{index:kr,type:ce,size:me,...mt&&{values:mt}})}Fe.set(E,M),Be.set(E,R),T.size&&Ue.set(E,T)}else if(D.failBadShadersAndPrograms){const R=z.getAttachedShaders(E).map(N=>{const j=zr(z.getShaderSource(N)),ce=z.getShaderParameter(N,A.SHADER_TYPE);return`-------[ ${m(ce)} ${Ke(N)} ]-------
${j}`}).join(`
`),U=`failed to link program: ${z.getProgramInfoLog(E)}
${R}`;fe(A,h,l,U)}},useProgram(A,h,l){const[E]=l;ne.currentProgram===E?++de.useProgram:ne.currentProgram=E},deleteProgram(A,h,l){const[E]=l;ne.currentProgram===E&&(ne.currentProgram=void 0),B(E)},deleteBuffer(A,h,l){const[E]=l;V.delete(E)},deleteFramebuffer:nt,deleteRenderbuffer:nt,deleteTexture:nt,deleteShader:nt,deleteQuery:nt,deleteSampler:nt,deleteSync:nt,deleteTransformFeedback:nt,deleteVertexArray:nt,deleteVertexArrayOES:nt};[be,rt].forEach(A=>{Object.entries(A.postChecks).forEach(([h,l])=>{const E=Tn[h]||J;Tn[h]=function(...x){E(...x),D.failUnrenderableTextures&&l(...x)}})});function Ke(A){const h=Je.get(A)||"*unnamed*";return`${A.constructor.name}(${s(h)})`}function Ko(A){return V.get(A)}function Zo(A,h,l,E,x){const T=Je.get(x);if(T)return`${x.constructor.name}("${T}")`;if(x instanceof WebGLUniformLocation)return`WebGLUniformLocation("${Ee.get(x)}")`;const R=De[h];if(R!==void 0){const M=R[l];if(M!==void 0){const U=M.enums;if(U){const N=U[E];if(N!==void 0){if(typeof N=="function")return N(A,x);if(!h.startsWith("bind")&&E===0){const j=vn(x);if(j){const ce=z.getParameter(j);if(ce)return`${m(x)}{${Ke(ce)}}`}}return m(x)}}}}return x===null?"null":x===void 0?"undefined":Array.isArray(x)||n(x)?x.length<=32?`[${Array.from(x.slice(0,32)).join(", ")}]`:`${x.constructor.name}(${x.length!==void 0?x.length:x.byteLength})`:x.toString()}function It(A,h,l,E,x,T,R){if(!n(E)){fe(A,h,l,`argument ${x} must be a TypedArray`);return}if(!r(E))return;const M=T,U=T+R;for(let N=M;N<U;++N)if(E[N]===void 0){fe(A,h,l,`element ${N} of argument ${x} is undefined`);return}else if(isNaN(E[N])){fe(A,h,l,`element ${N} of argument ${x} is NaN`);return}}function pn(A,h,l,E,x){const T=l[l.length-1],R=E.length-T;It(A,h,l,E,x,T,R)}function Jo(A,h,l,E,x){if(n(E)&&r(E)){const R=E.length-0;It(A,h,l,E,x,0,R)}else Array.isArray(E)&&fe(A,h,l,`argument ${x} is not an ArrayBufferView or ArrayBuffer`)}function $r(A,h,l,E,x){if(n(E)&&r(E)){const T=l[l.length-1],R=E.length-T;It(A,h,l,E,x,T,R)}else Array.isArray(E)&&fe(A,h,l,`argument ${x} is not an ArrayBufferView or ArrayBuffer`)}function Gr(A,h,l,E,x){if(n(E)&&r(E)){const T=l[l.length-2],R=l[l.length-1];It(A,h,l,E,x,T,R)}else Array.isArray(E)&&fe(A,h,l,`argument ${x} is not an ArrayBufferView or ArrayBuffer`)}function ea(A,h,l,E,x){if(Array.isArray(E)||n(E)){const T=l[l.length-1],R=E.length-T;It(A,h,l,E,x,T,R)}}function yn(A,h,l,E,x,T,R,M){const U=l[0];if(!U)return;const N=Be.get(ne.currentProgram);if(!N)return;const j=Ee.get(U),{type:ce,size:me,index:lt}=N.get(j),Oe=gt(ce).size;M!==Oe&&fe(A,h,l,`uniform "${j}" is ${gt(ce).name} which is wrong for ${h}`);const St=me-lt,Bt=Math.min(R/M|0,St)*M,mt=T,Rn=T+Bt;for(let ve=mt;ve<Rn;++ve)if(E[ve]===void 0){fe(A,h,l,`element ${ve} of argument ${x} is undefined`);return}else if(ra(E[ve])){fe(A,h,l,`element ${ve} of argument ${x} is an array. WebGL expects flat arrays`);return}else if(isNaN(E[ve])){fe(A,h,l,`element ${ve} of argument ${x} is NaN`);return}}function pe(A){return function(h,l,E,x,T){const R=E[E.length-2],M=E[E.length-1];yn(h,l,E,x,T,R,M,A)}}function ye(A){return function(h,l,E,x,T){const R=E[E.length-1],M=x.length-R;yn(h,l,E,x,T,R,M,A)}}function Re(A){return function(h,l,E,x,T){const M=x.length;yn(h,l,E,x,T,0,M,A)}}function ta(A,h,l){const E=l.length;return l.map(function(T,R){let M=Zo(A,h,E,R,T);return M.length>200&&(M=M.substring(0,200)+"..."),M}).join(", ")}function Ht(A,h,l,E){const x=z,T=[E],R=De[h];if(R&&R.errorHelper&&T.push(R.errorHelper(A,h,l,L)),h.includes("draw")){const U=x.getParameter(x.CURRENT_PROGRAM);U?T.push(`with ${Ke(U)} as current program`):T.push("no shader program in use!")}if(h.includes("vertexAttrib")||un(h)){const U=Te(),N=Je.get(U),j=`WebGLVertexArrayObject(${s(N||"*unnamed*")})`;T.push(`with ${U?j:"the default vertex array"} bound`)}const M=ta(A,h,l);return`error in ${h}(${M}): ${T.join(`
`)}`}function na(A,h,l,E,x,T){re(x,T,Ht(A,h,l,E))}function fe(A,h,l,E){ue(Ht(A,h,l,E))}const ra=A=>Array.isArray(A)||n(A);function sa(A,h,l){const E=De[h];if(E){const x=E[l.length];if(x){const{numbers:T={},arrays:R={},undef:M={}}=x;for(let U=0;U<l.length;++U){const N=l[U];if(N===void 0&&!M[U]){fe(A,h,l,`argument ${U} is undefined`);return}if(T[U]!==void 0){if(T[U]>=0){if(typeof N!="number"&&!(N instanceof Number)&&N!==!1&&N!==!0||isNaN(N)){fe(A,h,l,`argument ${U} is not a number`);return}}else if(!(N instanceof Object)&&isNaN(N)){fe(A,h,l,`argument ${U} is NaN`);return}}const j=R[U];if(j!==void 0){const ce=Array.isArray(N)||n(N);if(j>=0&&!ce){fe(A,h,l,`argument ${U} is not an array or typedarray`);return}if(ce&&r(N)){if(typeof j=="function")j(A,h,l,N,U);else for(let me=0;me<N.length;++me)if(N[me]===void 0){fe(A,h,l,`element ${me} of argument ${U} is undefined`);return}else if(isNaN(N[me])){fe(A,h,l,`element ${me} of argument ${U} is NaN`);return}}}}}else{fe(A,h,l,`no version of function '${h}' takes ${l.length} arguments`);return}}}const ia={getExtension(A,h){const l=A[h];A[h]=function(...E){const x=E[0].toLowerCase(),T=k[x];if(T)return T.ctx;const R=l.call(A,...E);return R&&vr(R,x,{...y,origGLErrorFn:F}),R}}};function oa(A,h){const l=A[h],E=tt[h]||J,x=Tn[h]||J;A[h]=function(...R){if(E(A,h,R),sa(A,h,R),ne.currentProgram&&un(h)){const j=ci(z,h,R,Ke,Ko);j.length&&fe(A,h,R,j.join(`
`))}const M=l.call(A,...R),U=z,N=F.call(U);if(N!==0){v[N]=!0;const j=[m(N)];un(h)&&ne.currentProgram&&j.push(...Ci(U,Ke)),fe(A,h,R,j.join(`
`))}else x(A,h,R,M);return M};const T=ia[h];T&&T(A,h,F)}function aa(A,h){const l=[];for(let E=A;E<h;++E)l.push(E);return l}for(const A in o)typeof o[A]=="function"&&(G[A]=o[A],oa(o,A));o.getError&&(o.getError=function(){for(const A of Object.keys(v))if(v[A])return v[A]=!1,A;return o.NO_ERROR}),k[b.toLowerCase()]={ctx:o,origFuncs:G}}console.log("webgl-lint running");function Lr(o){const b=o.prototype.getContext;o.prototype.getContext=function(y,...F){const P=b.call(this,y,...F);if(P&&P.bindTexture){vr(P,y,{maxDrawCalls:1e3,throwOnError:!0,failBadShadersAndPrograms:!0,failUnsetUniforms:!0,failUnsetSamplerUniforms:!1,failZeroMatrixUniforms:!0,failUnrenderableTextures:!0,failUndefinedUniforms:!1,warnUndefinedUniforms:!0,makeDefaultTags:!0,ignoreUniforms:[]});const k=P.getExtension("GMAN_debug_helper");document.querySelectorAll("[data-gman-debug-helper]").forEach(z=>{const V=z.dataset.gmanDebugHelper;let D;try{D=JSON.parse(V)}catch(Z){throw Z.message+=`
${V}
failed to parse data-gman-debug-helper as JSON in: ${z.outerHTML}`,Z}D&&k.setConfiguration(D)})}return P}}typeof HTMLCanvasElement<"u"&&Lr(HTMLCanvasElement),typeof OffscreenCanvas<"u"&&Lr(OffscreenCanvas)});class Jr{constructor(){this.setAction=(e,n)=>{const r=this.actions.get(e);r.justPressed=n&&!r.down,r.down=n,this.actions.set(e,r)},this.addKeyAction=(e,n)=>(this.keys.set(e,n),this.actions.get(n)||this.actions.set(n,{down:!1,justPressed:!1}),this),this.addButtonAction=(e,n)=>(this.buttons.set(e,n),this.actions.get(n)||this.actions.set(n,{down:!1,justPressed:!1}),this),this.setKeyFromKeyCode=(e,n)=>{const r=this.keys.get(e);return r?(this.setAction(r,n),!0):!1},this.keys=new Map,this.actions=new Map,this.buttons=new Map,this.addKeyAction("a","left"),this.addKeyAction("d","right"),this.addKeyAction("w","forward"),this.addKeyAction("s","back"),this.addKeyAction("f","flashlight"),this.addButtonAction(5,"flashlight"),this.addKeyAction("shift","sprint"),window.addEventListener("keydown",e=>{this.setKeyFromKeyCode(e.key.toLowerCase(),!0)&&e.preventDefault()}),window.addEventListener("keyup",e=>{this.setKeyFromKeyCode(e.key.toLowerCase(),!1)&&e.preventDefault()}),this.addKeyAction("q","left"),this.addKeyAction("z","forward")}getFromKey(e){return this.actions.get(this.keys.get(e))}getFromAction(e){return this.actions.get(e)}setActionFromButton(e,n){const r=this.buttons.get(e);r&&this.setAction(r,n)}update(){this.actions.forEach(e=>{e.justPressed&&(e.justPressed=!1)})}}const Vr="/assets/heccinded-DGOZxDYC.png",Aa=()=>(ca.useEffect(()=>{document.exitPointerLock(),document.exitFullscreen()},[]),_e.jsxs("div",{className:" relative h-[inherit] w-full",children:[_e.jsx("div",{className:"bg-cover bg-center h-[inherit] w-full",style:{backgroundImage:`url(${Vr})`},onClick:()=>{An("menu")}}),Vr]})),ua={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0,_cartographicRadians:!1};globalThis.mathgl=globalThis.mathgl||{config:{...ua}};const We=globalThis.mathgl.config;function fa(t,{precision:e=We.precision}={}){return t=la(t),"".concat(parseFloat(t.toPrecision(e)))}function Ut(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function es(t,e,n){return ha(t,r=>Math.max(e,Math.min(n,r)))}function ts(t,e,n){const r=We.EPSILON;n&&(We.EPSILON=n);try{if(t===e)return!0;if(Ut(t)&&Ut(e)){if(t.length!==e.length)return!1;for(let s=0;s<t.length;++s)if(!ts(t[s],e[s]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):typeof t=="number"&&typeof e=="number"?Math.abs(t-e)<=We.EPSILON*Math.max(1,Math.abs(t),Math.abs(e)):!1}finally{We.EPSILON=r}}function la(t){return Math.round(t/We.EPSILON)*We.EPSILON}function ma(t){return t.clone?t.clone():new Array(t.length)}function ha(t,e,n){if(Ut(t)){const r=t;n=n||ma(r);for(let s=0;s<n.length&&s<r.length;++s){const i=typeof t=="number"?t:t[s];n[s]=e(i,s,n)}return n}return e(t)}function Ea(t){function e(){var n=Reflect.construct(t,Array.from(arguments));return Object.setPrototypeOf(n,Object.getPrototypeOf(this)),n}return e.prototype=Object.create(t.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t,e}class ns extends Ea(Array){clone(){return new this.constructor().copy(this)}fromArray(e,n=0){for(let r=0;r<this.ELEMENTS;++r)this[r]=e[r+n];return this.check()}toArray(e=[],n=0){for(let r=0;r<this.ELEMENTS;++r)e[n+r]=this[r];return e}toObject(e){return e}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}to(e){return e===this?this:Ut(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(We)}formatString(e){let n="";for(let r=0;r<this.ELEMENTS;++r)n+=(r>0?", ":"")+fa(this[r],e);return"".concat(e.printTypes?this.constructor.name:"","[").concat(n,"]")}equals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(!ts(this[n],e[n]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(this[n]!==e[n])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,n,r){if(r===void 0)return this.lerp(this,e,n);for(let s=0;s<this.ELEMENTS;++s){const i=e[s],a=typeof n=="number"?n:n[s];this[s]=i+r*(a-i)}return this.check()}min(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(e[n],this[n]);return this.check()}max(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.max(e[n],this[n]);return this.check()}clamp(e,n){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e[r]),n[r]);return this.check()}add(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]+=n[r];return this.check()}subtract(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]-=n[r];return this.check()}scale(e){if(typeof e=="number")for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;else for(let n=0;n<this.ELEMENTS&&n<e.length;++n)this[n]*=e[n];return this.check()}multiplyByScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}check(){if(We.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let e=this.length===this.ELEMENTS;for(let n=0;n<this.ELEMENTS;++n)e=e&&Number.isFinite(this[n]);return e}sub(e){return this.subtract(e)}setScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=e;return this.check()}addScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}divideScalar(e){return this.multiplyByScalar(1/e)}clampScalar(e,n){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e),n);return this.check()}get elements(){return this}}function da(t,e){if(t.length!==e)return!1;for(let n=0;n<t.length;++n)if(!Number.isFinite(t[n]))return!1;return!0}function Xe(t){if(!Number.isFinite(t))throw new Error("Invalid number ".concat(JSON.stringify(t)));return t}function _n(t,e,n=""){if(We.debug&&!da(t,e))throw new Error("math.gl: ".concat(n," some fields set to invalid numbers'"));return t}function Xr(t,e){if(!t)throw new Error("math.gl assertion ".concat(e))}class xa extends ns{get x(){return this[0]}set x(e){this[0]=Xe(e)}get y(){return this[1]}set y(e){this[1]=Xe(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let n=0;n<this.ELEMENTS;++n)e+=this[n]*this[n];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let n=0;for(let r=0;r<this.ELEMENTS;++r){const s=this[r]-e[r];n+=s*s}return Xe(n)}dot(e){let n=0;for(let r=0;r<this.ELEMENTS;++r)n+=this[r]*e[r];return Xe(n)}normalize(){const e=this.magnitude();if(e!==0)for(let n=0;n<this.ELEMENTS;++n)this[n]/=e;return this.check()}multiply(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]*=n[r];return this.check()}divide(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]/=n[r];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return Xr(e>=0&&e<this.ELEMENTS,"index is out of range"),Xe(this[e])}setComponent(e,n){return Xr(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=n,this.check()}addVectors(e,n){return this.copy(e).add(n)}subVectors(e,n){return this.copy(e).subtract(n)}multiplyVectors(e,n){return this.copy(e).multiply(n)}addScaledVector(e,n){return this.add(new this.constructor(e).multiplyScalar(n))}}const tn=1e-6;let _t=typeof Float32Array<"u"?Float32Array:Array;function ba(){const t=new _t(2);return _t!=Float32Array&&(t[0]=0,t[1]=0),t}function Ta(t,e,n){const r=e[0],s=e[1];return t[0]=n[0]*r+n[4]*s+n[12],t[1]=n[1]*r+n[5]*s+n[13],t}(function(){const t=ba();return function(e,n,r,s,i,a){let c,u;for(n||(n=2),r||(r=0),s?u=Math.min(s*n+r,e.length):u=e.length,c=r;c<u;c+=n)t[0]=e[c],t[1]=e[c+1],i(t,t,a),e[c]=t[0],e[c+1]=t[1];return e}})();function pa(t,e,n){const r=e[0],s=e[1],i=n[3]*r+n[7]*s||1;return t[0]=(n[0]*r+n[4]*s)/i,t[1]=(n[1]*r+n[5]*s)/i,t}function rs(t,e,n){const r=e[0],s=e[1],i=e[2],a=n[3]*r+n[7]*s+n[11]*i||1;return t[0]=(n[0]*r+n[4]*s+n[8]*i)/a,t[1]=(n[1]*r+n[5]*s+n[9]*i)/a,t[2]=(n[2]*r+n[6]*s+n[10]*i)/a,t}function ya(t,e,n){const r=e[0],s=e[1];return t[0]=n[0]*r+n[2]*s,t[1]=n[1]*r+n[3]*s,t[2]=e[2],t}function Ra(){const t=new _t(3);return _t!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function _a(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function ga(t,e,n){const r=e[0],s=e[1],i=e[2],a=n[0],c=n[1],u=n[2];return t[0]=s*u-i*c,t[1]=i*a-r*u,t[2]=r*c-s*a,t}function ss(t,e,n){const r=e[0],s=e[1],i=e[2];let a=n[3]*r+n[7]*s+n[11]*i+n[15];return a=a||1,t[0]=(n[0]*r+n[4]*s+n[8]*i+n[12])/a,t[1]=(n[1]*r+n[5]*s+n[9]*i+n[13])/a,t[2]=(n[2]*r+n[6]*s+n[10]*i+n[14])/a,t}function Fa(t,e,n){const r=e[0],s=e[1],i=e[2];return t[0]=r*n[0]+s*n[3]+i*n[6],t[1]=r*n[1]+s*n[4]+i*n[7],t[2]=r*n[2]+s*n[5]+i*n[8],t}function Ma(t,e,n){const r=n[0],s=n[1],i=n[2],a=n[3],c=e[0],u=e[1],d=e[2];let m=s*d-i*u,f=i*c-r*d,_=r*u-s*c,I=s*_-i*f,O=i*m-r*_,p=r*f-s*m;const g=a*2;return m*=g,f*=g,_*=g,I*=2,O*=2,p*=2,t[0]=c+m+I,t[1]=u+f+O,t[2]=d+_+p,t}function Ia(t,e,n,r){const s=[],i=[];return s[0]=e[0]-n[0],s[1]=e[1]-n[1],s[2]=e[2]-n[2],i[0]=s[0],i[1]=s[1]*Math.cos(r)-s[2]*Math.sin(r),i[2]=s[1]*Math.sin(r)+s[2]*Math.cos(r),t[0]=i[0]+n[0],t[1]=i[1]+n[1],t[2]=i[2]+n[2],t}function Sa(t,e,n,r){const s=[],i=[];return s[0]=e[0]-n[0],s[1]=e[1]-n[1],s[2]=e[2]-n[2],i[0]=s[2]*Math.sin(r)+s[0]*Math.cos(r),i[1]=s[1],i[2]=s[2]*Math.cos(r)-s[0]*Math.sin(r),t[0]=i[0]+n[0],t[1]=i[1]+n[1],t[2]=i[2]+n[2],t}function Ba(t,e,n,r){const s=[],i=[];return s[0]=e[0]-n[0],s[1]=e[1]-n[1],s[2]=e[2]-n[2],i[0]=s[0]*Math.cos(r)-s[1]*Math.sin(r),i[1]=s[0]*Math.sin(r)+s[1]*Math.cos(r),i[2]=s[2],t[0]=i[0]+n[0],t[1]=i[1]+n[1],t[2]=i[2]+n[2],t}function Ua(t,e){const n=t[0],r=t[1],s=t[2],i=e[0],a=e[1],c=e[2],u=Math.sqrt((n*n+r*r+s*s)*(i*i+a*a+c*c)),d=u&&_a(t,e)/u;return Math.acos(Math.min(Math.max(d,-1),1))}(function(){const t=Ra();return function(e,n,r,s,i,a){let c,u;for(n||(n=3),r||(r=0),s?u=Math.min(s*n+r,e.length):u=e.length,c=r;c<u;c+=n)t[0]=e[c],t[1]=e[c+1],t[2]=e[c+2],i(t,t,a),e[c]=t[0],e[c+1]=t[1],e[c+2]=t[2];return e}})();const gn=[0,0,0];let qt;class Le extends xa{static get ZERO(){return qt||(qt=new Le(0,0,0),Object.freeze(qt)),qt}constructor(e=0,n=0,r=0){super(-0,-0,-0),arguments.length===1&&Ut(e)?this.copy(e):(We.debug&&(Xe(e),Xe(n),Xe(r)),this[0]=e,this[1]=n,this[2]=r)}set(e,n,r){return this[0]=e,this[1]=n,this[2]=r,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return We.debug&&(Xe(e.x),Xe(e.y),Xe(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=Xe(e)}angle(e){return Ua(this,e)}cross(e){return ga(this,this,e),this.check()}rotateX({radians:e,origin:n=gn}){return Ia(this,this,n,e),this.check()}rotateY({radians:e,origin:n=gn}){return Sa(this,this,n,e),this.check()}rotateZ({radians:e,origin:n=gn}){return Ba(this,this,n,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return ss(this,this,e),this.check()}transformAsVector(e){return rs(this,this,e),this.check()}transformByMatrix3(e){return Fa(this,this,e),this.check()}transformByMatrix2(e){return ya(this,this,e),this.check()}transformByQuaternion(e){return Ma(this,this,e),this.check()}}class Pa extends ns{toString(){let e="[";if(We.printRowMajor){e+="row-major:";for(let n=0;n<this.RANK;++n)for(let r=0;r<this.RANK;++r)e+=" ".concat(this[r*this.RANK+n])}else{e+="column-major:";for(let n=0;n<this.ELEMENTS;++n)e+=" ".concat(this[n])}return e+="]",e}getElementIndex(e,n){return n*this.RANK+e}getElement(e,n){return this[n*this.RANK+e]}setElement(e,n,r){return this[n*this.RANK+e]=Xe(r),this}getColumn(e,n=new Array(this.RANK).fill(-0)){const r=e*this.RANK;for(let s=0;s<this.RANK;++s)n[s]=this[r+s];return n}setColumn(e,n){const r=e*this.RANK;for(let s=0;s<this.RANK;++s)this[r+s]=n[s];return this}}function wa(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Na(t,e){if(t===e){const n=e[1],r=e[2],s=e[3],i=e[6],a=e[7],c=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=i,t[11]=e[14],t[12]=s,t[13]=a,t[14]=c}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function Da(t,e){const n=e[0],r=e[1],s=e[2],i=e[3],a=e[4],c=e[5],u=e[6],d=e[7],m=e[8],f=e[9],_=e[10],I=e[11],O=e[12],p=e[13],g=e[14],X=e[15],ee=n*c-r*a,w=n*u-s*a,$=n*d-i*a,W=r*u-s*c,Y=r*d-i*c,le=s*d-i*u,Ae=m*p-f*O,H=m*g-_*O,q=m*X-I*O,ie=f*g-_*p,oe=f*X-I*p,ae=_*X-I*g;let K=ee*ae-w*oe+$*ie+W*q-Y*H+le*Ae;return K?(K=1/K,t[0]=(c*ae-u*oe+d*ie)*K,t[1]=(s*oe-r*ae-i*ie)*K,t[2]=(p*le-g*Y+X*W)*K,t[3]=(_*Y-f*le-I*W)*K,t[4]=(u*q-a*ae-d*H)*K,t[5]=(n*ae-s*q+i*H)*K,t[6]=(g*$-O*le-X*w)*K,t[7]=(m*le-_*$+I*w)*K,t[8]=(a*oe-c*q+d*Ae)*K,t[9]=(r*q-n*oe-i*Ae)*K,t[10]=(O*Y-p*$+X*ee)*K,t[11]=(f*$-m*Y-I*ee)*K,t[12]=(c*H-a*ie-u*Ae)*K,t[13]=(n*ie-r*H+s*Ae)*K,t[14]=(p*w-O*W-g*ee)*K,t[15]=(m*W-f*w+_*ee)*K,t):null}function Ca(t){const e=t[0],n=t[1],r=t[2],s=t[3],i=t[4],a=t[5],c=t[6],u=t[7],d=t[8],m=t[9],f=t[10],_=t[11],I=t[12],O=t[13],p=t[14],g=t[15],X=e*a-n*i,ee=e*c-r*i,w=n*c-r*a,$=d*O-m*I,W=d*p-f*I,Y=m*p-f*O,le=e*Y-n*W+r*$,Ae=i*Y-a*W+c*$,H=d*w-m*ee+f*X,q=I*w-O*ee+p*X;return u*le-s*Ae+g*H-_*q}function Wr(t,e,n){const r=e[0],s=e[1],i=e[2],a=e[3],c=e[4],u=e[5],d=e[6],m=e[7],f=e[8],_=e[9],I=e[10],O=e[11],p=e[12],g=e[13],X=e[14],ee=e[15];let w=n[0],$=n[1],W=n[2],Y=n[3];return t[0]=w*r+$*c+W*f+Y*p,t[1]=w*s+$*u+W*_+Y*g,t[2]=w*i+$*d+W*I+Y*X,t[3]=w*a+$*m+W*O+Y*ee,w=n[4],$=n[5],W=n[6],Y=n[7],t[4]=w*r+$*c+W*f+Y*p,t[5]=w*s+$*u+W*_+Y*g,t[6]=w*i+$*d+W*I+Y*X,t[7]=w*a+$*m+W*O+Y*ee,w=n[8],$=n[9],W=n[10],Y=n[11],t[8]=w*r+$*c+W*f+Y*p,t[9]=w*s+$*u+W*_+Y*g,t[10]=w*i+$*d+W*I+Y*X,t[11]=w*a+$*m+W*O+Y*ee,w=n[12],$=n[13],W=n[14],Y=n[15],t[12]=w*r+$*c+W*f+Y*p,t[13]=w*s+$*u+W*_+Y*g,t[14]=w*i+$*d+W*I+Y*X,t[15]=w*a+$*m+W*O+Y*ee,t}function va(t,e,n){const r=n[0],s=n[1],i=n[2];let a,c,u,d,m,f,_,I,O,p,g,X;return e===t?(t[12]=e[0]*r+e[4]*s+e[8]*i+e[12],t[13]=e[1]*r+e[5]*s+e[9]*i+e[13],t[14]=e[2]*r+e[6]*s+e[10]*i+e[14],t[15]=e[3]*r+e[7]*s+e[11]*i+e[15]):(a=e[0],c=e[1],u=e[2],d=e[3],m=e[4],f=e[5],_=e[6],I=e[7],O=e[8],p=e[9],g=e[10],X=e[11],t[0]=a,t[1]=c,t[2]=u,t[3]=d,t[4]=m,t[5]=f,t[6]=_,t[7]=I,t[8]=O,t[9]=p,t[10]=g,t[11]=X,t[12]=a*r+m*s+O*i+e[12],t[13]=c*r+f*s+p*i+e[13],t[14]=u*r+_*s+g*i+e[14],t[15]=d*r+I*s+X*i+e[15]),t}function La(t,e,n){const r=n[0],s=n[1],i=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*s,t[5]=e[5]*s,t[6]=e[6]*s,t[7]=e[7]*s,t[8]=e[8]*i,t[9]=e[9]*i,t[10]=e[10]*i,t[11]=e[11]*i,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Oa(t,e,n,r){let s=r[0],i=r[1],a=r[2],c=Math.sqrt(s*s+i*i+a*a),u,d,m,f,_,I,O,p,g,X,ee,w,$,W,Y,le,Ae,H,q,ie,oe,ae,K,he;return c<tn?null:(c=1/c,s*=c,i*=c,a*=c,d=Math.sin(n),u=Math.cos(n),m=1-u,f=e[0],_=e[1],I=e[2],O=e[3],p=e[4],g=e[5],X=e[6],ee=e[7],w=e[8],$=e[9],W=e[10],Y=e[11],le=s*s*m+u,Ae=i*s*m+a*d,H=a*s*m-i*d,q=s*i*m-a*d,ie=i*i*m+u,oe=a*i*m+s*d,ae=s*a*m+i*d,K=i*a*m-s*d,he=a*a*m+u,t[0]=f*le+p*Ae+w*H,t[1]=_*le+g*Ae+$*H,t[2]=I*le+X*Ae+W*H,t[3]=O*le+ee*Ae+Y*H,t[4]=f*q+p*ie+w*oe,t[5]=_*q+g*ie+$*oe,t[6]=I*q+X*ie+W*oe,t[7]=O*q+ee*ie+Y*oe,t[8]=f*ae+p*K+w*he,t[9]=_*ae+g*K+$*he,t[10]=I*ae+X*K+W*he,t[11]=O*ae+ee*K+Y*he,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function za(t,e,n){const r=Math.sin(n),s=Math.cos(n),i=e[4],a=e[5],c=e[6],u=e[7],d=e[8],m=e[9],f=e[10],_=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=i*s+d*r,t[5]=a*s+m*r,t[6]=c*s+f*r,t[7]=u*s+_*r,t[8]=d*s-i*r,t[9]=m*s-a*r,t[10]=f*s-c*r,t[11]=_*s-u*r,t}function $a(t,e,n){const r=Math.sin(n),s=Math.cos(n),i=e[0],a=e[1],c=e[2],u=e[3],d=e[8],m=e[9],f=e[10],_=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=i*s-d*r,t[1]=a*s-m*r,t[2]=c*s-f*r,t[3]=u*s-_*r,t[8]=i*r+d*s,t[9]=a*r+m*s,t[10]=c*r+f*s,t[11]=u*r+_*s,t}function Ga(t,e,n){const r=Math.sin(n),s=Math.cos(n),i=e[0],a=e[1],c=e[2],u=e[3],d=e[4],m=e[5],f=e[6],_=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=i*s+d*r,t[1]=a*s+m*r,t[2]=c*s+f*r,t[3]=u*s+_*r,t[4]=d*s-i*r,t[5]=m*s-a*r,t[6]=f*s-c*r,t[7]=_*s-u*r,t}function ka(t,e){const n=e[0],r=e[1],s=e[2],i=e[3],a=n+n,c=r+r,u=s+s,d=n*a,m=r*a,f=r*c,_=s*a,I=s*c,O=s*u,p=i*a,g=i*c,X=i*u;return t[0]=1-f-O,t[1]=m+X,t[2]=_-g,t[3]=0,t[4]=m-X,t[5]=1-d-O,t[6]=I+p,t[7]=0,t[8]=_+g,t[9]=I-p,t[10]=1-d-f,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Va(t,e,n,r,s,i,a){const c=1/(n-e),u=1/(s-r),d=1/(i-a);return t[0]=i*2*c,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i*2*u,t[6]=0,t[7]=0,t[8]=(n+e)*c,t[9]=(s+r)*u,t[10]=(a+i)*d,t[11]=-1,t[12]=0,t[13]=0,t[14]=a*i*2*d,t[15]=0,t}function Xa(t,e,n,r,s){const i=1/Math.tan(e/2);if(t[0]=i/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,s!=null&&s!==1/0){const a=1/(r-s);t[10]=(s+r)*a,t[14]=2*s*r*a}else t[10]=-1,t[14]=-2*r;return t}const Wa=Xa;function Ya(t,e,n,r,s,i,a){const c=1/(e-n),u=1/(r-s),d=1/(i-a);return t[0]=-2*c,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*d,t[11]=0,t[12]=(e+n)*c,t[13]=(s+r)*u,t[14]=(a+i)*d,t[15]=1,t}const Qa=Ya;function ja(t,e,n,r){let s,i,a,c,u,d,m,f,_,I;const O=e[0],p=e[1],g=e[2],X=r[0],ee=r[1],w=r[2],$=n[0],W=n[1],Y=n[2];return Math.abs(O-$)<tn&&Math.abs(p-W)<tn&&Math.abs(g-Y)<tn?wa(t):(f=O-$,_=p-W,I=g-Y,s=1/Math.sqrt(f*f+_*_+I*I),f*=s,_*=s,I*=s,i=ee*I-w*_,a=w*f-X*I,c=X*_-ee*f,s=Math.sqrt(i*i+a*a+c*c),s?(s=1/s,i*=s,a*=s,c*=s):(i=0,a=0,c=0),u=_*c-I*a,d=I*i-f*c,m=f*a-_*i,s=Math.sqrt(u*u+d*d+m*m),s?(s=1/s,u*=s,d*=s,m*=s):(u=0,d=0,m=0),t[0]=i,t[1]=u,t[2]=f,t[3]=0,t[4]=a,t[5]=d,t[6]=_,t[7]=0,t[8]=c,t[9]=m,t[10]=I,t[11]=0,t[12]=-(i*O+a*p+c*g),t[13]=-(u*O+d*p+m*g),t[14]=-(f*O+_*p+I*g),t[15]=1,t)}function Ha(){const t=new _t(4);return _t!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function qa(t,e,n){const r=e[0],s=e[1],i=e[2],a=e[3];return t[0]=n[0]*r+n[4]*s+n[8]*i+n[12]*a,t[1]=n[1]*r+n[5]*s+n[9]*i+n[13]*a,t[2]=n[2]*r+n[6]*s+n[10]*i+n[14]*a,t[3]=n[3]*r+n[7]*s+n[11]*i+n[15]*a,t}(function(){const t=Ha();return function(e,n,r,s,i,a){let c,u;for(n||(n=4),r||(r=0),s?u=Math.min(s*n+r,e.length):u=e.length,c=r;c<u;c+=n)t[0]=e[c],t[1]=e[c+1],t[2]=e[c+2],t[3]=e[c+3],i(t,t,a),e[c]=t[0],e[c+1]=t[1],e[c+2]=t[2],e[c+3]=t[3];return e}})();var In;(function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL0ROW3=3]="COL0ROW3",t[t.COL1ROW0=4]="COL1ROW0",t[t.COL1ROW1=5]="COL1ROW1",t[t.COL1ROW2=6]="COL1ROW2",t[t.COL1ROW3=7]="COL1ROW3",t[t.COL2ROW0=8]="COL2ROW0",t[t.COL2ROW1=9]="COL2ROW1",t[t.COL2ROW2=10]="COL2ROW2",t[t.COL2ROW3=11]="COL2ROW3",t[t.COL3ROW0=12]="COL3ROW0",t[t.COL3ROW1=13]="COL3ROW1",t[t.COL3ROW2=14]="COL3ROW2",t[t.COL3ROW3=15]="COL3ROW3"})(In||(In={}));const Ka=45*Math.PI/180,Za=1,Fn=.1,Mn=500,Ja=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class Ze extends Pa{static get IDENTITY(){return tc()}static get ZERO(){return ec()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return In}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,n,r,s,i,a,c,u,d,m,f,_,I,O,p,g){return this[0]=e,this[1]=n,this[2]=r,this[3]=s,this[4]=i,this[5]=a,this[6]=c,this[7]=u,this[8]=d,this[9]=m,this[10]=f,this[11]=_,this[12]=I,this[13]=O,this[14]=p,this[15]=g,this.check()}setRowMajor(e,n,r,s,i,a,c,u,d,m,f,_,I,O,p,g){return this[0]=e,this[1]=i,this[2]=d,this[3]=I,this[4]=n,this[5]=a,this[6]=m,this[7]=O,this[8]=r,this[9]=c,this[10]=f,this[11]=p,this[12]=s,this[13]=u,this[14]=_,this[15]=g,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(Ja)}fromObject(e){return this.check()}fromQuaternion(e){return ka(this,e),this.check()}frustum(e){const{left:n,right:r,bottom:s,top:i,near:a=Fn,far:c=Mn}=e;return c===1/0?nc(this,n,r,s,i,a):Va(this,n,r,s,i,a,c),this.check()}lookAt(e){const{eye:n,center:r=[0,0,0],up:s=[0,1,0]}=e;return ja(this,n,r,s),this.check()}ortho(e){const{left:n,right:r,bottom:s,top:i,near:a=Fn,far:c=Mn}=e;return Qa(this,n,r,s,i,a,c),this.check()}orthographic(e){const{fovy:n=Ka,aspect:r=Za,focalDistance:s=1,near:i=Fn,far:a=Mn}=e;Yr(n);const c=n/2,u=s*Math.tan(c),d=u*r;return this.ortho({left:-d,right:d,bottom:-u,top:u,near:i,far:a})}perspective(e){const{fovy:n=45*Math.PI/180,aspect:r=1,near:s=.1,far:i=500}=e;return Yr(n),Wa(this,n,r,s,i),this.check()}determinant(){return Ca(this)}getScale(e=[-0,-0,-0]){return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(e=[-0,-0,-0]){return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const r=this.getScale(n),s=1/r[0],i=1/r[1],a=1/r[2];return e[0]=this[0]*s,e[1]=this[1]*i,e[2]=this[2]*a,e[3]=0,e[4]=this[4]*s,e[5]=this[5]*i,e[6]=this[6]*a,e[7]=0,e[8]=this[8]*s,e[9]=this[9]*i,e[10]=this[10]*a,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const r=this.getScale(n),s=1/r[0],i=1/r[1],a=1/r[2];return e[0]=this[0]*s,e[1]=this[1]*i,e[2]=this[2]*a,e[3]=this[4]*s,e[4]=this[5]*i,e[5]=this[6]*a,e[6]=this[8]*s,e[7]=this[9]*i,e[8]=this[10]*a,e}transpose(){return Na(this,this),this.check()}invert(){return Da(this,this),this.check()}multiplyLeft(e){return Wr(this,e,this),this.check()}multiplyRight(e){return Wr(this,this,e),this.check()}rotateX(e){return za(this,this,e),this.check()}rotateY(e){return $a(this,this,e),this.check()}rotateZ(e){return Ga(this,this,e),this.check()}rotateXYZ(e){return this.rotateX(e[0]).rotateY(e[1]).rotateZ(e[2])}rotateAxis(e,n){return Oa(this,this,e,n),this.check()}scale(e){return La(this,this,Array.isArray(e)?e:[e,e,e]),this.check()}translate(e){return va(this,this,e),this.check()}transform(e,n){return e.length===4?(n=qa(n||[-0,-0,-0,-0],e,this),_n(n,4),n):this.transformAsPoint(e,n)}transformAsPoint(e,n){const{length:r}=e;let s;switch(r){case 2:s=Ta(n||[-0,-0],e,this);break;case 3:s=ss(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return _n(s,e.length),s}transformAsVector(e,n){let r;switch(e.length){case 2:r=pa(n||[-0,-0],e,this);break;case 3:r=rs(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return _n(r,e.length),r}transformPoint(e,n){return this.transformAsPoint(e,n)}transformVector(e,n){return this.transformAsPoint(e,n)}transformDirection(e,n){return this.transformAsVector(e,n)}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,n,r){return this.identity().translate([e,n,r])}}let Kt,Zt;function ec(){return Kt||(Kt=new Ze([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(Kt)),Kt}function tc(){return Zt||(Zt=new Ze,Object.freeze(Zt)),Zt}function Yr(t){if(t>Math.PI*2)throw Error("expected radians")}function nc(t,e,n,r,s,i){const a=2*i/(n-e),c=2*i/(s-r),u=(n+e)/(n-e),d=(s+r)/(s-r),m=-1,f=-1,_=-2*i;return t[0]=a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=u,t[9]=d,t[10]=m,t[11]=f,t[12]=0,t[13]=0,t[14]=_,t[15]=0,t}const Qr=t=>{const e=t.clientWidth,n=t.clientHeight;return t.width!==e||t.height!==n?(t.width=e,t.height=n,!0):!1},jr=(t,e,n)=>{const r=t.createShader(t.VERTEX_SHADER);if(!r)throw new Error("Vertex shader could not be created.");if(t.shaderSource(r,e),t.compileShader(r),!t.getShaderParameter(r,t.COMPILE_STATUS))throw new Error("Vertex shader could not be compiled."+t.getShaderInfoLog(r));const s=t.createShader(t.FRAGMENT_SHADER);if(!s)throw new Error("Fragment shader could not be created.");if(t.shaderSource(s,n),t.compileShader(s),!t.getShaderParameter(s,t.COMPILE_STATUS))throw new Error("Fragment shader could not be compiled."+t.getShaderInfoLog(s));const i=t.createProgram();if(t.attachShader(i,r),t.attachShader(i,s),t.linkProgram(i),!t.getProgramParameter(i,t.LINK_STATUS))throw new Error("Shader program could not be linked.");return i},rc=`#version 300 es\r
precision highp float;\r
\r
layout(location=0) in vec3 aPosition;\r
layout(location=1) in vec3 aNormal;\r
uniform mat4 uModelView;\r
uniform mat4 uProjection;\r
\r
out vec3 v_position;\r
out vec3 v_normal;\r
\r
void main() {\r
    // multiply the vertex position by the matrix to get the final \r
    // point in normalized screen coordinates\r
    gl_Position = uProjection * uModelView *  vec4(aPosition,1.0);\r
    v_position = aPosition;\r
    v_normal = aNormal;\r
    \r
}\r
`,sc=`#version 300 es\r
precision highp float;\r
\r
in vec3 v_position;\r
in vec3 v_normal;\r
\r
uniform vec3 u_lightDirection;\r
uniform vec3 lightPosition;\r
uniform float u_limit;          // in dot space\r
\r
uniform sampler2D uTexture;\r
uniform sampler2D uFloor;\r
uniform sampler2D uCeiling;\r
uniform bool uFlashlight;\r
\r
out vec4 fColor;\r
\r
void main() {\r
  vec3 normal = normalize(v_normal);\r
 \r
  vec3 surfaceToLightDirection = normalize(-lightPosition - v_position);\r
  float light = 0.0;\r
 \r
  float distance = length(-lightPosition - v_position)*2.;\r
  float dotFromDirection = dot(surfaceToLightDirection,-u_lightDirection);\r
  if (uFlashlight && dotFromDirection >= u_limit) {\r
    light = pow(dot(normal, surfaceToLightDirection),.5);\r
  }\r
  light = max(light,0.01);\r
  vec2 uv = v_position.xy;\r
  if(abs(normal.y)<0.01){\r
      if(normal.x!=0.)\r
          uv.x = v_position.z;\r
        uv.x += .5;\r
        uv.y += .25;\r
      fColor  = texture(uTexture,uv);\r
      if(abs(.5-uv.y)>0.44)\r
        fColor.rgb *= 0.4;\r
  } else{\r
    if(v_normal.y>0.)\r
        fColor = texture(uFloor,v_position.xz);\r
    if(v_normal.y<0.)\r
        fColor = texture(uCeiling,v_position.zx);\r
        }\r
    fColor.rgb *= min(light/distance,1.);\r
   \r
}`,ic=`#version 300 es\r
precision highp float;\r
\r
layout(location=0) in vec3 aPosition;\r
uniform mat4 uModelView;\r
uniform mat4 uProjection;\r
uniform mat4 uPosition;\r
uniform mat4 uRotation;\r
\r
out vec3 v_position;\r
out vec3 rPosition;\r
\r
void main() {\r
    gl_Position = uProjection * uModelView * uPosition * uRotation * vec4(aPosition,1.0);\r
    v_position = aPosition;\r
    rPosition =  (uPosition * uRotation * vec4(aPosition,1.0)).xyz;\r
}\r
`,oc=`#version 300 es\r
precision highp float;\r
\r
in vec3 v_position;\r
in vec3 rPosition;\r
\r
uniform samplerCube uTexture;\r
uniform vec3 lightPosition;\r
uniform vec3 u_lightDirection;\r
uniform float u_limit;          // in dot space\r
uniform bool uFlashlight;\r
\r
out vec4 fColor;\r
\r
void main() {\r
    vec2 uv = vec2(0);\r
    vec3 position = normalize(v_position);\r
    // Convert normalized XYZ to spherical coordinates\r
    float theta = acos(position.z);\r
    float phi = atan(position.y, position.x);\r
\r
        // Map spherical coordinates to UV coordinates\r
    uv.x = (phi+ 3.14159) / (2.0 * 3.14159); // Normalize phi to range [0, 1]\r
    uv.y = theta / 3.14159;        // Normalize theta to range [0, 1]\r
    fColor = texture(uTexture,position);\r
\r
    vec3 surfaceToLightDirection = normalize(-lightPosition - rPosition);\r
    float dotFromDirection = dot(surfaceToLightDirection,-u_lightDirection);\r
    if (uFlashlight && dotFromDirection >= u_limit) {\r
        fColor.w = 0.;\r
    }\r
}`;/* @license twgl.js 5.5.4 Copyright (c) 2015, Gregg Tavares All Rights Reserved.
Available via the MIT license.
see: http://github.com/greggman/twgl.js for details */const Hr=new Map;function ac(t,e){if(!t||typeof t!="object")return!1;let n=Hr.get(e);n||(n=new WeakMap,Hr.set(e,n));let r=n.get(t);if(r===void 0){const s=Object.prototype.toString.call(t);r=s.substring(8,s.length-1)===e,n.set(t,r)}return r}function is(t,e){return typeof WebGLTexture<"u"&&ac(e,"WebGLTexture")}function os(t){return!!t.texStorage2D}const rn=33984,cc=35718,Ac=5126,uc=35664,fc=35665,lc=35666,mc=5124,hc=35667,Ec=35668,dc=35669,xc=35670,bc=35671,Tc=35672,pc=35673,yc=35674,Rc=35675,_c=35676,gc=35678,Fc=35680,Mc=35679,Ic=35682,Sc=35685,Bc=35686,Uc=35687,Pc=35688,wc=35689,Nc=35690,Dc=36289,Cc=36292,vc=36293,Lc=5125,Oc=36294,zc=36295,$c=36296,Gc=36298,kc=36299,Vc=36300,Xc=36303,Wc=36306,Yc=36307,Qc=36308,jc=36311,on=3553,an=34067,Bn=32879,cn=35866,te={};function as(t,e){return te[e].bindPoint}function Hc(t,e){return function(n){t.uniform1f(e,n)}}function qc(t,e){return function(n){t.uniform1fv(e,n)}}function Kc(t,e){return function(n){t.uniform2fv(e,n)}}function Zc(t,e){return function(n){t.uniform3fv(e,n)}}function Jc(t,e){return function(n){t.uniform4fv(e,n)}}function cs(t,e){return function(n){t.uniform1i(e,n)}}function As(t,e){return function(n){t.uniform1iv(e,n)}}function us(t,e){return function(n){t.uniform2iv(e,n)}}function fs(t,e){return function(n){t.uniform3iv(e,n)}}function ls(t,e){return function(n){t.uniform4iv(e,n)}}function eA(t,e){return function(n){t.uniform1ui(e,n)}}function tA(t,e){return function(n){t.uniform1uiv(e,n)}}function nA(t,e){return function(n){t.uniform2uiv(e,n)}}function rA(t,e){return function(n){t.uniform3uiv(e,n)}}function sA(t,e){return function(n){t.uniform4uiv(e,n)}}function iA(t,e){return function(n){t.uniformMatrix2fv(e,!1,n)}}function oA(t,e){return function(n){t.uniformMatrix3fv(e,!1,n)}}function aA(t,e){return function(n){t.uniformMatrix4fv(e,!1,n)}}function cA(t,e){return function(n){t.uniformMatrix2x3fv(e,!1,n)}}function AA(t,e){return function(n){t.uniformMatrix3x2fv(e,!1,n)}}function uA(t,e){return function(n){t.uniformMatrix2x4fv(e,!1,n)}}function fA(t,e){return function(n){t.uniformMatrix4x2fv(e,!1,n)}}function lA(t,e){return function(n){t.uniformMatrix3x4fv(e,!1,n)}}function mA(t,e){return function(n){t.uniformMatrix4x3fv(e,!1,n)}}function ze(t,e,n,r){const s=as(t,e);return os(t)?function(i){let a,c;!i||is(t,i)?(a=i,c=null):(a=i.texture,c=i.sampler),t.uniform1i(r,n),t.activeTexture(rn+n),t.bindTexture(s,a),t.bindSampler(n,c)}:function(i){t.uniform1i(r,n),t.activeTexture(rn+n),t.bindTexture(s,i)}}function $e(t,e,n,r,s){const i=as(t,e),a=new Int32Array(s);for(let c=0;c<s;++c)a[c]=n+c;return os(t)?function(c){t.uniform1iv(r,a),c.forEach(function(u,d){t.activeTexture(rn+a[d]);let m,f;!u||is(t,u)?(m=u,f=null):(m=u.texture,f=u.sampler),t.bindSampler(n,f),t.bindTexture(i,m)})}:function(c){t.uniform1iv(r,a),c.forEach(function(u,d){t.activeTexture(rn+a[d]),t.bindTexture(i,u)})}}te[Ac]={Type:Float32Array,size:4,setter:Hc,arraySetter:qc};te[uc]={Type:Float32Array,size:8,setter:Kc,cols:2};te[fc]={Type:Float32Array,size:12,setter:Zc,cols:3};te[lc]={Type:Float32Array,size:16,setter:Jc,cols:4};te[mc]={Type:Int32Array,size:4,setter:cs,arraySetter:As};te[hc]={Type:Int32Array,size:8,setter:us,cols:2};te[Ec]={Type:Int32Array,size:12,setter:fs,cols:3};te[dc]={Type:Int32Array,size:16,setter:ls,cols:4};te[Lc]={Type:Uint32Array,size:4,setter:eA,arraySetter:tA};te[Oc]={Type:Uint32Array,size:8,setter:nA,cols:2};te[zc]={Type:Uint32Array,size:12,setter:rA,cols:3};te[$c]={Type:Uint32Array,size:16,setter:sA,cols:4};te[xc]={Type:Uint32Array,size:4,setter:cs,arraySetter:As};te[bc]={Type:Uint32Array,size:8,setter:us,cols:2};te[Tc]={Type:Uint32Array,size:12,setter:fs,cols:3};te[pc]={Type:Uint32Array,size:16,setter:ls,cols:4};te[yc]={Type:Float32Array,size:32,setter:iA,rows:2,cols:2};te[Rc]={Type:Float32Array,size:48,setter:oA,rows:3,cols:3};te[_c]={Type:Float32Array,size:64,setter:aA,rows:4,cols:4};te[Sc]={Type:Float32Array,size:32,setter:cA,rows:2,cols:3};te[Bc]={Type:Float32Array,size:32,setter:uA,rows:2,cols:4};te[Uc]={Type:Float32Array,size:48,setter:AA,rows:3,cols:2};te[Pc]={Type:Float32Array,size:48,setter:lA,rows:3,cols:4};te[wc]={Type:Float32Array,size:64,setter:fA,rows:4,cols:2};te[Nc]={Type:Float32Array,size:64,setter:mA,rows:4,cols:3};te[gc]={Type:null,size:0,setter:ze,arraySetter:$e,bindPoint:on};te[Fc]={Type:null,size:0,setter:ze,arraySetter:$e,bindPoint:an};te[Mc]={Type:null,size:0,setter:ze,arraySetter:$e,bindPoint:Bn};te[Ic]={Type:null,size:0,setter:ze,arraySetter:$e,bindPoint:on};te[Dc]={Type:null,size:0,setter:ze,arraySetter:$e,bindPoint:cn};te[Cc]={Type:null,size:0,setter:ze,arraySetter:$e,bindPoint:cn};te[vc]={Type:null,size:0,setter:ze,arraySetter:$e,bindPoint:an};te[Gc]={Type:null,size:0,setter:ze,arraySetter:$e,bindPoint:on};te[kc]={Type:null,size:0,setter:ze,arraySetter:$e,bindPoint:Bn};te[Vc]={Type:null,size:0,setter:ze,arraySetter:$e,bindPoint:an};te[Xc]={Type:null,size:0,setter:ze,arraySetter:$e,bindPoint:cn};te[Wc]={Type:null,size:0,setter:ze,arraySetter:$e,bindPoint:on};te[Yc]={Type:null,size:0,setter:ze,arraySetter:$e,bindPoint:Bn};te[Qc]={Type:null,size:0,setter:ze,arraySetter:$e,bindPoint:an};te[jc]={Type:null,size:0,setter:ze,arraySetter:$e,bindPoint:cn};function hA(t){const e=t.name;return e.startsWith("gl_")||e.startsWith("webgl_")}const EA=/(\.|\[|]|\w+)/g,dA=t=>t>="0"&&t<="9";function xA(t,e,n,r){const s=t.split(EA).filter(c=>c!=="");let i=0,a="";for(;;){const c=s[i++];a+=c;const u=dA(c[0]),d=u?parseInt(c):c;if(u&&(a+=s[i++]),i===s.length){n[d]=e;break}else{const f=s[i++],_=f==="[",I=n[d]||(_?[]:{});n[d]=I,n=I,r[a]=r[a]||function(O){return function(p){ms(O,p)}}(I),a+=f}}}function qr(t,e){let n=0;function r(c,u,d){const m=u.name.endsWith("[0]"),f=u.type,_=te[f];if(!_)throw new Error(`unknown type: 0x${f.toString(16)}`);let I;if(_.bindPoint){const O=n;n+=u.size,m?I=_.arraySetter(t,f,O,d,u.size):I=_.setter(t,f,O,d,u.size)}else _.arraySetter&&m?I=_.arraySetter(t,d):I=_.setter(t,d);return I.location=d,I}const s={},i={},a=t.getProgramParameter(e,cc);for(let c=0;c<a;++c){const u=t.getActiveUniform(e,c);if(hA(u))continue;let d=u.name;d.endsWith("[0]")&&(d=d.substr(0,d.length-3));const m=t.getUniformLocation(e,u.name);if(m){const f=r(e,u,m);s[d]=f,xA(d,f,i,s)}}return s}function ms(t,e){for(const n in e){const r=t[n];typeof r=="function"?r(e[n]):ms(t[n],e[n])}}function Un(t,...e){const n=t.uniformSetters||t,r=e.length;for(let s=0;s<r;++s){const i=e[s];if(Array.isArray(i)){const a=i.length;for(let c=0;c<a;++c)Un(n,i[c])}else for(const a in i){const c=n[a];c&&c(i[a])}}}function bA(t){const e=new Le([0,0,0]),n=t.inputManager,r=t.controllerIndex;if(t.controllerIndex!==null){const s=navigator.getGamepads()[r],i=s.buttons;for(let f=0;f<i.length;f++)n.setActionFromButton(f,i[f].pressed);const a=.4,c=s.axes[0];Math.abs(c)>=a&&e.add(new Le([c,0,0]));const u=s.axes[1];Math.abs(u)>=a&&e.add(new Le([0,0,u]));const d=s.axes[2];Math.abs(d)>=a&&(t.phi+=d*2);const m=s.axes[3];Math.abs(m)>=a&&(t.theta=es(t.theta+m*2,-80,80))}if(n.getFromAction("flashlight").justPressed&&(t.flashlight=!t.flashlight),n.getFromAction("forward").down&&e.add(new Le([0,0,-1])).normalize(),n.getFromAction("back").down&&e.add(new Le([0,0,1])).normalize(),n.getFromAction("left").down&&e.add(new Le([-1,0,0])).normalize(),n.getFromAction("right").down&&e.add(new Le([1,0,0])).normalize(),e.magnitude()>0){let s=t.player.clone();n.getFromAction("sprint").down&&e.scale(1.5);const i=TA(t.phi,e.scale(.007)),a=Math.floor(s.x+.5),c=Math.round(s.z);(!(t.maze.mazemap[a][c]&2)||Math.abs(s.z-c)>t.maze.roomSize*.9)&&i.x>0&&s.x-a>t.maze.roomSize*.8&&(i.x=0),(!(t.maze.mazemap[a][c]&1)||Math.abs(s.z-c)>t.maze.roomSize*.9)&&i.x<0&&s.x-a<-t.maze.roomSize*.8&&(i.x=0),(!(t.maze.mazemap[a][c]&8)||Math.abs(s.x-a)>t.maze.roomSize*.9)&&i.z>0&&s.z-c>t.maze.roomSize*.8&&(i.z=0),(!(t.maze.mazemap[a][c]&4)||Math.abs(s.x-a)>t.maze.roomSize*.9)&&i.z<0&&s.z-c<-t.maze.roomSize*.8&&(i.z=0),t.player.add(i)}}function TA(t,e){let n=new Ze().identity();return n.rotateY(-t*Math.PI/180),n.translate(e),n.rotateY(t*Math.PI/180),new Le(n.getTranslation())}function Jt(t,e,n){let r,s;return typeof e=="number"?(r=e,s=n):(r=e.x,s=e.z),t===1?r-=1:t===2?r+=1:t===4?s-=1:t===8&&(s+=1),new Le(r,0,s)}class xt{constructor(e,n){this.x=e,this.y=n}distance(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}direction(e){if(this.distance(e)!==1)return 0;if(this.x>e.x)return 1;if(this.x<e.x)return 2;if(this.y>e.y)return 4;if(this.y<e.y)return 8}adjacent(){return[this.up(),this.down(),this.left(),this.right()]}up(){return new xt(this.x,this.y+1)}down(){return new xt(this.x,this.y-1)}left(){return new xt(this.x-1,this.y)}right(){return new xt(this.x+1,this.y)}valid(e){return this.x<e.length&&this.x>=0&&this.y<e[this.x].length&&this.y>=0}retrieve(e){if(this.valid(e))return e[this.x][this.y]}insert(e,n){this.valid(e)&&(e[this.x][this.y]|=n)}add(e,n){this.valid(e)&&(e[this.x][this.y]=e[this.x][this.y]+n)}equals(e){return e!==void 0&&this.x===e.x&&this.y===e.y}pos(){return"X: "+this.x+" Y: "+this.y}copy(){return new xt(this.x,this.y)}}function Sn(t,e,n){let r=t[t.length-1],s=n!==void 0?n-1:void 0;if(e[r.x][r.y]>0||s===0)return{finished:!0,into:r,path:t};if(t.slice(0,-1).some(a=>a.equals(r)))return{finished:!1,into:r,path:t.slice(0,-1)};let i=Pn(r.adjacent()).filter(a=>a.valid(e));for(let a=0;a<i.length;a++){const c=i[a];let u=new Array(...t);u.push(c);let d=Sn(u,e,s);if(d.finished)return d.into.insert(e,d.into.direction(r)),r.insert(e,r.direction(d.into)),{finished:!0,into:r,path:u};if(!r.equals(d.into))return{finished:!1,into:d.into,path:t}}return Sn(t,e,s)}const Pn=t=>{for(let e=t.length-1;e>0;e--){const n=Math.floor(Math.random()*(e+1));[t[e],t[n]]=[t[n],t[e]]}return t};class pA{constructor(e,n){const r=new Array(n).fill(0);for(let p=0;p<n;p++)r[p]=new Array(n).fill(0);let s=new Array;for(let p=0;p<n;p++)for(let g=0;g<n;g++)s.push(new xt(p,g));Pn(s);let i=new Array;for(this.start=s.pop(),this.start.insert(r,16);s.length>0;){const p=s.pop(),g=Sn([p],r).path;for(this.goal===void 0&&p.distance(this.start)>n/2&&(this.goal=p),g.length>1&&p.x>0&&p.y>0&&p.x<n-1&&p.y<n-1&&i.push(p);g.length>0;){const X=g.shift();s=s.filter(ee=>!ee.equals(X))}}for(;i.length>0;){const p=i.pop(),g=p.retrieve(r),X=[1,2,4,8];let ee=0;if(X.forEach(w=>{w&g&&(ee+=1)}),ee==1){let w;switch(g){case 1:w=p.right();break;case 2:w=p.left();break;case 4:w=p.down();break;case 8:w=p.up();break}w.valid(r)&&(p.insert(r,p.direction(w)),w.insert(r,w.direction(p)))}}let a=[],c=[];const u=.35,d=.15,m=.45,f=1;for(let p=0;p<n;p++)for(let g=0;g<n;g++){r[p][g]===0&&console.debug(p+" "+g);const X=[(p-m)*f,(d-u)*f,(g-m)*f],ee=[(p+m)*f,(d-u)*f,(g-m)*f],w=[(p+m)*f,(d-u)*f,(g+m)*f],$=[(p-m)*f,(d-u)*f,(g+m)*f],W=[(p-m)*f,(d+u)*f,(g-m)*f],Y=[(p+m)*f,(d+u)*f,(g-m)*f],le=[(p+m)*f,(d+u)*f,(g+m)*f],Ae=[(p-m)*f,(d+u)*f,(g+m)*f],H=[0,-1,0],q=[0,1,0],ie=[-1,0,0],oe=[1,0,0],ae=[0,0,-1],K=[0,0,1];if(a=a.concat(Ae,Y,le,Y,Ae,W,$,ee,w,ee,X,$),c=c.concat(H,H,H,H,H,H,q,q,q,q,q,q),r[p][g]%2>0){const he=[(p-.55)*f,(d+u)*f,(g-m)*f],Ne=[(p-.55)*f,(d-u)*f,(g-m)*f],Ie=[(p-.55)*f,(d+u)*f,(g+m)*f],ke=[(p-.55)*f,(d-u)*f,(g+m)*f];a=a.concat($,Ae,Ie,ke,Ie,$,X,W,he,Ne,he,X,Ie,he,Ae,he,W,Ae,ke,Ne,$,Ne,X,$),c=c.concat(ae,ae,ae,ae,ae,ae,K,K,K,K,K,K,H,H,H,H,H,H,q,q,q,q,q,q)}else a=a.concat(W,Ae,X,$,X,Ae),c=c.concat(oe,oe,oe,oe,oe,oe);if(r[p][g]%4>1){const he=[(p+.55)*f,(d+u)*f,(g-m)*f],Ne=[(p+.55)*f,(d-u)*f,(g-m)*f],Ie=[(p+.55)*f,(d+u)*f,(g+m)*f],ke=[(p+.55)*f,(d-u)*f,(g+m)*f];a=a.concat(w,le,Ie,ke,Ie,w,ee,Y,he,Ne,he,ee,Ie,he,le,he,Y,le,ke,Ne,w,Ne,ee,w),c=c.concat(ae,ae,ae,ae,ae,ae,K,K,K,K,K,K,H,H,H,H,H,H,q,q,q,q,q,q)}else a=a.concat(le,Y,ee,w,ee,le),c=c.concat(ie,ie,ie,ie,ie,ie);if(r[p][g]%8>3){const he=[(p+m)*f,(d+u)*f,(g-.55)*f],Ne=[(p+m)*f,(d-u)*f,(g-.55)*f],Ie=[(p-m)*f,(d+u)*f,(g-.55)*f],ke=[(p-m)*f,(d-u)*f,(g-.55)*f];a=a.concat(ee,Y,he,he,Ne,ee,X,W,Ie,Ie,ke,X,he,Ie,Y,Ie,W,Y,Ne,ke,X,Ne,X,ee),c=c.concat(ie,ie,ie,ie,ie,ie,oe,oe,oe,oe,oe,oe,H,H,H,H,H,H,q,q,q,q,q,q)}else a=a.concat(Y,W,X,X,ee,Y),c=c.concat(K,K,K,K,K,K);if(r[p][g]%16>7){const he=[(p+m)*f,(d+u)*f,(g+.55)*f],Ne=[(p+m)*f,(d-u)*f,(g+.55)*f],Ie=[(p-m)*f,(d+u)*f,(g+.55)*f],ke=[(p-m)*f,(d-u)*f,(g+.55)*f];a=a.concat(w,le,he,he,Ne,w,$,Ae,Ie,Ie,ke,$,he,Ie,le,Ie,Ae,le,Ne,ke,$,Ne,w,$),c=c.concat(ie,ie,ie,ie,ie,ie,oe,oe,oe,oe,oe,oe,H,H,H,H,H,H,q,q,q,q,q,q)}else a=a.concat(Ae,le,w,$,w,Ae),c=c.concat(ae,ae,ae,ae,ae,ae)}const _=e.createVertexArray();e.bindVertexArray(_);const I=e.createBuffer();e.enableVertexAttribArray(0),e.bindBuffer(e.ARRAY_BUFFER,I),e.bufferData(e.ARRAY_BUFFER,new Float32Array(a),e.STATIC_DRAW),e.vertexAttribPointer(0,3,e.FLOAT,!1,0,0);var O=e.createBuffer();e.enableVertexAttribArray(1),e.bindBuffer(e.ARRAY_BUFFER,O),e.bufferData(e.ARRAY_BUFFER,new Float32Array(c),e.STATIC_DRAW),e.vertexAttribPointer(1,3,e.FLOAT,!1,0,0),this.mazemap=r,this.vao=_,this.normals=c,this.roomSize=m,this.vboSize=a.length}loadTextures(e,n){e.useProgram(this.program);const r=e.createTexture();e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,r),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n[0]),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_LINEAR),e.generateMipmap(e.TEXTURE_2D),e.activeTexture(e.TEXTURE1);const s=e.createTexture();e.bindTexture(e.TEXTURE_2D,s),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n[1]),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_LINEAR),e.generateMipmap(e.TEXTURE_2D),e.activeTexture(e.TEXTURE2);const i=e.createTexture();e.bindTexture(e.TEXTURE_2D,i),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n[2]),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_LINEAR),e.generateMipmap(e.TEXTURE_2D),this.textures=[r,s,i]}update(e){const n=e.gl,r=this.program;n.useProgram(r),n.bindVertexArray(this.vao),Un(this.uniformSetter,e.globalUniforms),n.activeTexture(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,this.textures[0]);let s=n.getUniformLocation(r,"uTexture");n.uniform1i(s,0),n.activeTexture(n.TEXTURE1),n.bindTexture(n.TEXTURE_2D,this.textures[1]);let i=n.getUniformLocation(r,"uFloor");n.uniform1i(i,1),n.activeTexture(n.TEXTURE2),n.bindTexture(n.TEXTURE_2D,this.textures[2]);let a=n.getUniformLocation(r,"uCeiling");n.uniform1i(a,2),n.drawArrays(n.TRIANGLES,0,this.vboSize/3)}}const yA="/assets/wallpaper2-BDww3Sdk.png",RA="/assets/floor-B5gazqXr.png",_A="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIACAIAAAB7GkOtAAABhWlDQ1BJQ0MgcHJvZmlsZQAAKJF9kT1Iw0AcxV9TpSIVBwt+4JChOlkQFREnqWIRLJS2QqsOJpd+QZOGJMXFUXAtOPixWHVwcdbVwVUQBD9AnB2cFF2kxP8lhRYxHhz34929x907QKiXmWp2jAOqZhnJWFTMZFfFwCv86EcQsxiUmKnHU4tpeI6ve/j4ehfhWd7n/hw9Ss5kgE8knmO6YRFvEE9vWjrnfeIQK0oK8TnxmEEXJH7kuuzyG+eCwwLPDBnp5DxxiFgstLHcxqxoqMRTxGFF1ShfyLiscN7irJarrHlP/sJgTltJcZ3mMGJYQhwJiJBRRQllWIjQqpFiIkn7UQ//kONPkEsmVwmMHAuoQIXk+MH/4He3Zn5ywk0KRoHOF9v+GAECu0CjZtvfx7bdOAH8z8CV1vJX6sDMJ+m1lhY+Anq3gYvrlibvAZc7wMCTLhmSI/lpCvk88H5G35QF+m6B7jW3t+Y+Th+ANHW1fAMcHAKjBcpe93h3V3tv/55p9vcDwqdyx7W4IIIAAAAJcEhZcwAALiMAAC4jAXilP3YAAAAHdElNRQfoAxcOFCpDJhUwAAAAGXRFWHRDb21tZW50AENyZWF0ZWQgd2l0aCBHSU1QV4EOFwAABhdJREFUeNrt2bENAyEQRUHbgpxKaO/6pBJyEqd7OQIJZjLSnzzt3fd5ng8A9/mZAEAAABAAAE6X4iP3ZpGVRqnGN77xDbJrfBcAwKUEAEAAABAAAAQAAAEAQAAAEAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAQAAAEAQAAAEAAABAAAAQBAAAAQAAAEAEAAABAAAAQAAAEAQAAAEAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAQAAAEAQAAAEAAABAAAAQBAAAAQAAAEAEAATAAgAAAIAAACAIAAACAAAAgAAAIAgAAAIAAACAAAAgCAAAAgAAAIAAACAIAAACAAAAgAAAIAgAAAIAAACAAAAgAgAAAIAAACAIAAACAAAAgAAAIAgAAAIAAACAAAAgCAAAAgAAAIAAACAIAAACAAAAgAAAIAgAAAIAAACAAAAgAgAAAIAAACAIAAACAAAAgAAAIAgAAAIAAACAAAAgCAAAAgAAAIAAACAIAAACAAAAgAAAIAgAAAIAAACAAAAgCAAAAIAAACAIAAAHCsFB+jVIvsYnzjGx8XAAACAIAAADDX6x9A7s0iK8Wvn8Y3vvFZPL4LAOBSAgAgAAAIAAACAIAAACAAAAgAAAIAgAAAIAAACAAAAgCAAAAgAAAIAAACAIAAACAAAAgAAAIAgAAAIAAACAAAAgAgAAAIAAACAIAAACAAAAgAAAIAgAAAIAAACAAAAgCAAAAgAAAIAAACAIAAACAAAAgAAAIAgAAAIAAACAAAAgAgACYAEAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAQAAAEAQAAAEAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAQAAAEAEAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAQAAAEAQAAAEAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAQAAAEAEAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAQAAAEAQAAAEAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAQAAAEAQAAABAAAAQBAAAA4VoqPUapFdjG+8Y2PCwAAAQBAAACY6/UPIPdmkZXi10/jG9/4LB7fBQBwKQEAEAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAQAAAEAQAAAEAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAQAAAEAEAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAQAAAEAQAAAEAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAQAAAEAEAATAAgAAAIAgAAAIAAACAAAAgCAAAAgAAAIAAACAIAAACAAAAgAAAIAgAAAIAAACAAAAgCAAAAgAAAIAAACAIAAAAgAAAIAgAAAIAAACAAAAgCAAAAgAAAIAAACAIAAACAAAAgAAAIAgAAAIAAACAAAAgCAAAAgAAAIAAACAIAAAAgAAAIAgAAAIAAACAAAAgCAAAAgAAAIAAACAIAAACAAAAgAAAIAgAAAIAAACAAAAgCAAAAgAAAIAAACAIAAACAAAAIAgAAAIAAAHCvFxyjVIrsY3/jGxwUAgAAAIAAAzPX6B5B7s8hK8eun8Y1vfBaP7wIAuJQAAAgAAAIAgAAAIAAACAAAAgCAAAAgAAAIAAACAIAAACAAAAgAAAIAgAAAIAAACAAAAgCAAAAgAAAIAAACAIAAAAgAAAIAgAAAIAAACAAAAgCAAAAgAAAIAAACAIAAACAAAAgAAAIAgAAAIAAACAAAAgCAAAAgAAAIAAACAIAAAAiACQAEAAABAEAAABAAAAQAAAEAQAAAEAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAQAAAEAQAAAEAAABAAAAQBAAAAEAAABAEAAABAAAAQAAAEAQAAAEAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAQAAAEAQAAAEAAABAAAAQBAAAAEAAABAEAAABAAAAQAAAEAQAAAEAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAQAAAEAQAAAEAAABAAAAQBAAAAQAAABAEAAABAAAI6V4mOUapFdjG984+MCAEAAABAAAOb6A48KSQUZwwR0AAAAAElFTkSuQmCC",gA="/assets/eyes-BN1QhFwl.png";class FA{update(e){const n=new Le(this.position.getTranslation()),r=Math.floor(n.x+.5),s=Math.round(n.z);this.timer++;let i=0;switch(this.state){case"idle":if(this.timer%60===0){Math.random()>.7&&(this.state="wander");const u=[1,2,4,8];let d=[];const m=e.maze.mazemap;for(const f of u)m[r][s]&f&&d.push(Jt(f,r,s));this.goingTo=Pn(d).pop()}break;case"wander":i=.005,this.goingTo.distance(this.position.getTranslation())<.01&&(this.state="idle",this.position=new Ze().identity().translate(this.goingTo));break;case"chase":i=.015,this.goingTo.distance(this.position.getTranslation())<.01&&(this.position=new Ze().identity().translate(this.goingTo),this.target.loc.distance(this.goingTo)<.01?this.state="idle":this.goingTo=Jt(this.target.dir,this.goingTo))}const a=e.player.clone(),c=this.inSight(a,e.maze.mazemap);if(c===15&&a.distance(this.position.getTranslation())<.6&&(e.gameOver=!0),c&&(this.state="chase",a.x=Math.round(a.x),a.z=Math.round(a.z),this.target={loc:a,dir:c},this.goingTo.distance(Jt(c,r,s))&&(this.goingTo=Jt(0,r,s))),i>0){const u=this.goingTo.clone().subtract(this.position.getTranslation()).normalize().scale(i);this.position.translate(u)}this.draw(e)}inSight(e,n){const r=new Le(this.position.getTranslation()),s=Math.floor(r.x+.5),i=Math.round(r.z);function a(d,m,f){if(d<0||m<0||d>=n.length||m>=n.length)return 0;let _=d,I=m;return Math.round(e.x)==d&&Math.round(e.z)==m?f:n[d][m]&f?(f===1?_=d-1:f===2?_=d+1:f===4?I=m-1:f===8&&(I=m+1),a(_,I,f)):0}let c=0;const u=[1,2,4,8];for(const d of u)c|=a(s,i,d);return c}draw(e){const n=e.gl,r=this.program;this.angleX+=(Math.random()+Math.random())/10,this.angleY+=Math.random()/10,n.useProgram(r),n.bindVertexArray(this.vao);let s=n.getUniformLocation(r,"uPosition");n.uniformMatrix4fv(s,!1,this.position);let i=n.getUniformLocation(r,"uRotation");const a=new Ze().identity().rotateY(this.angleY).rotateX(this.angleX).scale(.1);n.activeTexture(n.TEXTURE0),n.bindTexture(n.TEXTURE_CUBE_MAP,this.texture);let c=n.getUniformLocation(r,"uTexture");n.uniform1i(c,0),n.uniformMatrix4fv(i,!1,a),Un(this.uniformSetter,e.globalUniforms),n.drawElements(n.TRIANGLE_STRIP,this.iboSize,n.UNSIGNED_INT,0)}constructor(e){let s=[],i=[],a=0;for(let _=0;_<=32;_++){const I=Math.cos(a),O=Math.sin(a);let p=0;for(let g=0;g<64;g++){const X=Math.cos(p),ee=Math.sin(p),w=O*X,$=O*ee,W=I;s.push(w,$,W),s.push(w,$,W),p+=2*Math.PI/64}a+=Math.PI/32}let c=0;for(let _=0;_<32;_++){for(let I=0;I<64;I++)i.push(c+I),i.push(c+I+64);i.push(c+0),i.push(c+64),c+=64}const u=i.length,d=e.createVertexArray();e.bindVertexArray(d);const m=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,m),e.bufferData(e.ARRAY_BUFFER,new Float32Array(s),e.STATIC_DRAW),e.enableVertexAttribArray(0),e.vertexAttribPointer(0,3,e.FLOAT,!1,6*4,0),e.enableVertexAttribArray(1),e.vertexAttribPointer(1,3,e.FLOAT,!1,6*4,3*4);const f=e.createBuffer();e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,f),e.bufferData(e.ELEMENT_ARRAY_BUFFER,new Uint32Array(i),e.STATIC_DRAW),this.vao=d,this.iboSize=u,this.angleX=0,this.angleY=0,this.position=new Ze().identity(),this.state="idle",this.timer=0,this.goingTo=new Le}loadTextures(e,n){e.useProgram(this.program),e.activeTexture(e.TEXTURE0);const r=e.createTexture();e.bindTexture(e.TEXTURE_CUBE_MAP,r),e.texImage2D(e.TEXTURE_CUBE_MAP_NEGATIVE_X,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n),e.bindTexture(e.TEXTURE_CUBE_MAP,r),e.texImage2D(e.TEXTURE_CUBE_MAP_NEGATIVE_Y,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n),e.bindTexture(e.TEXTURE_CUBE_MAP,r),e.texImage2D(e.TEXTURE_CUBE_MAP_NEGATIVE_Z,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n),e.bindTexture(e.TEXTURE_CUBE_MAP,r),e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n),e.bindTexture(e.TEXTURE_CUBE_MAP,r),e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_Y,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n),e.bindTexture(e.TEXTURE_CUBE_MAP,r),e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_Z,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n),e.bindTexture(e.TEXTURE_CUBE_MAP,r),e.generateMipmap(e.TEXTURE_CUBE_MAP),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_WRAP_R,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_LINEAR),this.texture=r}}const Kr=t=>{const e=t.gl,n=new Ze().identity();let r=.01,s=1e3,i=e.canvas.width/e.canvas.height;const a=new Ze().perspective({fovy:Math.PI/4,aspect:i,near:r,far:s});n.identity(),n.rotateX(t.theta*Math.PI/180),n.rotateY(t.phi*Math.PI/180),n.multiplyRight(new Ze().identity().translate(t.player.clone().scale(-1))),e.colorMask(!0,!0,!0,!0);let c=new Ze().identity();c.rotateY(-t.phi*Math.PI/180),c.rotateX(-t.theta*Math.PI/180),c.translate([0,0,1]),c.rotateX(t.theta*Math.PI/180),c.rotateY(t.phi*Math.PI/180),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT);const u={uProjection:a,uModelView:n,lightPosition:t.player.clone().add([0,-.02,0]).scale(-1),u_lightDirection:new Le(c.getTranslation()).scale(-1),u_limit:Math.cos(20*Math.PI/180),uFlashlight:t.flashlight};t.globalUniforms=u,t.objects.forEach(d=>{d.update(t)}),t.maze.update(t),t.enemy.update(t)},MA=t=>{const e=en.useRef(),n=en.useRef(),r=()=>{if(!n.current)return;const u=n.current;if(u.gameOver){u.gl.clearColor(0,0,0,1),An("over");return}bA(u),Kr(u),u.inputManager.update(),requestAnimationFrame(r)},s=()=>{n.current&&document.body.requestPointerLock()},i=u=>{if(!n.current)return;const d=n.current,m=10;d.phi+=u.movementX/m,d.theta=es(d.theta+u.movementY/m,-80,80)},a=u=>{if(!n.current)return;const d=n.current;d.controllerIndex=u.gamepad.index},c=async()=>{const u=e.current.getContext("webgl2",{antialias:!0});if(!u)return;const d=new Array,m=new pA(u,5),f=new Jr;m.program=jr(u,rc,sc),u.enable(u.DEPTH_TEST),u.clearColor(0,0,0,1),u.enable(u.BLEND),u.blendFunc(u.SRC_ALPHA,u.ONE_MINUS_SRC_ALPHA);const _=new FA(u);_.program=jr(u,ic,oc),_.position.translate([m.goal.x,0,m.goal.y]);const I=await IA();m.loadTextures(u,I),_.loadTextures(u,await nn(gA));const O=()=>{n.current.gameOver||(u.viewport(0,0,u.canvas.width,u.canvas.height),Kr(n.current))};e.current.addEventListener("mousedown",s),document.addEventListener("mousemove",i,!1),window.addEventListener("gamepadconnected",a),m.uniformSetter=qr(u,m.program),_.uniformSetter=qr(u,_.program),n.current={gl:u,enemy:_,inputManager:f,maze:m,player:new Le(m.start.x,0,m.start.y),phi:90,theta:5,gameOver:!1,globalUniforms:new Array,objects:d,controllerIndex:null,flashlight:!0},Qr(e.current),O(),window.addEventListener("resize",()=>{Qr(e.current)&&O()}),requestAnimationFrame(r)};return en.useEffect(()=>{c()},[]),_e.jsx("div",{className:"relative bg-black h-[inherit] w-full",children:_e.jsx("canvas",{ref:e,className:"w-full h-[inherit]"})})},nn=async t=>{const e=new Image;return await new Promise((n,r)=>{e.onload=()=>{n()},e.onerror=function(){console.log(t,"not found."),r()},e.src=t}),e},IA=async t=>{const e=new Array;return e.push(await nn(yA)),e.push(await nn(RA)),e.push(await nn(_A)),e},Zr=t=>_e.jsx("button",{...t,onClick:t.onClick,className:"bg-jgu2 uppercase p-2 text-neutral-50 transition-all active:scale-100 hover:scale-110 duration-200 ease-in-out rounded-xl pr-4 pl-4 pointer-events-auto w-36 h-36",children:t.children??_e.jsx(_e.Fragment,{children:""})}),SA=t=>_e.jsx("div",{className:"w-full pt-24 h-[inherit] flex justify-center items-center flex-wrap gap-2",children:t.children}),BA=()=>_e.jsx("div",{className:"relative place-content-center flex flex-col bg-black h-full w-full",children:_e.jsxs("div",{className:"h-fit justify-center",children:[_e.jsx("div",{className:"relative w-full flex justify-center items-center flex-wrap gap-2 text-9xl text-neutral-50",children:"Labyrinth"}),_e.jsxs("div",{className:"pt-24 w-full flex flex-col justify-center items-center flex-wrap gap-2 text-xl text-neutral-50",children:[_e.jsx("div",{children:"Controls: "}),_e.jsx("div",{children:"WASD - Move"}),_e.jsx("div",{className:"text-yellow-300 animate-pulse",children:"F - Flashlight"})]}),_e.jsxs(SA,{children:[_e.jsx(Zr,{onClick:()=>{document.body.requestPointerLock(),document.body.requestFullscreen(),An("game")},children:"Start"}),_e.jsx(Zr,{onClick:()=>{sn.addKeyAction("q","left"),sn.addKeyAction("z","forward")},children:"French mode"})]})]})});let An,sn;const PA=()=>{const[t,e]=en.useState("menu");switch(An=e,sn=new Jr,t){case"menu":return _e.jsx(BA,{});case"game":return _e.jsx(MA,{inManager:sn});default:return _e.jsx(Aa,{})}};export{PA as default,sn as inManager,An as setScene};
