import{r as en,j as st}from"./index-DlWJ7fOk.js";const sa={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0,_cartographicRadians:!1};globalThis.mathgl=globalThis.mathgl||{config:{...sa}};const Xe=globalThis.mathgl.config;function ia(t,{precision:e=Xe.precision}={}){return t=oa(t),"".concat(parseFloat(t.toPrecision(e)))}function It(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function qr(t,e,n){return ca(t,r=>Math.max(e,Math.min(n,r)))}function Kr(t,e,n){const r=Xe.EPSILON;n&&(Xe.EPSILON=n);try{if(t===e)return!0;if(It(t)&&It(e)){if(t.length!==e.length)return!1;for(let s=0;s<t.length;++s)if(!Kr(t[s],e[s]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):typeof t=="number"&&typeof e=="number"?Math.abs(t-e)<=Xe.EPSILON*Math.max(1,Math.abs(t),Math.abs(e)):!1}finally{Xe.EPSILON=r}}function oa(t){return Math.round(t/Xe.EPSILON)*Xe.EPSILON}function aa(t){return t.clone?t.clone():new Array(t.length)}function ca(t,e,n){if(It(t)){const r=t;n=n||aa(r);for(let s=0;s<n.length&&s<r.length;++s){const i=typeof t=="number"?t:t[s];n[s]=e(i,s,n)}return n}return e(t)}function ua(t){function e(){var n=Reflect.construct(t,Array.from(arguments));return Object.setPrototypeOf(n,Object.getPrototypeOf(this)),n}return e.prototype=Object.create(t.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t,e}class Zr extends ua(Array){clone(){return new this.constructor().copy(this)}fromArray(e,n=0){for(let r=0;r<this.ELEMENTS;++r)this[r]=e[r+n];return this.check()}toArray(e=[],n=0){for(let r=0;r<this.ELEMENTS;++r)e[n+r]=this[r];return e}toObject(e){return e}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}to(e){return e===this?this:It(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(Xe)}formatString(e){let n="";for(let r=0;r<this.ELEMENTS;++r)n+=(r>0?", ":"")+ia(this[r],e);return"".concat(e.printTypes?this.constructor.name:"","[").concat(n,"]")}equals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(!Kr(this[n],e[n]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(this[n]!==e[n])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,n,r){if(r===void 0)return this.lerp(this,e,n);for(let s=0;s<this.ELEMENTS;++s){const i=e[s],c=typeof n=="number"?n:n[s];this[s]=i+r*(c-i)}return this.check()}min(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(e[n],this[n]);return this.check()}max(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.max(e[n],this[n]);return this.check()}clamp(e,n){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e[r]),n[r]);return this.check()}add(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]+=n[r];return this.check()}subtract(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]-=n[r];return this.check()}scale(e){if(typeof e=="number")for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;else for(let n=0;n<this.ELEMENTS&&n<e.length;++n)this[n]*=e[n];return this.check()}multiplyByScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}check(){if(Xe.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let e=this.length===this.ELEMENTS;for(let n=0;n<this.ELEMENTS;++n)e=e&&Number.isFinite(this[n]);return e}sub(e){return this.subtract(e)}setScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=e;return this.check()}addScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}divideScalar(e){return this.multiplyByScalar(1/e)}clampScalar(e,n){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e),n);return this.check()}get elements(){return this}}function fa(t,e){if(t.length!==e)return!1;for(let n=0;n<t.length;++n)if(!Number.isFinite(t[n]))return!1;return!0}function Ve(t){if(!Number.isFinite(t))throw new Error("Invalid number ".concat(JSON.stringify(t)));return t}function yn(t,e,n=""){if(Xe.debug&&!fa(t,e))throw new Error("math.gl: ".concat(n," some fields set to invalid numbers'"));return t}function Gr(t,e){if(!t)throw new Error("math.gl assertion ".concat(e))}class la extends Zr{get x(){return this[0]}set x(e){this[0]=Ve(e)}get y(){return this[1]}set y(e){this[1]=Ve(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let n=0;n<this.ELEMENTS;++n)e+=this[n]*this[n];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let n=0;for(let r=0;r<this.ELEMENTS;++r){const s=this[r]-e[r];n+=s*s}return Ve(n)}dot(e){let n=0;for(let r=0;r<this.ELEMENTS;++r)n+=this[r]*e[r];return Ve(n)}normalize(){const e=this.magnitude();if(e!==0)for(let n=0;n<this.ELEMENTS;++n)this[n]/=e;return this.check()}multiply(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]*=n[r];return this.check()}divide(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]/=n[r];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return Gr(e>=0&&e<this.ELEMENTS,"index is out of range"),Ve(this[e])}setComponent(e,n){return Gr(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=n,this.check()}addVectors(e,n){return this.copy(e).add(n)}subVectors(e,n){return this.copy(e).subtract(n)}multiplyVectors(e,n){return this.copy(e).multiply(n)}addScaledVector(e,n){return this.add(new this.constructor(e).multiplyScalar(n))}}const tn=1e-6;let _t=typeof Float32Array<"u"?Float32Array:Array;function ma(){const t=new _t(2);return _t!=Float32Array&&(t[0]=0,t[1]=0),t}function ha(t,e,n){const r=e[0],s=e[1];return t[0]=n[0]*r+n[4]*s+n[12],t[1]=n[1]*r+n[5]*s+n[13],t}(function(){const t=ma();return function(e,n,r,s,i,c){let o,m;for(n||(n=2),r||(r=0),s?m=Math.min(s*n+r,e.length):m=e.length,o=r;o<m;o+=n)t[0]=e[o],t[1]=e[o+1],i(t,t,c),e[o]=t[0],e[o+1]=t[1];return e}})();function Ea(t,e,n){const r=e[0],s=e[1],i=n[3]*r+n[7]*s||1;return t[0]=(n[0]*r+n[4]*s)/i,t[1]=(n[1]*r+n[5]*s)/i,t}function Qr(t,e,n){const r=e[0],s=e[1],i=e[2],c=n[3]*r+n[7]*s+n[11]*i||1;return t[0]=(n[0]*r+n[4]*s+n[8]*i)/c,t[1]=(n[1]*r+n[5]*s+n[9]*i)/c,t[2]=(n[2]*r+n[6]*s+n[10]*i)/c,t}function da(t,e,n){const r=e[0],s=e[1];return t[0]=n[0]*r+n[2]*s,t[1]=n[1]*r+n[3]*s,t[2]=e[2],t}function ba(){const t=new _t(3);return _t!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function Ta(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function xa(t,e,n){const r=e[0],s=e[1],i=e[2],c=n[0],o=n[1],m=n[2];return t[0]=s*m-i*o,t[1]=i*c-r*m,t[2]=r*o-s*c,t}function Jr(t,e,n){const r=e[0],s=e[1],i=e[2];let c=n[3]*r+n[7]*s+n[11]*i+n[15];return c=c||1,t[0]=(n[0]*r+n[4]*s+n[8]*i+n[12])/c,t[1]=(n[1]*r+n[5]*s+n[9]*i+n[13])/c,t[2]=(n[2]*r+n[6]*s+n[10]*i+n[14])/c,t}function Aa(t,e,n){const r=e[0],s=e[1],i=e[2];return t[0]=r*n[0]+s*n[3]+i*n[6],t[1]=r*n[1]+s*n[4]+i*n[7],t[2]=r*n[2]+s*n[5]+i*n[8],t}function pa(t,e,n){const r=n[0],s=n[1],i=n[2],c=n[3],o=e[0],m=e[1],h=e[2];let b=s*h-i*m,f=i*o-r*h,g=r*m-s*o,M=s*g-i*f,G=i*b-r*g,p=r*f-s*b;const _=c*2;return b*=_,f*=_,g*=_,M*=2,G*=2,p*=2,t[0]=o+b+M,t[1]=m+f+G,t[2]=h+g+p,t}function ya(t,e,n,r){const s=[],i=[];return s[0]=e[0]-n[0],s[1]=e[1]-n[1],s[2]=e[2]-n[2],i[0]=s[0],i[1]=s[1]*Math.cos(r)-s[2]*Math.sin(r),i[2]=s[1]*Math.sin(r)+s[2]*Math.cos(r),t[0]=i[0]+n[0],t[1]=i[1]+n[1],t[2]=i[2]+n[2],t}function Ra(t,e,n,r){const s=[],i=[];return s[0]=e[0]-n[0],s[1]=e[1]-n[1],s[2]=e[2]-n[2],i[0]=s[2]*Math.sin(r)+s[0]*Math.cos(r),i[1]=s[1],i[2]=s[2]*Math.cos(r)-s[0]*Math.sin(r),t[0]=i[0]+n[0],t[1]=i[1]+n[1],t[2]=i[2]+n[2],t}function _a(t,e,n,r){const s=[],i=[];return s[0]=e[0]-n[0],s[1]=e[1]-n[1],s[2]=e[2]-n[2],i[0]=s[0]*Math.cos(r)-s[1]*Math.sin(r),i[1]=s[0]*Math.sin(r)+s[1]*Math.cos(r),i[2]=s[2],t[0]=i[0]+n[0],t[1]=i[1]+n[1],t[2]=i[2]+n[2],t}function ga(t,e){const n=t[0],r=t[1],s=t[2],i=e[0],c=e[1],o=e[2],m=Math.sqrt((n*n+r*r+s*s)*(i*i+c*c+o*o)),h=m&&Ta(t,e)/m;return Math.acos(Math.min(Math.max(h,-1),1))}(function(){const t=ba();return function(e,n,r,s,i,c){let o,m;for(n||(n=3),r||(r=0),s?m=Math.min(s*n+r,e.length):m=e.length,o=r;o<m;o+=n)t[0]=e[o],t[1]=e[o+1],t[2]=e[o+2],i(t,t,c),e[o]=t[0],e[o+1]=t[1],e[o+2]=t[2];return e}})();const Rn=[0,0,0];let Kt;class De extends la{static get ZERO(){return Kt||(Kt=new De(0,0,0),Object.freeze(Kt)),Kt}constructor(e=0,n=0,r=0){super(-0,-0,-0),arguments.length===1&&It(e)?this.copy(e):(Xe.debug&&(Ve(e),Ve(n),Ve(r)),this[0]=e,this[1]=n,this[2]=r)}set(e,n,r){return this[0]=e,this[1]=n,this[2]=r,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return Xe.debug&&(Ve(e.x),Ve(e.y),Ve(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=Ve(e)}angle(e){return ga(this,e)}cross(e){return xa(this,this,e),this.check()}rotateX({radians:e,origin:n=Rn}){return ya(this,this,n,e),this.check()}rotateY({radians:e,origin:n=Rn}){return Ra(this,this,n,e),this.check()}rotateZ({radians:e,origin:n=Rn}){return _a(this,this,n,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return Jr(this,this,e),this.check()}transformAsVector(e){return Qr(this,this,e),this.check()}transformByMatrix3(e){return Aa(this,this,e),this.check()}transformByMatrix2(e){return da(this,this,e),this.check()}transformByQuaternion(e){return pa(this,this,e),this.check()}}class Fa extends Zr{toString(){let e="[";if(Xe.printRowMajor){e+="row-major:";for(let n=0;n<this.RANK;++n)for(let r=0;r<this.RANK;++r)e+=" ".concat(this[r*this.RANK+n])}else{e+="column-major:";for(let n=0;n<this.ELEMENTS;++n)e+=" ".concat(this[n])}return e+="]",e}getElementIndex(e,n){return n*this.RANK+e}getElement(e,n){return this[n*this.RANK+e]}setElement(e,n,r){return this[n*this.RANK+e]=Ve(r),this}getColumn(e,n=new Array(this.RANK).fill(-0)){const r=e*this.RANK;for(let s=0;s<this.RANK;++s)n[s]=this[r+s];return n}setColumn(e,n){const r=e*this.RANK;for(let s=0;s<this.RANK;++s)this[r+s]=n[s];return this}}function Ma(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Sa(t,e){if(t===e){const n=e[1],r=e[2],s=e[3],i=e[6],c=e[7],o=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=i,t[11]=e[14],t[12]=s,t[13]=c,t[14]=o}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function Pa(t,e){const n=e[0],r=e[1],s=e[2],i=e[3],c=e[4],o=e[5],m=e[6],h=e[7],b=e[8],f=e[9],g=e[10],M=e[11],G=e[12],p=e[13],_=e[14],X=e[15],ee=n*o-r*c,w=n*m-s*c,z=n*h-i*c,W=r*m-s*o,Y=r*h-i*o,me=s*h-i*m,ue=b*p-f*G,q=b*_-g*G,K=b*X-M*G,ie=f*_-g*p,oe=f*X-M*p,ae=g*X-M*_;let Z=ee*ae-w*oe+z*ie+W*K-Y*q+me*ue;return Z?(Z=1/Z,t[0]=(o*ae-m*oe+h*ie)*Z,t[1]=(s*oe-r*ae-i*ie)*Z,t[2]=(p*me-_*Y+X*W)*Z,t[3]=(g*Y-f*me-M*W)*Z,t[4]=(m*K-c*ae-h*q)*Z,t[5]=(n*ae-s*K+i*q)*Z,t[6]=(_*z-G*me-X*w)*Z,t[7]=(b*me-g*z+M*w)*Z,t[8]=(c*oe-o*K+h*ue)*Z,t[9]=(r*K-n*oe-i*ue)*Z,t[10]=(G*Y-p*z+X*ee)*Z,t[11]=(f*z-b*Y-M*ee)*Z,t[12]=(o*q-c*ie-m*ue)*Z,t[13]=(n*ie-r*q+s*ue)*Z,t[14]=(p*w-G*W-_*ee)*Z,t[15]=(b*W-f*w+g*ee)*Z,t):null}function Ua(t){const e=t[0],n=t[1],r=t[2],s=t[3],i=t[4],c=t[5],o=t[6],m=t[7],h=t[8],b=t[9],f=t[10],g=t[11],M=t[12],G=t[13],p=t[14],_=t[15],X=e*c-n*i,ee=e*o-r*i,w=n*o-r*c,z=h*G-b*M,W=h*p-f*M,Y=b*p-f*G,me=e*Y-n*W+r*z,ue=i*Y-c*W+o*z,q=h*w-b*ee+f*X,K=M*w-G*ee+p*X;return m*me-s*ue+_*q-g*K}function kr(t,e,n){const r=e[0],s=e[1],i=e[2],c=e[3],o=e[4],m=e[5],h=e[6],b=e[7],f=e[8],g=e[9],M=e[10],G=e[11],p=e[12],_=e[13],X=e[14],ee=e[15];let w=n[0],z=n[1],W=n[2],Y=n[3];return t[0]=w*r+z*o+W*f+Y*p,t[1]=w*s+z*m+W*g+Y*_,t[2]=w*i+z*h+W*M+Y*X,t[3]=w*c+z*b+W*G+Y*ee,w=n[4],z=n[5],W=n[6],Y=n[7],t[4]=w*r+z*o+W*f+Y*p,t[5]=w*s+z*m+W*g+Y*_,t[6]=w*i+z*h+W*M+Y*X,t[7]=w*c+z*b+W*G+Y*ee,w=n[8],z=n[9],W=n[10],Y=n[11],t[8]=w*r+z*o+W*f+Y*p,t[9]=w*s+z*m+W*g+Y*_,t[10]=w*i+z*h+W*M+Y*X,t[11]=w*c+z*b+W*G+Y*ee,w=n[12],z=n[13],W=n[14],Y=n[15],t[12]=w*r+z*o+W*f+Y*p,t[13]=w*s+z*m+W*g+Y*_,t[14]=w*i+z*h+W*M+Y*X,t[15]=w*c+z*b+W*G+Y*ee,t}function Ia(t,e,n){const r=n[0],s=n[1],i=n[2];let c,o,m,h,b,f,g,M,G,p,_,X;return e===t?(t[12]=e[0]*r+e[4]*s+e[8]*i+e[12],t[13]=e[1]*r+e[5]*s+e[9]*i+e[13],t[14]=e[2]*r+e[6]*s+e[10]*i+e[14],t[15]=e[3]*r+e[7]*s+e[11]*i+e[15]):(c=e[0],o=e[1],m=e[2],h=e[3],b=e[4],f=e[5],g=e[6],M=e[7],G=e[8],p=e[9],_=e[10],X=e[11],t[0]=c,t[1]=o,t[2]=m,t[3]=h,t[4]=b,t[5]=f,t[6]=g,t[7]=M,t[8]=G,t[9]=p,t[10]=_,t[11]=X,t[12]=c*r+b*s+G*i+e[12],t[13]=o*r+f*s+p*i+e[13],t[14]=m*r+g*s+_*i+e[14],t[15]=h*r+M*s+X*i+e[15]),t}function Na(t,e,n){const r=n[0],s=n[1],i=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*s,t[5]=e[5]*s,t[6]=e[6]*s,t[7]=e[7]*s,t[8]=e[8]*i,t[9]=e[9]*i,t[10]=e[10]*i,t[11]=e[11]*i,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function wa(t,e,n,r){let s=r[0],i=r[1],c=r[2],o=Math.sqrt(s*s+i*i+c*c),m,h,b,f,g,M,G,p,_,X,ee,w,z,W,Y,me,ue,q,K,ie,oe,ae,Z,Ee;return o<tn?null:(o=1/o,s*=o,i*=o,c*=o,h=Math.sin(n),m=Math.cos(n),b=1-m,f=e[0],g=e[1],M=e[2],G=e[3],p=e[4],_=e[5],X=e[6],ee=e[7],w=e[8],z=e[9],W=e[10],Y=e[11],me=s*s*b+m,ue=i*s*b+c*h,q=c*s*b-i*h,K=s*i*b-c*h,ie=i*i*b+m,oe=c*i*b+s*h,ae=s*c*b+i*h,Z=i*c*b-s*h,Ee=c*c*b+m,t[0]=f*me+p*ue+w*q,t[1]=g*me+_*ue+z*q,t[2]=M*me+X*ue+W*q,t[3]=G*me+ee*ue+Y*q,t[4]=f*K+p*ie+w*oe,t[5]=g*K+_*ie+z*oe,t[6]=M*K+X*ie+W*oe,t[7]=G*K+ee*ie+Y*oe,t[8]=f*ae+p*Z+w*Ee,t[9]=g*ae+_*Z+z*Ee,t[10]=M*ae+X*Z+W*Ee,t[11]=G*ae+ee*Z+Y*Ee,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function Ba(t,e,n){const r=Math.sin(n),s=Math.cos(n),i=e[4],c=e[5],o=e[6],m=e[7],h=e[8],b=e[9],f=e[10],g=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=i*s+h*r,t[5]=c*s+b*r,t[6]=o*s+f*r,t[7]=m*s+g*r,t[8]=h*s-i*r,t[9]=b*s-c*r,t[10]=f*s-o*r,t[11]=g*s-m*r,t}function Da(t,e,n){const r=Math.sin(n),s=Math.cos(n),i=e[0],c=e[1],o=e[2],m=e[3],h=e[8],b=e[9],f=e[10],g=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=i*s-h*r,t[1]=c*s-b*r,t[2]=o*s-f*r,t[3]=m*s-g*r,t[8]=i*r+h*s,t[9]=c*r+b*s,t[10]=o*r+f*s,t[11]=m*r+g*s,t}function La(t,e,n){const r=Math.sin(n),s=Math.cos(n),i=e[0],c=e[1],o=e[2],m=e[3],h=e[4],b=e[5],f=e[6],g=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=i*s+h*r,t[1]=c*s+b*r,t[2]=o*s+f*r,t[3]=m*s+g*r,t[4]=h*s-i*r,t[5]=b*s-c*r,t[6]=f*s-o*r,t[7]=g*s-m*r,t}function va(t,e){const n=e[0],r=e[1],s=e[2],i=e[3],c=n+n,o=r+r,m=s+s,h=n*c,b=r*c,f=r*o,g=s*c,M=s*o,G=s*m,p=i*c,_=i*o,X=i*m;return t[0]=1-f-G,t[1]=b+X,t[2]=g-_,t[3]=0,t[4]=b-X,t[5]=1-h-G,t[6]=M+p,t[7]=0,t[8]=g+_,t[9]=M-p,t[10]=1-h-f,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Ca(t,e,n,r,s,i,c){const o=1/(n-e),m=1/(s-r),h=1/(i-c);return t[0]=i*2*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i*2*m,t[6]=0,t[7]=0,t[8]=(n+e)*o,t[9]=(s+r)*m,t[10]=(c+i)*h,t[11]=-1,t[12]=0,t[13]=0,t[14]=c*i*2*h,t[15]=0,t}function Oa(t,e,n,r,s){const i=1/Math.tan(e/2);if(t[0]=i/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,s!=null&&s!==1/0){const c=1/(r-s);t[10]=(s+r)*c,t[14]=2*s*r*c}else t[10]=-1,t[14]=-2*r;return t}const za=Oa;function $a(t,e,n,r,s,i,c){const o=1/(e-n),m=1/(r-s),h=1/(i-c);return t[0]=-2*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*m,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*h,t[11]=0,t[12]=(e+n)*o,t[13]=(s+r)*m,t[14]=(c+i)*h,t[15]=1,t}const Ga=$a;function ka(t,e,n,r){let s,i,c,o,m,h,b,f,g,M;const G=e[0],p=e[1],_=e[2],X=r[0],ee=r[1],w=r[2],z=n[0],W=n[1],Y=n[2];return Math.abs(G-z)<tn&&Math.abs(p-W)<tn&&Math.abs(_-Y)<tn?Ma(t):(f=G-z,g=p-W,M=_-Y,s=1/Math.sqrt(f*f+g*g+M*M),f*=s,g*=s,M*=s,i=ee*M-w*g,c=w*f-X*M,o=X*g-ee*f,s=Math.sqrt(i*i+c*c+o*o),s?(s=1/s,i*=s,c*=s,o*=s):(i=0,c=0,o=0),m=g*o-M*c,h=M*i-f*o,b=f*c-g*i,s=Math.sqrt(m*m+h*h+b*b),s?(s=1/s,m*=s,h*=s,b*=s):(m=0,h=0,b=0),t[0]=i,t[1]=m,t[2]=f,t[3]=0,t[4]=c,t[5]=h,t[6]=g,t[7]=0,t[8]=o,t[9]=b,t[10]=M,t[11]=0,t[12]=-(i*G+c*p+o*_),t[13]=-(m*G+h*p+b*_),t[14]=-(f*G+g*p+M*_),t[15]=1,t)}function Va(){const t=new _t(4);return _t!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function Xa(t,e,n){const r=e[0],s=e[1],i=e[2],c=e[3];return t[0]=n[0]*r+n[4]*s+n[8]*i+n[12]*c,t[1]=n[1]*r+n[5]*s+n[9]*i+n[13]*c,t[2]=n[2]*r+n[6]*s+n[10]*i+n[14]*c,t[3]=n[3]*r+n[7]*s+n[11]*i+n[15]*c,t}(function(){const t=Va();return function(e,n,r,s,i,c){let o,m;for(n||(n=4),r||(r=0),s?m=Math.min(s*n+r,e.length):m=e.length,o=r;o<m;o+=n)t[0]=e[o],t[1]=e[o+1],t[2]=e[o+2],t[3]=e[o+3],i(t,t,c),e[o]=t[0],e[o+1]=t[1],e[o+2]=t[2],e[o+3]=t[3];return e}})();var Fn;(function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL0ROW3=3]="COL0ROW3",t[t.COL1ROW0=4]="COL1ROW0",t[t.COL1ROW1=5]="COL1ROW1",t[t.COL1ROW2=6]="COL1ROW2",t[t.COL1ROW3=7]="COL1ROW3",t[t.COL2ROW0=8]="COL2ROW0",t[t.COL2ROW1=9]="COL2ROW1",t[t.COL2ROW2=10]="COL2ROW2",t[t.COL2ROW3=11]="COL2ROW3",t[t.COL3ROW0=12]="COL3ROW0",t[t.COL3ROW1=13]="COL3ROW1",t[t.COL3ROW2=14]="COL3ROW2",t[t.COL3ROW3=15]="COL3ROW3"})(Fn||(Fn={}));const Wa=45*Math.PI/180,Ya=1,_n=.1,gn=500,ja=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class He extends Fa{static get IDENTITY(){return qa()}static get ZERO(){return Ha()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return Fn}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,n,r,s,i,c,o,m,h,b,f,g,M,G,p,_){return this[0]=e,this[1]=n,this[2]=r,this[3]=s,this[4]=i,this[5]=c,this[6]=o,this[7]=m,this[8]=h,this[9]=b,this[10]=f,this[11]=g,this[12]=M,this[13]=G,this[14]=p,this[15]=_,this.check()}setRowMajor(e,n,r,s,i,c,o,m,h,b,f,g,M,G,p,_){return this[0]=e,this[1]=i,this[2]=h,this[3]=M,this[4]=n,this[5]=c,this[6]=b,this[7]=G,this[8]=r,this[9]=o,this[10]=f,this[11]=p,this[12]=s,this[13]=m,this[14]=g,this[15]=_,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(ja)}fromObject(e){return this.check()}fromQuaternion(e){return va(this,e),this.check()}frustum(e){const{left:n,right:r,bottom:s,top:i,near:c=_n,far:o=gn}=e;return o===1/0?Ka(this,n,r,s,i,c):Ca(this,n,r,s,i,c,o),this.check()}lookAt(e){const{eye:n,center:r=[0,0,0],up:s=[0,1,0]}=e;return ka(this,n,r,s),this.check()}ortho(e){const{left:n,right:r,bottom:s,top:i,near:c=_n,far:o=gn}=e;return Ga(this,n,r,s,i,c,o),this.check()}orthographic(e){const{fovy:n=Wa,aspect:r=Ya,focalDistance:s=1,near:i=_n,far:c=gn}=e;Vr(n);const o=n/2,m=s*Math.tan(o),h=m*r;return this.ortho({left:-h,right:h,bottom:-m,top:m,near:i,far:c})}perspective(e){const{fovy:n=45*Math.PI/180,aspect:r=1,near:s=.1,far:i=500}=e;return Vr(n),za(this,n,r,s,i),this.check()}determinant(){return Ua(this)}getScale(e=[-0,-0,-0]){return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(e=[-0,-0,-0]){return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const r=this.getScale(n),s=1/r[0],i=1/r[1],c=1/r[2];return e[0]=this[0]*s,e[1]=this[1]*i,e[2]=this[2]*c,e[3]=0,e[4]=this[4]*s,e[5]=this[5]*i,e[6]=this[6]*c,e[7]=0,e[8]=this[8]*s,e[9]=this[9]*i,e[10]=this[10]*c,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const r=this.getScale(n),s=1/r[0],i=1/r[1],c=1/r[2];return e[0]=this[0]*s,e[1]=this[1]*i,e[2]=this[2]*c,e[3]=this[4]*s,e[4]=this[5]*i,e[5]=this[6]*c,e[6]=this[8]*s,e[7]=this[9]*i,e[8]=this[10]*c,e}transpose(){return Sa(this,this),this.check()}invert(){return Pa(this,this),this.check()}multiplyLeft(e){return kr(this,e,this),this.check()}multiplyRight(e){return kr(this,this,e),this.check()}rotateX(e){return Ba(this,this,e),this.check()}rotateY(e){return Da(this,this,e),this.check()}rotateZ(e){return La(this,this,e),this.check()}rotateXYZ(e){return this.rotateX(e[0]).rotateY(e[1]).rotateZ(e[2])}rotateAxis(e,n){return wa(this,this,e,n),this.check()}scale(e){return Na(this,this,Array.isArray(e)?e:[e,e,e]),this.check()}translate(e){return Ia(this,this,e),this.check()}transform(e,n){return e.length===4?(n=Xa(n||[-0,-0,-0,-0],e,this),yn(n,4),n):this.transformAsPoint(e,n)}transformAsPoint(e,n){const{length:r}=e;let s;switch(r){case 2:s=ha(n||[-0,-0],e,this);break;case 3:s=Jr(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return yn(s,e.length),s}transformAsVector(e,n){let r;switch(e.length){case 2:r=Ea(n||[-0,-0],e,this);break;case 3:r=Qr(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return yn(r,e.length),r}transformPoint(e,n){return this.transformAsPoint(e,n)}transformVector(e,n){return this.transformAsPoint(e,n)}transformDirection(e,n){return this.transformAsVector(e,n)}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,n,r){return this.identity().translate([e,n,r])}}let Zt,Qt;function Ha(){return Zt||(Zt=new He([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(Zt)),Zt}function qa(){return Qt||(Qt=new He,Object.freeze(Qt)),Qt}function Vr(t){if(t>Math.PI*2)throw Error("expected radians")}function Ka(t,e,n,r,s,i){const c=2*i/(n-e),o=2*i/(s-r),m=(n+e)/(n-e),h=(s+r)/(s-r),b=-1,f=-1,g=-2*i;return t[0]=c,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=m,t[9]=h,t[10]=b,t[11]=f,t[12]=0,t[13]=0,t[14]=g,t[15]=0,t}const Xr=t=>{const e=t.clientWidth,n=t.clientHeight;return t.width!==e||t.height!==n?(t.width=e,t.height=n,!0):!1},Wr=(t,e,n)=>{const r=t.createShader(t.VERTEX_SHADER);if(!r)throw new Error("Vertex shader could not be created.");if(t.shaderSource(r,e),t.compileShader(r),!t.getShaderParameter(r,t.COMPILE_STATUS))throw new Error("Vertex shader could not be compiled."+t.getShaderInfoLog(r));const s=t.createShader(t.FRAGMENT_SHADER);if(!s)throw new Error("Fragment shader could not be created.");if(t.shaderSource(s,n),t.compileShader(s),!t.getShaderParameter(s,t.COMPILE_STATUS))throw new Error("Fragment shader could not be compiled."+t.getShaderInfoLog(s));const i=t.createProgram();if(t.attachShader(i,r),t.attachShader(i,s),t.linkProgram(i),!t.getProgramParameter(i,t.LINK_STATUS))throw new Error("Shader program could not be linked.");return i},Za=`#version 300 es\r
precision highp float;\r
\r
layout(location=0) in vec3 aPosition;\r
layout(location=1) in vec3 aNormal;\r
uniform mat4 uModelView;\r
uniform mat4 uProjection;\r
\r
out vec3 v_position;\r
out vec3 v_normal;\r
\r
void main() {\r
    // multiply the vertex position by the matrix to get the final \r
    // point in normalized screen coordinates\r
    gl_Position = uProjection * uModelView *  vec4(aPosition,1.0);\r
    v_position = aPosition;\r
    v_normal = aNormal;\r
    \r
}\r
`,Qa=`#version 300 es\r
precision highp float;\r
\r
in vec3 v_position;\r
in vec3 v_normal;\r
\r
uniform vec3 u_lightDirection;\r
uniform vec3 lightPosition;\r
uniform float u_limit;          // in dot space\r
\r
uniform sampler2D uTexture;\r
uniform sampler2D uFloor;\r
uniform sampler2D uCeiling;\r
uniform bool uFlashlight;\r
\r
out vec4 fColor;\r
\r
void main() {\r
  vec3 normal = normalize(v_normal);\r
 \r
  vec3 surfaceToLightDirection = normalize(-lightPosition - v_position);\r
  float light = 0.0;\r
 \r
  float distance = length(-lightPosition - v_position)*2.;\r
  float dotFromDirection = dot(surfaceToLightDirection,-u_lightDirection);\r
  if (uFlashlight && dotFromDirection >= u_limit) {\r
    light = pow(dot(normal, surfaceToLightDirection),.5);\r
  }\r
  light = max(light,0.01);\r
  vec2 uv = v_position.xy;\r
  if(abs(normal.y)<0.01){\r
      if(normal.x!=0.)\r
          uv.x = v_position.z;\r
      fColor  = texture(uTexture,uv);\r
  } else{\r
    if(normal.y>0.)\r
        fColor = texture(uFloor,v_position.xz);\r
    if(v_normal.y<0.)\r
        fColor = texture(uCeiling,v_position.zx);\r
        }\r
    fColor.rgb *= min(light/distance,1.);\r
   \r
}`,Ja=`#version 300 es\r
precision highp float;\r
\r
layout(location=0) in vec3 aPosition;\r
uniform mat4 uModelView;\r
uniform mat4 uProjection;\r
uniform mat4 uPosition;\r
uniform mat4 uRotation;\r
\r
out vec3 v_position;\r
out vec3 rPosition;\r
\r
void main() {\r
    gl_Position = uProjection * uModelView * uPosition * uRotation * vec4(aPosition,1.0);\r
    v_position = aPosition;\r
    rPosition =  (uPosition * uRotation * vec4(aPosition,1.0)).xyz;\r
}\r
`,ec=`#version 300 es\r
precision highp float;\r
\r
in vec3 v_position;\r
in vec3 rPosition;\r
\r
uniform samplerCube uTexture;\r
uniform vec3 lightPosition;\r
uniform vec3 u_lightDirection;\r
uniform float u_limit;          // in dot space\r
uniform bool uFlashlight;\r
\r
out vec4 fColor;\r
\r
void main() {\r
    vec2 uv = vec2(0);\r
    vec3 position = normalize(v_position);\r
    // Convert normalized XYZ to spherical coordinates\r
    float theta = acos(position.z);\r
    float phi = atan(position.y, position.x);\r
\r
        // Map spherical coordinates to UV coordinates\r
    uv.x = (phi+ 3.14159) / (2.0 * 3.14159); // Normalize phi to range [0, 1]\r
    uv.y = theta / 3.14159;        // Normalize theta to range [0, 1]\r
    fColor = texture(uTexture,position);\r
\r
    vec3 surfaceToLightDirection = normalize(-lightPosition - rPosition);\r
    float dotFromDirection = dot(surfaceToLightDirection,-u_lightDirection);\r
    if (uFlashlight && dotFromDirection >= u_limit) {\r
        fColor.w = 0.;\r
    }\r
}`;/* @license twgl.js 5.5.4 Copyright (c) 2015, Gregg Tavares All Rights Reserved.
Available via the MIT license.
see: http://github.com/greggman/twgl.js for details */const Yr=new Map;function tc(t,e){if(!t||typeof t!="object")return!1;let n=Yr.get(e);n||(n=new WeakMap,Yr.set(e,n));let r=n.get(t);if(r===void 0){const s=Object.prototype.toString.call(t);r=s.substring(8,s.length-1)===e,n.set(t,r)}return r}function es(t,e){return typeof WebGLTexture<"u"&&tc(e,"WebGLTexture")}function ts(t){return!!t.texStorage2D}const rn=33984,nc=35718,rc=5126,sc=35664,ic=35665,oc=35666,ac=5124,cc=35667,uc=35668,fc=35669,lc=35670,mc=35671,hc=35672,Ec=35673,dc=35674,bc=35675,Tc=35676,xc=35678,Ac=35680,pc=35679,yc=35682,Rc=35685,_c=35686,gc=35687,Fc=35688,Mc=35689,Sc=35690,Pc=36289,Uc=36292,Ic=36293,Nc=5125,wc=36294,Bc=36295,Dc=36296,Lc=36298,vc=36299,Cc=36300,Oc=36303,zc=36306,$c=36307,Gc=36308,kc=36311,sn=3553,on=34067,Sn=32879,an=35866,te={};function ns(t,e){return te[e].bindPoint}function Vc(t,e){return function(n){t.uniform1f(e,n)}}function Xc(t,e){return function(n){t.uniform1fv(e,n)}}function Wc(t,e){return function(n){t.uniform2fv(e,n)}}function Yc(t,e){return function(n){t.uniform3fv(e,n)}}function jc(t,e){return function(n){t.uniform4fv(e,n)}}function rs(t,e){return function(n){t.uniform1i(e,n)}}function ss(t,e){return function(n){t.uniform1iv(e,n)}}function is(t,e){return function(n){t.uniform2iv(e,n)}}function os(t,e){return function(n){t.uniform3iv(e,n)}}function as(t,e){return function(n){t.uniform4iv(e,n)}}function Hc(t,e){return function(n){t.uniform1ui(e,n)}}function qc(t,e){return function(n){t.uniform1uiv(e,n)}}function Kc(t,e){return function(n){t.uniform2uiv(e,n)}}function Zc(t,e){return function(n){t.uniform3uiv(e,n)}}function Qc(t,e){return function(n){t.uniform4uiv(e,n)}}function Jc(t,e){return function(n){t.uniformMatrix2fv(e,!1,n)}}function eu(t,e){return function(n){t.uniformMatrix3fv(e,!1,n)}}function tu(t,e){return function(n){t.uniformMatrix4fv(e,!1,n)}}function nu(t,e){return function(n){t.uniformMatrix2x3fv(e,!1,n)}}function ru(t,e){return function(n){t.uniformMatrix3x2fv(e,!1,n)}}function su(t,e){return function(n){t.uniformMatrix2x4fv(e,!1,n)}}function iu(t,e){return function(n){t.uniformMatrix4x2fv(e,!1,n)}}function ou(t,e){return function(n){t.uniformMatrix3x4fv(e,!1,n)}}function au(t,e){return function(n){t.uniformMatrix4x3fv(e,!1,n)}}function Oe(t,e,n,r){const s=ns(t,e);return ts(t)?function(i){let c,o;!i||es(t,i)?(c=i,o=null):(c=i.texture,o=i.sampler),t.uniform1i(r,n),t.activeTexture(rn+n),t.bindTexture(s,c),t.bindSampler(n,o)}:function(i){t.uniform1i(r,n),t.activeTexture(rn+n),t.bindTexture(s,i)}}function ze(t,e,n,r,s){const i=ns(t,e),c=new Int32Array(s);for(let o=0;o<s;++o)c[o]=n+o;return ts(t)?function(o){t.uniform1iv(r,c),o.forEach(function(m,h){t.activeTexture(rn+c[h]);let b,f;!m||es(t,m)?(b=m,f=null):(b=m.texture,f=m.sampler),t.bindSampler(n,f),t.bindTexture(i,b)})}:function(o){t.uniform1iv(r,c),o.forEach(function(m,h){t.activeTexture(rn+c[h]),t.bindTexture(i,m)})}}te[rc]={Type:Float32Array,size:4,setter:Vc,arraySetter:Xc};te[sc]={Type:Float32Array,size:8,setter:Wc,cols:2};te[ic]={Type:Float32Array,size:12,setter:Yc,cols:3};te[oc]={Type:Float32Array,size:16,setter:jc,cols:4};te[ac]={Type:Int32Array,size:4,setter:rs,arraySetter:ss};te[cc]={Type:Int32Array,size:8,setter:is,cols:2};te[uc]={Type:Int32Array,size:12,setter:os,cols:3};te[fc]={Type:Int32Array,size:16,setter:as,cols:4};te[Nc]={Type:Uint32Array,size:4,setter:Hc,arraySetter:qc};te[wc]={Type:Uint32Array,size:8,setter:Kc,cols:2};te[Bc]={Type:Uint32Array,size:12,setter:Zc,cols:3};te[Dc]={Type:Uint32Array,size:16,setter:Qc,cols:4};te[lc]={Type:Uint32Array,size:4,setter:rs,arraySetter:ss};te[mc]={Type:Uint32Array,size:8,setter:is,cols:2};te[hc]={Type:Uint32Array,size:12,setter:os,cols:3};te[Ec]={Type:Uint32Array,size:16,setter:as,cols:4};te[dc]={Type:Float32Array,size:32,setter:Jc,rows:2,cols:2};te[bc]={Type:Float32Array,size:48,setter:eu,rows:3,cols:3};te[Tc]={Type:Float32Array,size:64,setter:tu,rows:4,cols:4};te[Rc]={Type:Float32Array,size:32,setter:nu,rows:2,cols:3};te[_c]={Type:Float32Array,size:32,setter:su,rows:2,cols:4};te[gc]={Type:Float32Array,size:48,setter:ru,rows:3,cols:2};te[Fc]={Type:Float32Array,size:48,setter:ou,rows:3,cols:4};te[Mc]={Type:Float32Array,size:64,setter:iu,rows:4,cols:2};te[Sc]={Type:Float32Array,size:64,setter:au,rows:4,cols:3};te[xc]={Type:null,size:0,setter:Oe,arraySetter:ze,bindPoint:sn};te[Ac]={Type:null,size:0,setter:Oe,arraySetter:ze,bindPoint:on};te[pc]={Type:null,size:0,setter:Oe,arraySetter:ze,bindPoint:Sn};te[yc]={Type:null,size:0,setter:Oe,arraySetter:ze,bindPoint:sn};te[Pc]={Type:null,size:0,setter:Oe,arraySetter:ze,bindPoint:an};te[Uc]={Type:null,size:0,setter:Oe,arraySetter:ze,bindPoint:an};te[Ic]={Type:null,size:0,setter:Oe,arraySetter:ze,bindPoint:on};te[Lc]={Type:null,size:0,setter:Oe,arraySetter:ze,bindPoint:sn};te[vc]={Type:null,size:0,setter:Oe,arraySetter:ze,bindPoint:Sn};te[Cc]={Type:null,size:0,setter:Oe,arraySetter:ze,bindPoint:on};te[Oc]={Type:null,size:0,setter:Oe,arraySetter:ze,bindPoint:an};te[zc]={Type:null,size:0,setter:Oe,arraySetter:ze,bindPoint:sn};te[$c]={Type:null,size:0,setter:Oe,arraySetter:ze,bindPoint:Sn};te[Gc]={Type:null,size:0,setter:Oe,arraySetter:ze,bindPoint:on};te[kc]={Type:null,size:0,setter:Oe,arraySetter:ze,bindPoint:an};function cu(t){const e=t.name;return e.startsWith("gl_")||e.startsWith("webgl_")}const uu=/(\.|\[|]|\w+)/g,fu=t=>t>="0"&&t<="9";function lu(t,e,n,r){const s=t.split(uu).filter(o=>o!=="");let i=0,c="";for(;;){const o=s[i++];c+=o;const m=fu(o[0]),h=m?parseInt(o):o;if(m&&(c+=s[i++]),i===s.length){n[h]=e;break}else{const f=s[i++],g=f==="[",M=n[h]||(g?[]:{});n[h]=M,n=M,r[c]=r[c]||function(G){return function(p){cs(G,p)}}(M),c+=f}}}function jr(t,e){let n=0;function r(o,m,h){const b=m.name.endsWith("[0]"),f=m.type,g=te[f];if(!g)throw new Error(`unknown type: 0x${f.toString(16)}`);let M;if(g.bindPoint){const G=n;n+=m.size,b?M=g.arraySetter(t,f,G,h,m.size):M=g.setter(t,f,G,h,m.size)}else g.arraySetter&&b?M=g.arraySetter(t,h):M=g.setter(t,h);return M.location=h,M}const s={},i={},c=t.getProgramParameter(e,nc);for(let o=0;o<c;++o){const m=t.getActiveUniform(e,o);if(cu(m))continue;let h=m.name;h.endsWith("[0]")&&(h=h.substr(0,h.length-3));const b=t.getUniformLocation(e,m.name);if(b){const f=r(e,m,b);s[h]=f,lu(h,f,i,s)}}return s}function cs(t,e){for(const n in e){const r=t[n];typeof r=="function"?r(e[n]):cs(t[n],e[n])}}function Pn(t,...e){const n=t.uniformSetters||t,r=e.length;for(let s=0;s<r;++s){const i=e[s];if(Array.isArray(i)){const c=i.length;for(let o=0;o<c;++o)Pn(n,i[o])}else for(const c in i){const o=n[c];o&&o(i[c])}}}(function(t){typeof define=="function"&&define.amd?define(t):t()})(function(){function t(a){return a.startsWith("gl_")||a.startsWith("webgl_")}function e(a){return!!a.texImage3D}function n(a){return a&&a.buffer&&a.buffer instanceof ArrayBuffer}function r(a){return Array.isArray(a)||a instanceof Float32Array||a instanceof Float64Array}function s(a){return a?`"${a}"`:""}const i={};function c(a,x){const y=[];if(x.length){for(let F=0;F<x.length;++F)x.push(b(x[F]));return"["+y.join(", ")+"]"}return y.toString()}function o(a){return function(x,y){let F=0;const N=[];for(let C=0;C<a.length;++C){const k=i[a[C]];y&k&&(F|=k,N.push(b(k)))}return F===y?N.join(" | "):b(y)}}const m=new Map;function h(a){for(const x in a){const y=a[x];typeof y=="number"&&(m.has(y)||m.set(y,new Set),m.get(y).add(x))}}function b(a){const x=m.get(a);return x?[...x.keys()].map(y=>`${y}`).join(" | "):`/*UNKNOWN WebGL ENUM*/ ${typeof a=="number"?`0x${a.toString(16)}`:a}`}const f=5126,g=35664,M=35665,G=35666,p=5124,_=35667,X=35668,ee=35669,w=35670,z=35671,W=35672,Y=35673,me=35674,ue=35675,q=35676,K=35678,ie=35680,oe=35679,ae=35682,Z=35685,Ee=35686,we=35687,Me=35688,Ge=35689,fs=35690,ls=36289,ms=36292,hs=36293,Nt=5125,In=36294,Nn=36295,wn=36296,Es=36298,ds=36299,bs=36300,Ts=36303,xs=36306,As=36307,ps=36308,ys=36311,Rs=new Map([[f,{size:1,name:"float"}],[g,{size:2,name:"vec2"}],[M,{size:3,name:"vec3"}],[G,{size:4,name:"vec4"}],[p,{size:1,name:"int"}],[_,{size:2,name:"ivec2"}],[X,{size:3,name:"ivec3"}],[ee,{size:4,name:"ivec4"}],[Nt,{size:1,name:"uint"}],[In,{size:2,name:"uvec2"}],[Nn,{size:3,name:"uvec3"}],[wn,{size:4,name:"uvec4"}],[w,{size:1,name:"bool"}],[z,{size:2,name:"bvec2"}],[W,{size:3,name:"bvec3"}],[Y,{size:4,name:"bvec4"}],[me,{size:4,name:"mat2"}],[ue,{size:9,name:"mat3"}],[q,{size:16,name:"mat4"}],[Z,{size:6,name:"mat2x3"}],[Ee,{size:8,name:"mat2x4"}],[we,{size:6,name:"mat3x2"}],[Me,{size:12,name:"mat3x4"}],[Ge,{size:8,name:"mat4x2"}],[fs,{size:12,name:"mat4x3"}],[K,{size:1,name:"sampler2D"}],[ie,{size:1,name:"samplerCube"}],[oe,{size:1,name:"sampler3D"}],[ae,{size:1,name:"sampler2DShadow"}],[ls,{size:1,name:"sampler2DArray"}],[ms,{size:1,name:"sampler2DArrayShadow"}],[hs,{size:1,name:"samplerCubeShadow"}],[Es,{size:1,name:"isampler2D"}],[ds,{size:1,name:"isampler3D"}],[bs,{size:1,name:"isamplerCube"}],[Ts,{size:1,name:"isampler2DArray"}],[xs,{size:1,name:"usampler2D"}],[As,{size:1,name:"usampler3D"}],[ps,{size:1,name:"usamplerCube"}],[ys,{size:1,name:"usampler2DArray"}]]);function gt(a){return Rs.get(a)}const _s=32873,gs=34068,Fs=32874,Ms=35869,Ss=34962,Ps=34963,Us=34964,Is=34965,Ns=3553,ws=32879,Bs=35866,Ds=34067,Ls=36160,vs=36161,Bn=36006,Cs=36007,Os=35982,zs=35983,$s=36009,Gs=36008,ks=36010,Vs=35345,Xs=35368,Ws=36386,Ys=36389,js=new Map([[Ss,Us],[Ps,Is],[Ns,_s],[Ds,gs],[ws,Fs],[Bs,Ms],[vs,Cs],[Ls,Bn],[$s,Bn],[Gs,ks],[Vs,Xs],[Os,zs],[Ws,Ys]]);function Dn(a){return js.get(a)}const Hs=5120,qs=5122,Ln=5121,vn=5123,Ks=new Map([[w,1],[Hs,1],[Ln,1],[qs,2],[vn,2],[p,4],[Nt,4],[f,4]]);function Cn(a){return Ks.get(a)||0}const Zs=new Map([[Ln,Uint8Array],[vn,Uint16Array],[Nt,Uint32Array]]);function Qs(a){return Zs.get(a)}const On={drawArrays(a,x,y){return{startOffset:x,vertCount:y,instances:1}},drawElements(a,x,y,F){return{startOffset:F,vertCount:x,instances:1,indexType:y}},drawArraysInstanced(a,x,y,F){return{startOffset:x,vertCount:y,instances:F}},drawElementsInstanced(a,x,y,F,N){return{startOffset:F,vertCount:x,instances:N,indexType:y}},drawArraysInstancedANGLE(a,x,y,F){return{startOffset:x,vertCount:y,instances:F}},drawElementsInstancedANGLE(a,x,y,F,N){return{startOffset:F,vertCount:x,instances:N,indexType:y}},drawRangeElements(a,x,y,F,N,C){return{startOffset:C,vertCount:F,instances:1,indexType:N}}};function zn(a,x){return On[a](...x)}function cn(a){return!!On[a]}const Js=new Map([[f,{size:4}],[g,{size:8}],[M,{size:12}],[G,{size:16}],[p,{size:4}],[_,{size:8}],[X,{size:12}],[ee,{size:16}],[Nt,{size:4}],[In,{size:8}],[Nn,{size:12}],[wn,{size:16}],[w,{size:4}],[z,{size:8}],[W,{size:12}],[Y,{size:16}],[me,{size:4,count:2}],[ue,{size:9,count:3}],[q,{size:16,count:4}]]);function ei(a){return Js.get(a)}const it=a=>a?new WeakRef(a):null,ot=(a,x)=>{const y=a==null?void 0:a.deref();return!!y!=!!x?!1:y?y===x:!0};function $n(a,x){return a==="undefined"?x:a}const ti=35070;function ni(a,x){return a+x-1}function ri(a,x,y,F,N,C,k,O,V){const D=a.getParameter(a.ELEMENT_ARRAY_BUFFER_BINDING);if(!D){V.push("No ELEMENT_ARRAY_BUFFER bound");return}const Q=Cn(C),de=a.getBufferParameter(a.ELEMENT_ARRAY_BUFFER,a.BUFFER_SIZE),_e=y+F*Q;if(_e>de){V.push(`offset: ${y} and count: ${F} with index type: ${b(C)} passed to ${x} are out of range for current ELEMENT_ARRAY_BUFFER.
Those parameters require ${_e} bytes but the current ELEMENT_ARRAY_BUFFER ${k(D)} only has ${de} bytes`);return}const Pe=O(D),ge=Qs(C),Ue=new ge(Pe,y);let xe=Ue[0];for(let nt=1;nt<F;++nt)xe=Math.max(xe,Ue[nt]);return xe}function si(a,x,y,F,N){const{vertCount:C,startOffset:k,indexType:O,instances:V}=zn(x,y);if(C<=0||V<=0)return[];const D=a.getParameter(a.CURRENT_PROGRAM),Q=[],de=O?ri(a,x,k,C,V,O,F,N,Q):ni(k,C);if(Q.length)return Q;const _e=e(a)||a.getExtension("ANGLE_instanced_arrays"),Pe=a.getProgramParameter(D,a.ACTIVE_ATTRIBUTES),ge=a.getParameter(a.ARRAY_BUFFER_BINDING);for(let Ue=0;Ue<Pe;++Ue){const{name:xe,type:nt}=a.getActiveAttrib(D,Ue);if(t(xe))continue;const Qe=a.getAttribLocation(D,xe),{count:dt}={count:1,...ei(nt)};for(let ne=0;ne<dt;++ne){const be=Qe+ne;if(!a.getVertexAttrib(be,a.VERTEX_ATTRIB_ARRAY_ENABLED))continue;const Be=a.getVertexAttrib(be,a.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING);if(!Be){Q.push(`no buffer bound to attribute (${xe}) location: ${Qe}`);continue}const v=a.getVertexAttrib(be,a.VERTEX_ATTRIB_ARRAY_SIZE),$=a.getVertexAttrib(be,a.VERTEX_ATTRIB_ARRAY_TYPE),U=Cn($)*v,P=a.getVertexAttribOffset(be,a.VERTEX_ATTRIB_ARRAY_POINTER),L=a.getVertexAttrib(be,a.VERTEX_ATTRIB_ARRAY_STRIDE),J=L||U,j=_e?a.getVertexAttrib(be,ti):0;a.bindBuffer(a.ARRAY_BUFFER,Be);const fe=a.getBufferParameter(a.ARRAY_BUFFER,a.BUFFER_SIZE),re=j>0?((V+j-1)/j|0)-1:de,se=P+re*J+U;se>fe&&Q.push(`${F(Be)} assigned to attribute ${be} used as attribute '${xe}' in current program is too small for draw parameters.
index of highest vertex accessed: ${re}
attribute size: ${v}, type: ${b($)}, stride: ${L}, offset: ${P}, divisor: ${j}
needs ${se} bytes for draw but buffer is only ${fe} bytes`)}}return a.bindBuffer(a.ARRAY_BUFFER,ge),Q}const Gn=35678,kn=35680,Vn=35679,Xn=35682,Wn=36289,Yn=36292,jn=36293,ii=36298,oi=36299,ai=36300,ci=36303,ui=36306,fi=36307,li=36308,mi=36311,wt=new Map([[Gn,{uniformType:"sampler2D",numberType:"float/normalized",bindPoint:"2D"}],[kn,{uniformType:"samplerCube",numberType:"float/normalized",bindPoint:"CUBE"}],[Vn,{uniformType:"sampler3D",numberType:"float/normalized",bindPoint:"3D"}],[Xn,{uniformType:"sampler2D",numberType:"float/normalized",bindPoint:"2D"}],[Wn,{uniformType:"sampler2DArray",numberType:"float/normalized",bindPoint:"2D_ARRAY"}],[Yn,{uniformType:"sampler2DArray",numberType:"float/normalized",bindPoint:"2D_ARRAY"}],[jn,{uniformType:"samplerCube",numberType:"float/normalized",bindPoint:"CUBE"}],[ii,{uniformType:"isampler2D",numberType:"int",bindPoint:"2D"}],[oi,{uniformType:"isampler3D",numberType:"int",bindPoint:"3D"}],[ai,{uniformType:"isamplerCube",numberType:"int",bindPoint:"CUBE"}],[ci,{uniformType:"isampler2DArray",numberType:"int",bindPoint:"2D_ARRAY"}],[ui,{uniformType:"usampler2D",numberType:"unsigned int",bindPoint:"2D"}],[fi,{uniformType:"usampler3D",numberType:"unsigned int",bindPoint:"3D"}],[li,{uniformType:"usamplerCube",numberType:"unsigned int",bindPoint:"CUBE"}],[mi,{uniformType:"usampler2DArray",numberType:"unsigned int",bindPoint:"2D_ARRAY"}]]);function hi(a){return wt.get(a).bindPoint}function Bt(a){return wt.has(a)}function Ei(a){return wt.get(a).numberType}function Hn(a){return wt.get(a).uniformType}const di=3553,bi=32879,Ti=35866,xi=34067,Ai=34069,pi=34070,yi=34071,Ri=34072,_i=34073,gi=34074,Fi=new Map([[di,"2D"],[bi,"3D"],[xi,"CUBE"],[Ai,"CUBE"],[pi,"CUBE"],[yi,"CUBE"],[Ri,"CUBE"],[_i,"CUBE"],[gi,"CUBE"],[Ti,"2D_ARRAY"]]);function qn(a){return Fi.get(a)}const Kn=32873,Zn=34068,Mi=32874,Qn=35869,Si=new Map([[Gn,Kn],[Xn,Kn],[Vn,Mi],[Wn,Qn],[Yn,Qn],[kn,Zn],[jn,Zn]]);function Pi(a,x,y){a.activeTexture(a.TEXTURE0+x);const F=Si.get(y);return a.getParameter(F)}const Ui=36063;function Ii(a){return!e(a)&&!a.getExtension("WEBGL_draw_buffers")?1:a.getParameter(Ui)}function Dt(a,x,y){if(a.getFramebufferAttachmentParameter(a.FRAMEBUFFER,x,a.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE)===a.NONE)return;const N=a.getFramebufferAttachmentParameter(a.FRAMEBUFFER,x,a.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME);N instanceof WebGLTexture&&(y.has(N)||y.set(N,[]),y.get(N).push(x))}function Ni(a,x){const y=a.getParameter(a.FRAMEBUFFER_BINDING);if(!y)return[];const F=Ii(a),N=new Map;for(let D=0;D<F;++D)Dt(a,a.COLOR_ATTACHMENT0+D,N);Dt(a,a.DEPTH_ATTACHMENT,N),Dt(a,a.STENCIL_ATTACHMENT,N),e(a)||Dt(a,a.DEPTH_STENCIL_ATTACHMENT,N);const C=a.getParameter(a.ACTIVE_TEXTURE),k=a.getParameter(a.CURRENT_PROGRAM),O=a.getProgramParameter(k,a.ACTIVE_UNIFORMS),V=[];for(let D=0;D<O;++D){const{name:Q,type:de,size:_e}=a.getActiveUniform(k,D);if(!(t(Q)||!Bt(de)))if(_e>1){const Pe=Q.substr(-3)==="[0]"?Q.substr(0,Q.length-3):Q;for(let ge=0;ge<_e;++ge)V.push(...Jn(a,y,N,k,`${Pe}[${ge}]`,de,x))}else V.push(...Jn(a,y,N,k,Q,de,x))}return a.activeTexture(C),V}function Jn(a,x,y,F,N,C,k){const O=a.getUniformLocation(F,N),V=a.getUniform(F,O),D=Pi(a,V,C),Q=y.get(D);return Q?[`${k(D)} on uniform: ${N} bound to texture unit ${V} is also attached to ${k(x)} on attachment: ${Q.map(de=>b(de)).join(", ")}`]:[]}function wi(){const a=navigator.userAgent;let x=a.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];if(/trident/i.test(x[1]))return x=/\brv[ :]+(\d+)/g.exec(a)||[],{name:"IE",version:x[1]};if(x[1]==="Chrome"){const F=a.match(/\b(OPR|Edge)\/(\d+)/);if(F)return{name:F[1].replace("OPR","Opera"),version:F[2]}}x=x[2]?[x[1],x[2]]:[navigator.appName,navigator.appVersion,"-?"];const y=a.match(/version\/(\d+)/i);return y&&x.splice(1,1,y[1]),{name:x[0],version:x[1]}}const Bi=function(){const a=wi();let x,y;return/chrome|opera/i.test(a.name)?(x=3,y=function(F){const N=/at ([^(]+)*\(*(.*?):(\d+):(\d+)/.exec(F);if(N){let C=N[1],k=N[2];const O=parseInt(N[3]),V=parseInt(N[4]);return k===""&&(k=C,C=""),{url:k,lineNo:O,colNo:V,funcName:C}}}):/firefox|safari/i.test(a.name)&&(x=2,y=function(F){const N=/@(.*?):(\d+):(\d+)/.exec(F);if(N){const C=N[1],k=parseInt(N[2]),O=parseInt(N[3]);return{url:C,lineNo:k,colNo:O}}}),function(N){if(y)try{const C=N.split(`
`);return y(C[x])}catch{}}}();function Di(a){const x=[],y=a.getParameter(a.MAX_COMBINED_TEXTURE_IMAGE_UNITS);for(let F=0;F<y;++F)x.push(new Map);return x}const Li=33984,un=3553,fn=32879,at=34067,Lt=34069,er=34070,tr=34071,nr=34072,rr=34073,sr=34074,ir=10241,or=10240,vt=33084,ar=33085,cr=10242,ur=10243,fr=10497,lr=35866,Ct=33071,ln=9728,mr=9729,vi=9986,Ci=new Map([[9,function([a,x,y,F,N,,C,k]){return{target:a,level:x,internalFormat:y,width:F,height:N,format:C,type:k}}],[6,function([a,x,y,F,N,C]){return{target:a,level:x,internalFormat:y,width:C.width,height:C.height,format:F,type:N}}],[10,function([a,x,y,F,N,,C,k]){return{target:a,level:x,internalFormat:y,width:F,height:N,format:C,type:k}}]]),Ot=6406,We=6407,Ye=6408,zt=6409,$t=6410,mn=6402,hr=34041,Er=new Set([Ot,zt,$t,We,Ye]);function Ft(a,x){return Er.has(a)?`${b(a)}/${b(x)}`:b(a)}const dr=new Map([[un,0],[fn,0],[lr,0],[at,0],[Lt,0],[er,1],[tr,2],[nr,3],[rr,4],[sr,5]]);function hn(a,x){return x===at?`(${b(Lt+a)})`:""}const Oi=[un],zi=[Lt,er,tr,nr,rr,sr],$i=33321,Gi=36756,br=33325,Tr=33326,ki=33330,Vi=33329,Xi=33338,Wi=33337,Yi=33340,ji=33339,Hi=33323,qi=36757,xr=33327,Ar=33328,Ki=33336,Zi=33335,Qi=33332,Ji=33331,eo=33334,to=33333,no=32849,ro=35905,so=36194,io=36758,oo=35898,ao=35901,pr=34843,yr=34837,co=36221,uo=36239,fo=36215,lo=36233,mo=36209,ho=36227,Eo=32856,bo=35907,To=36759,xo=32855,Ao=32854,po=32857,Rr=34842,_r=34836,yo=36220,Ro=36238,_o=36975,go=36214,Fo=36232,Mo=36226,So=36208,Po=33189,Uo=33190,Io=36012,No=36013,wo=35056,ct=5120,Se=5121,Gt=5122,Mt=5123,kt=5124,xt=5125,ke=5126,gr=32819,Fr=32820,Mr=33635,ut=5131,Sr=36193,En=33640,Bo=35899,Do=35902,Lo=36269,vo=34042,Vt=33319,At=33320,Xt=6403,pt=36244,yt=36248,Et=36249;function Co(){const a=new Map([[Ot,{textureFormat:Ot,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1,2,2,4],type:[Se]}],[zt,{textureFormat:zt,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1,2,2,4],type:[Se]}],[$t,{textureFormat:$t,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[2,4,4,8],type:[Se]}],[We,{textureFormat:We,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3,6,6,12,2],type:[Se,Mr]}],[Ye,{textureFormat:Ye,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,8,8,16,2,2],type:[Se,gr,Fr]}],[$i,{textureFormat:Xt,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1],type:[Se]}],[Gi,{textureFormat:Xt,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[1],type:[ct]}],[br,{textureFormat:Xt,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[4,2],type:[ke,ut]}],[Tr,{textureFormat:Xt,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[4],type:[ke]}],[ki,{textureFormat:pt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[1],type:[Se]}],[Vi,{textureFormat:pt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[1],type:[ct]}],[Qi,{textureFormat:pt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[Mt]}],[Ji,{textureFormat:pt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[Gt]}],[eo,{textureFormat:pt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[xt]}],[to,{textureFormat:pt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[kt]}],[Hi,{textureFormat:Vt,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[2],type:[Se]}],[qi,{textureFormat:Vt,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[2],type:[ct]}],[xr,{textureFormat:Vt,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[8,4],type:[ke,ut]}],[Ar,{textureFormat:Vt,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[8],type:[ke]}],[Ki,{textureFormat:At,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[Se]}],[Zi,{textureFormat:At,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[ct]}],[Xi,{textureFormat:At,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Mt]}],[Wi,{textureFormat:At,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Gt]}],[Yi,{textureFormat:At,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[xt]}],[ji,{textureFormat:At,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[kt]}],[no,{textureFormat:We,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3],type:[Se]}],[ro,{textureFormat:We,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[3],type:[Se]}],[so,{textureFormat:We,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3,2],type:[Se,Mr]}],[io,{textureFormat:We,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[3],type:[ct]}],[oo,{textureFormat:We,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6,4],type:[ke,ut,Bo]}],[ao,{textureFormat:We,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6,4],type:[ke,ut,Do]}],[pr,{textureFormat:We,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6],type:[ke,ut]}],[yr,{textureFormat:We,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[ke]}],[co,{textureFormat:yt,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[3],type:[Se]}],[uo,{textureFormat:yt,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[3],type:[ct]}],[fo,{textureFormat:yt,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[6],type:[Mt]}],[lo,{textureFormat:yt,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[6],type:[Gt]}],[mo,{textureFormat:yt,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[xt]}],[ho,{textureFormat:yt,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[kt]}],[Eo,{textureFormat:Ye,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[Se]}],[bo,{textureFormat:Ye,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[Se]}],[To,{textureFormat:Ye,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[4],type:[ct]}],[xo,{textureFormat:Ye,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,2,4],type:[Se,Fr,En]}],[Ao,{textureFormat:Ye,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,2],type:[Se,gr]}],[po,{textureFormat:Ye,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[En]}],[Rr,{textureFormat:Ye,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[16,8],type:[ke,ut]}],[_r,{textureFormat:Ye,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[16],type:[ke]}],[yo,{textureFormat:Et,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Se]}],[Ro,{textureFormat:Et,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[ct]}],[_o,{textureFormat:Et,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[En]}],[go,{textureFormat:Et,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[Mt]}],[Fo,{textureFormat:Et,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[Gt]}],[Mo,{textureFormat:Et,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[16],type:[kt]}],[So,{textureFormat:Et,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[16],type:[xt]}],[Po,{textureFormat:mn,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[2,4],type:[Mt,xt]}],[Uo,{textureFormat:mn,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[xt]}],[Io,{textureFormat:mn,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[ke]}],[wo,{textureFormat:hr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[vo]}],[No,{textureFormat:hr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Lo]}]]);a.forEach(y=>{y.bytesPerElementMap={},y.bytesPerElement.forEach(function(F,N){const C=y.type[N];y.bytesPerElementMap[C]=F})});const x=new Map;return a.forEach((y,F)=>{Er.has(F)?y.type.forEach(N=>{x.set(Ft(F,N),y)}):x.set(Ft(F),y)}),{textureInternalFormatInfoMap:a,internalFormatStringToFormatInfoMap:x}}function Wt(a){return(a&a-1)===0}function dn(a,x=0,y=0){return(Math.log2(Math.max(a,x,y))|0)+1}function Yt(a,...x){return a?x:[]}function Pr(a,x){return[...Yt(!Wt(a),`width(${a}) is not a power of 2`),...Yt(!Wt(x),`height(${x}) is not a power of 2`)].join(" and ")}function Oo(a,x){return[...Yt(a!==Ct,`TEXTURE_WRAP_S (${b(a)}) is not CLAMP_TO_EDGE`),...Yt(x!==Ct,`TEXTURE_WRAP_T (${b(x)}) is not CLAMP_TO_EDGE`)].join(" and ")}function zo(a){const x=b(a);return x.endsWith("UI")?"unsigned int":x.endsWith("I")?"int":"float/normalized"}function Ur(a,x,y,F){return a===un||a===at?`${x}x${y}`:`${x}x${y}x${F}`}class $o{constructor(x,y){this.redundantStateSetting=y;const F=e(x),N=!F,C=new Set,k=new Map,O=new Map,V=Di(x),D=dn(x.getParameter(x.MAX_TEXTURE_SIZE)),{internalFormatStringToFormatInfoMap:Q}=Co();let de=0,_e=V[0];this.numTextureUnits=V.length;function Pe(v){v.notRenderable=Ue(v,v.parameters)}function ge(){k.forEach(Pe)}function Ue(v,$){const{type:U,mips:P}=v,L=$.get(vt)||0,J=$n($.get(ar),D);if(J<L)return`TEXTURE_MAX_LEVEL(${J}) is less than TEXTURE_BASE_LEVEL(${L})`;const j=P[L];if(!j)return"no base level mip ${baseLevel}";const fe=j[0];if(!fe)return"TEXTURE_CUBE_MAP_POSITIVE_X face does not exist";const{width:re,height:se,depth:Ie,internalFormatString:Ae}=fe,$e=U===at?6:1,Ne=$.get(ir),ft=Q.get(Ae);if(ft&&!ft.textureFilterable){if(Ne!==ln)return`texture of type (${Ae}) is not filterable but TEXTURE_MIN_FILTER is set to ${b(Ne)}`;{const Le=$.get(or);if(Le!==ln)return`texture of type (${Ae}) is not filterable but TEXTURE_MAG_FILTER is set to ${b(Le)}`}}const Je=Ne===mr||Ne===ln?1:dn(re,se,Ie);{let Fe=re,Le=se,et=Ie;const qe=Math.min(J,L+Je-1);for(let Te=L;Te<=qe;++Te){const bt=P[Te];if(!bt)return`filtering is set to use mips from level ${L} to ${qe} with (TEXTURE_MIN_FILTER = ${b(Ne)}) but mip level ${Te} does not exist`;for(let lt=0;lt<$e;++lt){const Ke=bt[lt];if(!Ke)return`filtering is set to use mips level ${L} to ${qe} with (TEXTURE_MIN_FILTER = ${b(Ne)}) but mip level ${Te}${hn(lt,U)} does not exist`;if(Ke.width!==Fe||Ke.height!==Le||Ke.depth!==et)return`mip level ${Te}${hn(lt,U)} needs to be ${Ur(U,Fe,Le,et)} but it is ${Ur(U,Ke.width,Ke.height,Ke.depth)}`;if(Ke.internalFormatString!==Ae)return`mip level ${Te}${hn(lt,U)}'s internal format ${Ke.internalFormatString} does not match mip level ${L}'s internal format ${Ae}`}Fe=Math.max(1,Fe/2|0),Le=Math.max(1,Le/2|0),U!==lr&&(et=Math.max(1,et/2|0))}}if(N&&(!Wt(re)||!Wt(se))){if(Je>1)return`texture's ${Pr(re,se)} but TEXTURE_MIN_FILTER (${b(Ne)}) is set to need mips`;const Fe=$.get(cr),Le=$.get(ur);if(Fe!==Ct||Le!==Ct)return`texture's ${Pr(re,se)} but ${Oo(Fe,Le)}.`}if(U===at&&re!==se)return`texture is CUBE_MAP but dimensions ${re}x${se} are not square`}function xe(v){const $=qn(v),U=_e.get($);return k.get(U)}function nt(v,$){const U=xe(v),P=dr.get(v);return U.mips[$][P]}function Qe(v,$,U){const P=xe(v);P.parameters.set($,U),Pe(P)}function dt(v,$){for(let U=0;U<V.length;++U){const P=V[U];P.get(v)===$&&P.set(v,null)}}function ne(v){const{mips:$,parameters:U}=v,P=U.get(vt)||0,L=$[P];if(!L)return"";const J=L[0];return J?J.internalFormatString:""}function be(v,$){const U=C.has($);[Ye,We,zt,$t,Ot].forEach(P=>{Q.set(Ft(P,v),{textureFormat:x.RGBA,textureFilterable:U})})}function Ht(v){for(const $ of v){const U=Q.get(Ft($));U.textureFilterable=!0}}this.addExtension=function(v){switch(C.add(v),v){case"oes_texture_float":be(ke,"oes_texture_float_linear");break;case"oes_texture_float_linear":F?Ht([Tr,Ar,yr,_r]):C.has("oes_texture_float")&&be(ke,"oes_texture_float_linear"),ge();break;case"oes_texture_half_float":be(ut,"oes_texture_half_float_linear"),be(Sr,"oes_texture_half_float_linear");break;case"oes_texture_half_float_linear":F?Ht([br,xr,pr,Rr]):C.has("oes_texture_half_float")&&(be(ut,"oes_texture_half_float_linear"),be(Sr,"oes_texture_half_float_linear")),ge();break;default:return}},this.getTextureForTextureUnit=function(v,$){return V[v].get($)},this.getTextureUnitUnrenderableReason=function(v,$,U,P){const L=V[$].get(U);if(!L)return`no texture bound to texture unit ${$} ${U}`;const J=k.get(L),{mips:j,parameters:fe}=J,re=fe.get(vt)||0,se=j[re];if(!se)return`no mip level ${re}`;const Ie=se[0];if(!Ie)return`TEXTURE_CUBE_MAP_POSITIVE_X face at mip level ${re} does not exist`;const Ae=zo(Ie.internalFormat),$e=Ei(v);if(Ae!==$e)return`uniform ${Hn(v)} needs a ${$e} texture but ${P(L)} on texture unit ${$} is ${Ae} texture (${ne(J)})`;const Ne=V[$].get("SAMPLER");if(Ne){const ft=O.get(Ne),Je=Ue(J,ft);return Je&&`${Je} with sampler ${P(Ne)} bound to texture unit ${$}`}else return J.notRenderable};function Be(v,$,U,P,L,J,j=0){const fe=Ft(U,j),re=xe(v),{mips:se}=re;se[$]||(se[$]=[]);const Ie=dr.get(v);se[$][Ie]={width:P,height:L,depth:J,internalFormatString:fe,internalFormat:U,type:j},Pe(re)}this.postChecks={activeTexture(v,$,U){de=U[0]-Li,_e=V[de]},bindTexture(v,$,U){const[P,L]=U,J=qn(P);if(_e.get(J)===L)++y.bindTexture;else if(_e.set(J,L),L){const j=k.get(L);if(j.type){if(j.type!==P)throw new Error("should never get here")}else j.type=P}},createTexture(v,$,U,P){const L={mips:[],parameters:new Map([[ir,vi],[or,mr],[cr,fr],[ur,fr]]),renderable:!1};k.set(P,L)},deleteTexture(v,$,U){const[P]=U,{type:L}=k.get(P);k.delete(P),dt(L,P)},createSampler(v,$,U,P){O.set(P,new Map)},deleteSampler(v,$,U){const[P]=U;O.delete(P),dt("SAMPLER",P)},bindSampler(v,$,U){const[P,L]=U;L===V[P].get("SAMPLER")?++y.bindSampler:V[P].set("SAMPLER",L)},samplerParameteri(v,$,U){const[P,L,J]=U;O.get(P).set(L,J)},copyTexImage2D(v,$,U){const[P,L,J,j,fe]=U,re=v.UNSIGNED_BYTE;Be(P,L,J,j,fe,1,re)},texImage2D(v,$,U){const P=Ci.get(U.length),{target:L,level:J,internalFormat:j,width:fe,height:re,type:se}=P(U);Be(L,J,j,fe,re,1,se)},texImage3D(v,$,U){const[P,L,J,j,fe,re,,,se]=U;Be(P,L,J,j,fe,re,se)},texStorage2D(v,$,U){const[P,L,J,j,fe]=U;let re=j,se=fe;const Ie=P===at?zi:Oi;for(let Ae=0;Ae<L;++Ae){for(const $e of Ie)Be($e,Ae,J,re,se,1);re=Math.max(1,re/2|0),se=Math.max(1,se/2|0)}},texStorage3D(v,$,U){const[P,L,J,j,fe,re]=U;let se=j,Ie=fe,Ae=re;for(let $e=0;$e<L;++$e)Be(P,$e,J,se,Ie,Ae),se=Math.max(1,se/2|0),Ie=Math.max(1,Ie/2|0),P===fn&&(Ae=Math.max(1,Ae/2|0))},generateMipmap(v,$,U){const[P]=U,L=xe(P),{parameters:J}=L,j=J.get(vt)||0,fe=$n(J.get(ar),D),re=nt(P,j),{width:se,height:Ie,depth:Ae,internalFormat:$e,type:Ne}=re,ft=Math.min(dn(se,Ie,Ae),fe+1-j),Je=P===at?6:1;let Fe=se,Le=Ie,et=Ae;for(let qe=0;qe<ft;++qe){Fe=Math.max(1,Fe/2|0),Le=Math.max(1,Le/2|0),P===fn&&(et=Math.max(1,et/2|0));for(let Te=0;Te<Je;++Te){const bt=P===at?Lt+Te:P;Be(bt,j+qe,$e,Fe,Le,et,Ne)}}},compressedTexImage2D(v,$,U){const[P,L,J,j,fe]=U;Be(P,L,J,j,fe,1)},compressedTexImage3D(v,$,U){const[P,L,J,j,fe,re]=U;Be(P,L,J,j,fe,re)},texParameteri(v,$,U){const[P,L,J]=U;Qe(P,L,J)}}}}class Ir{constructor(x){this.elementAttribArray=null,this.attribs=[];for(let y=0;y<x;++y)this.attribs.push({size:0,type:0,normalize:!1,stride:0,offset:0,divisor:0,buffer:null,iPointer:!1})}setElementArrayBuffer(x,y){ot(this.elementAttribArray,y)?++x.bindBuffer:this.elementAttribArray=it(y)}setAttrib(x,y,F,N,C,k,O,V,D){const Q=this.attribs[F];ot(Q.buffer,D)&&Q.iPointer===y&&Q.size===N&&Q.type===C&&Q.normalize===k&&Q.stride===O&&Q.offset===V?++x.vertexAttribPointer:Object.assign(Q,{iPointer:y,size:N,type:C,normalize:k,stride:O,offset:V,buffer:it(D)})}}class Go{constructor(x,y){this.gl=x,this.redundantStateSetting=y,this.numAttribs=x.getParameter(x.MAX_VERTEX_ATTRIBS),this.vertexArrays=new WeakMap,this.defaultVertexArray=new Ir(this.numAttribs),this.currentVertexArray=this.defaultVertexArray;const F=(k,O,V,D)=>{this.vertexArrays.set(D,new Ir(this.numAttribs))},N=(k,O,V)=>{const[D]=V,Q=this.vertexArrays.get(D);this.currentVertexArray===Q&&(this.currentVertexArray=this.defaultVertexArray),this.vertexArrays.delete(D)},C=(k,O,V)=>{let[D]=V;D=D?this.vertexArrays.get(D):this.defaultVertexArray,D===this.currentVertexArray?++this.redundantStateSetting.bindVertexArray:this.currentVertexArray=D};this.postChecks={createVertexArray:F,createVertexArrayOES:F,bindVertexArray:C,bindVertexArrayOES:C,bindBuffer:(k,O,V)=>{const[D,Q]=V;D===x.ELEMENT_ARRAY_BUFFER&&this.currentVertexArray.setElementArrayBuffer(this.redundantStateSetting,Q)},deleteVertexArray:N,deleteVertexArrayOES:N,vertexAttribPointer:(k,O,V)=>{const[D,Q,de,_e,Pe,ge]=V,Ue=this.gl;this.currentVertexArray.setAttrib(this.redundantStateSetting,!1,D,Q,de,_e,Pe,ge,Ue.getParameter(Ue.ARRAY_BUFFER_BINDING))},vertexAttribIPointer:(k,O,V)=>{const[D,Q,de,_e,Pe]=V,ge=this.gl;this.currentVertexArray.setAttrib(this.redundantStateSetting,!0,D,Q,de,!1,_e,Pe,ge.getParameter(ge.ARRAY_BUFFER_BINDING))}}}}const Nr=o(["COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","STENCIL_BUFFER_BIT"]);function jt(a,x){Array.isArray(a[x])&&(a[x]=Object.fromEntries(a[x].map(y=>[Math.abs(y),y])))}function ko(a,x,y,F){const N=y[0],C=F.locationsToNamesMap.get(N),k=a.getParameter(a.CURRENT_PROGRAM),O=[];if(C&&O.push(`trying to set uniform '${C}'`),k){const V=F.webglObjectToNamesMap.get(k);V&&O.push(`on WebGLProgram(${s(V)})`)}else O.push("on ** no current program **");return O.length?`: ${O.join(" ")}`:""}function wr(a){if(Array.isArray(a)||n(a)||typeof a!="object")throw new Error("not a WebGLObject")}function Vo(){return{elementArrayBuffer:null,vertexAttribs:[]}}const bn=new Set,Br={useProgram:0,bindBuffer:0,bindFramebuffer:0,bindRenderbuffer:0,bindSampler:0,bindTexture:0,bindVertexArray:0,enableDisable:0,vertexAttribPointer:0};function Dr(a,x,y={}){if(bn.has(a))return a;bn.add(a);const F=y.origGLErrorFn||a.getError;h(a);function N(u){const E=Vo(),l={...Br},d={};for(const R in u){const S=u[R];d[R]=typeof S=="function"?function(...I){return S.call(u,...I)}:S}const A={baseContext:u,config:y,apis:{gman_debug_helper:{ctx:{tagObject(R,S){wr(R),A.webglObjectToNamesMap.set(R,S)},untagObject(R){wr(R),A.webglObjectToNamesMap.delete(R)},getTagForObject(R){return A.webglObjectToNamesMap.get(R)},disable(){P()},setConfiguration(R){for(const[S,I]of Object.entries(R)){if(!(S in A.config))throw new Error(`unknown configuration option: ${S}`);A.config[S]=I}for(const S of A.config.ignoreUniforms)A.ignoredUniforms.add(S)},getAndResetRedundantCallInfo(){const R={...l};if(Object.assign(l,Br),this._checksRemoved)for(const S of Object.keys(R))R[S]="invalid is webgl-lint is no longer running. maxDrawCalls exceeded";return R}}}},idCounts:{},textureManager:new $o(d,l),vertexArrayManager:new Go(d,l),bufferToIndices:new Map,ignoredUniforms:new Set,locationsToNamesMap:new Map,webglObjectToNamesMap:new Map,programToUnsetUniformsMap:new Map,programToUniformInfoMap:new Map,programToLocationsMap:new Map,programToUniformSamplerValues:new Map,defaultVertexArray:E,webglState:{currentProgram:null,buffers:{},currentReadFramebuffer:null,currentDrawFramebuffer:null,currentRenderbuffer:null,textureUnits:[],enabled:{}},redundantStateSetting:l};return A}const C=y.sharedState||N(a);y.sharedState=C;const{apis:k,baseContext:O,bufferToIndices:V,config:D,ignoredUniforms:Q,locationsToNamesMap:de,programToLocationsMap:_e,programToUniformInfoMap:Pe,programToUniformSamplerValues:ge,programToUnsetUniformsMap:Ue,textureManager:xe,vertexArrayManager:nt,webglObjectToNamesMap:Qe,idCounts:dt,webglState:ne,redundantStateSetting:be}=C;({oes_texture_float(...u){xe.addExtension(...u)},oes_texture_float_linear(...u){xe.addExtension(...u)},OES_texture_half_float(...u){xe.addExtension(...u)},oes_texture_half_float_linear(...u){xe.addExtension(...u)}}[x]||J)(x);const Be={enable:{1:{enums:[0]}},disable:{1:{enums:[0]}},getParameter:{1:{enums:[0]}},drawArrays:{3:{enums:[0],numbers:[1,2]}},drawElements:{4:{enums:[0,2],numbers:[1,3]}},drawArraysInstanced:{4:{enums:[0],numbers:[1,2,3]}},drawElementsInstanced:{5:{enums:[0,2],numbers:[1,3,4]}},drawRangeElements:{6:{enums:[0,4],numbers:[1,2,3,5]}},createShader:{1:{enums:[0]}},getActiveAttrib:{2:{numbers:[1]}},getActiveUniform:{2:{numbers:[1]}},getShaderParameter:{2:{enums:[1]}},getProgramParameter:{2:{enums:[1]}},getShaderPrecisionFormat:{2:{enums:[0,1]}},bindAttribLocation:{3:{numbers:[1]}},getVertexAttrib:{2:{enums:[1],numbers:[0]}},vertexAttribPointer:{6:{enums:[2],numbers:[0,1,4,5]}},vertexAttribIPointer:{5:{enums:[2],numbers:[0,1,3,4]}},vertexAttribDivisor:{2:{numbers:[0,1]}},disableVertexAttribArray:{1:{numbers:[0]}},enableVertexAttribArray:{1:{numbers:[0]}},bindTexture:{2:{enums:[0],undef:[1]}},activeTexture:{1:{enums:[0,1]}},getTexParameter:{2:{enums:[0,1]}},texParameterf:{3:{enums:[0,1]}},texParameteri:{3:{enums:[0,1,2]}},texImage2D:{9:{enums:[0,2,6,7],numbers:[1,3,4,5],arrays:[-8]},6:{enums:[0,2,3,4]},10:{enums:[0,2,6,7],numbers:[1,3,4,5,9],arrays:{8:Ko}}},texImage3D:{10:{enums:[0,2,7,8],numbers:[1,3,4,5]},11:{enums:[0,2,7,8],numbers:[1,3,4,5,10],arrays:{9:xn}}},texSubImage2D:{9:{enums:[0,6,7],numbers:[1,2,3,4,5]},7:{enums:[0,4,5],numbers:[1,2,3]},10:{enums:[0,6,7],numbers:[1,2,3,4,5,9],arrays:{9:xn}}},texSubImage3D:{11:{enums:[0,8,9],numbers:[1,2,3,4,5,6,7]},12:{enums:[0,8,9],numbers:[1,2,3,4,5,6,7,11],arrays:{10:xn}}},texStorage2D:{5:{enums:[0,2],numbers:[1,3,4]}},texStorage3D:{6:{enums:[0,2],numbers:[1,3,4,6]}},copyTexImage2D:{8:{enums:[0,2],numbers:[1,3,4,5,6,7]}},copyTexSubImage2D:{8:{enums:[0],numbers:[1,2,3,4,5,6,7]}},copyTexSubImage3D:{9:{enums:[0],numbers:[1,2,3,4,5,6,7,8]}},generateMipmap:{1:{enums:[0]}},compressedTexImage2D:{7:{enums:[0,2],numbers:[1,3,4,5]},8:{enums:[0,2],numbers:[1,3,4,5,7]},9:{enums:[0,2],numbers:[1,3,4,5,7,8]}},compressedTexSubImage2D:{8:{enums:[0,6],numbers:[1,2,3,4,5]},9:{enums:[0,6],numbers:[1,2,3,4,5,8]},10:{enums:[0,6],numbers:[1,2,3,4,5,8,9]}},compressedTexImage3D:{8:{enums:[0,2],numbers:[1,3,4,5,6]},9:{enums:[0,2],numbers:[1,3,4,5,6,-7,8]},10:{enums:[0,2],numbers:[1,3,4,5,6,8,9]}},compressedTexSubImage3D:{12:{enums:[0,8],numbers:[1,2,3,4,5,6,7,8,10,11]},11:{enums:[0,8],numbers:[1,2,3,4,5,6,7,8,-9,10]},10:{enums:[0,8],numbers:[1,2,3,4,5,6,7,8]}},bindBuffer:{2:{enums:[0],undef:[1]}},bufferData:{3:{enums:[0,2],numbers:[-1],arrays:[-1]},4:{enums:[0,2],numbers:[-1,3],arrays:{1:Or}},5:{enums:[0,2],numbers:[-1,3,4],arrays:{1:zr}}},bufferSubData:{3:{enums:[0],numbers:[1],arrays:{2:qo}},4:{enums:[0],numbers:[1,3],arrays:{2:Or}},5:{enums:[0],numbers:[1,3,4],arrays:{2:zr}}},copyBufferSubData:{5:{enums:[0],numbers:[2,3,4]}},getBufferParameter:{2:{enums:[0,1]}},getBufferSubData:{3:{enums:[0],numbers:[1]},4:{enums:[0],numbers:[1,3]},5:{enums:[0],numbers:[1,3,4]}},pixelStorei:{2:{enums:[0,1],numbers:[1]}},readPixels:{7:{enums:[4,5],numbers:[0,1,2,3,-6]},8:{enums:[4,5],numbers:[0,1,2,3,7]}},bindRenderbuffer:{2:{enums:[0],undef:[1]}},bindFramebuffer:{2:{enums:[0],undef:[1]}},blitFramebuffer:{10:{enums:{8:Nr,9:!0},numbers:[0,1,2,3,4,5,6,7]}},checkFramebufferStatus:{1:{enums:[0]}},framebufferRenderbuffer:{4:{enums:[0,1,2]}},framebufferTexture2D:{5:{enums:[0,1,2],numbers:[4]}},framebufferTextureLayer:{5:{enums:[0,1],numbers:[3,4]}},getFramebufferAttachmentParameter:{3:{enums:[0,1,2]}},getInternalformatParameter:{3:{enums:[0,1,2]}},getRenderbufferParameter:{2:{enums:[0,1]}},invalidateFramebuffer:{2:{enums:{0:!0,1:c}}},invalidateSubFramebuffer:{6:{enums:{0:!0,1:c},numbers:[2,3,4,5]}},readBuffer:{1:{enums:[0]}},renderbufferStorage:{4:{enums:[0,1],numbers:[2,3]}},renderbufferStorageMultisample:{5:{enums:[0,2],numbers:[1,3,4]}},bindVertexBuffer:{1:{undef:[1]}},bindVertexBufferOES:{1:{undef:[1]}},lineWidth:{1:{numbers:[0]}},polygonOffset:{2:{numbers:[0,1]}},scissor:{4:{numbers:[0,1,2,3]}},viewport:{4:{numbers:[0,1,2,3]}},clear:{1:{enums:{0:Nr}}},clearColor:{4:{numbers:[0,1,2,3]}},clearDepth:{1:{numbers:[0]}},clearStencil:{1:{numbers:[0]}},depthFunc:{1:{enums:[0]}},depthRange:{2:{numbers:[0,1]}},blendColor:{4:{numbers:[0,1,2,3]}},blendFunc:{2:{enums:[0,1]}},blendFuncSeparate:{4:{enums:[0,1,2,3]}},blendEquation:{1:{enums:[0]}},blendEquationSeparate:{2:{enums:[0,1]}},stencilFunc:{3:{enums:[0],numbers:[1,2]}},stencilFuncSeparate:{4:{enums:[0,1],numberS:[2,3]}},stencilMask:{1:{numbers:[0]}},stencilMaskSeparate:{2:{enums:[0],numbers:[1]}},stencilOp:{3:{enums:[0,1,2]}},stencilOpSeparate:{4:{enums:[0,1,2,3]}},cullFace:{1:{enums:[0]}},frontFace:{1:{enums:[0]}},drawArraysInstancedANGLE:{4:{enums:[0],numbers:[1,2,3]}},drawElementsInstancedANGLE:{5:{enums:[0,2],numbers:[1,3,4]}},blendEquationEXT:{1:{enums:[0]}},drawBuffersWebGL:{1:{enums:{0:c},arrays:[0]}},drawBuffers:{1:{enums:{0:c},arrays:[0]}},clearBufferfv:{3:{enums:[0],numbers:[1],arrays:[2]},4:{enums:[0],numbers:[1,3],arrays:[2]}},clearBufferiv:{3:{enums:[0],numbers:[1],arrays:[2]},4:{enums:[0],numbers:[1,3],arrays:[2]}},clearBufferuiv:{3:{enums:[0],numbers:[1],arrays:[2]},4:{enums:[0],numbers:[1,3],arrays:[2]}},clearBufferfi:{4:{enums:[0],numbers:[1,2,3]}},uniform1f:{2:{numbers:[1]}},uniform2f:{3:{numbers:[1,2]}},uniform3f:{4:{numbers:[1,2,3]}},uniform4f:{5:{numbers:[1,2,3,4]}},uniform1i:{2:{numbers:[1]}},uniform2i:{3:{numbers:[1,2]}},uniform3i:{4:{numbers:[1,2,3]}},uniform4i:{5:{numbers:[1,2,3,4]}},uniform1fv:{2:{arrays:{1:Re(1)}},3:{arrays:{1:ye(1)},numbers:[2]},4:{arrays:{1:pe(1)},numbers:[2,3]}},uniform2fv:{2:{arrays:{1:Re(2)}},3:{arrays:{1:ye(2)},numbers:[2]},4:{arrays:{1:pe(2)},numbers:[2,3]}},uniform3fv:{2:{arrays:{1:Re(3)}},3:{arrays:{1:ye(3)},numbers:[2]},4:{arrays:{1:pe(3)},numbers:[2,3]}},uniform4fv:{2:{arrays:{1:Re(4)}},3:{arrays:{1:ye(4)},numbers:[2]},4:{arrays:{1:pe(4)},numbers:[2,3]}},uniform1iv:{2:{arrays:{1:Re(1)}},3:{arrays:{1:ye(1)},numbers:[2]},4:{arrays:{1:pe(1)},numbers:[2,3]}},uniform2iv:{2:{arrays:{1:Re(2)}},3:{arrays:{1:ye(2)},numbers:[2]},4:{arrays:{1:pe(2)},numbers:[2,3]}},uniform3iv:{2:{arrays:{1:Re(3)}},3:{arrays:{1:ye(3)},numbers:[2]},4:{arrays:{1:pe(3)},numbers:[2,3]}},uniform4iv:{2:{arrays:{1:Re(4)}},3:{arrays:{1:ye(4)},numbers:[2]},4:{arrays:{1:pe(4)},numbers:[2,3]}},uniformMatrix2fv:{3:{arrays:{2:Re(4)}},4:{arrays:{2:ye(4)},numbers:[3]},5:{arrays:{2:pe(4)},numbers:[3,4]}},uniformMatrix3fv:{3:{arrays:{2:Re(9)}},4:{arrays:{2:ye(9)},numbers:[3]},5:{arrays:{2:pe(9)},numbers:[3,4]}},uniformMatrix4fv:{3:{arrays:{2:Re(16)}},4:{arrays:{2:ye(16)},numbers:[3]},5:{arrays:{2:pe(16)},numbers:[3,4]}},uniform1ui:{2:{numbers:[1]}},uniform2ui:{3:{numbers:[1,2]}},uniform3ui:{4:{numbers:[1,2,3]}},uniform4ui:{5:{numbers:[1,2,3,4]}},uniform1uiv:{2:{arrays:{1:Re(1)}},3:{arrays:{1:ye(1)},numbers:[2]},4:{arrays:{1:pe(1)},numbers:[2,3]}},uniform2uiv:{2:{arrays:{1:Re(2)}},3:{arrays:{1:ye(2)},numbers:[2]},4:{arrays:{1:pe(2)},numbers:[2,3]}},uniform3uiv:{2:{arrays:{1:Re(3)}},3:{arrays:{1:ye(3)},numbers:[2]},4:{arrays:{1:pe(3)},numbers:[2,3]}},uniform4uiv:{2:{arrays:{1:Re(4)}},3:{arrays:{1:ye(4)},numbers:[2]},4:{arrays:{1:pe(4)},numbers:[2,3]}},uniformMatrix3x2fv:{3:{arrays:{2:Re(6)}},4:{arrays:{2:ye(6)},numbers:[3]},5:{arrays:{2:pe(6)},numbers:[3,4]}},uniformMatrix4x2fv:{3:{arrays:{2:Re(8)}},4:{arrays:{2:ye(8)},numbers:[3]},5:{arrays:{2:pe(8)},numbers:[3,4]}},uniformMatrix2x3fv:{3:{arrays:{2:Re(6)}},4:{arrays:{2:ye(6)},numbers:[3]},5:{arrays:{2:pe(6)},numbers:[3,4]}},uniformMatrix4x3fv:{3:{arrays:{2:Re(12)}},4:{arrays:{2:ye(12)},numbers:[3]},5:{arrays:{2:pe(12)},numbers:[3,4]}},uniformMatrix2x4fv:{3:{arrays:{2:Re(8)}},4:{arrays:{2:ye(8)},numbers:[3]},5:{arrays:{2:pe(8)},numbers:[3,4]}},uniformMatrix3x4fv:{3:{arrays:{2:Re(12)}},4:{arrays:{2:ye(12)},numbers:[3]},5:{arrays:{2:pe(12)},numbers:[3,4]}},vertexAttrib1f:{2:{numbers:[0,1]}},vertexAttrib2f:{3:{numbers:[0,1,2]}},vertexAttrib3f:{4:{numbers:[0,1,2,3]}},vertexAttrib4f:{5:{numbers:[0,1,2,3,4]}},vertexAttrib1fv:{2:{numbers:[0],arrays:[1]}},vertexAttrib2fv:{2:{numbers:[0],arrays:[1]}},vertexAttrib3fv:{2:{numbers:[0],arrays:[1]}},vertexAttrib4fv:{2:{numbers:[0],arrays:[1]}},vertexAttribI4i:{5:{numbers:[0,1,2,3,4]}},vertexAttribI4iv:{2:{numbers:[0],arrays:[1]}},vertexAttribI4ui:{5:{numbers:[0,1,2,3,4]}},vertexAttribI4uiv:{2:{numbers:[0],arrays:[1]}},beginQuery:{2:{enums:[0]}},endQuery:{1:{enums:[0]}},getQuery:{2:{enums:[0,1]}},getQueryParameter:{2:{enums:[1]}},samplerParameteri:{3:{enums:[1]}},samplerParameterf:{3:{enums:[1]}},getSamplerParameter:{2:{enums:[1]}},clientWaitSync:{3:{enums:{1:o(["SYNC_FLUSH_COMMANDS_BIT"])},numbers:[2]}},fenceSync:{2:{enums:[0]}},getSyncParameter:{2:{enums:[1]}},bindTransformFeedback:{2:{enums:[0],undef:[1]}},beginTransformFeedback:{1:{enums:[0]}},bindBufferBase:{3:{enums:[0],numbers:[1]}},bindBufferRange:{5:{enums:[0],numbers:[1,3,4]}},getIndexedParameter:{2:{enums:[0],numbers:[1]}},getActiveUniforms:{3:{enums:[2]},arrays:[1]},getActiveUniformBlockParameter:{3:{enums:[2],numbers:[1]}},getActiveUniformBlockName:{2:{numbers:[1]}},transformFeedbackVaryings:{3:{enums:[2]}},uniformBlockBinding:{3:{numbers:[1,2]}}};for(const[u,E]of Object.entries(Be)){for(const l of Object.values(E))jt(l,"enums"),jt(l,"numbers"),jt(l,"arrays"),jt(l,"undef");/uniform(\d|Matrix)/.test(u)&&(E.errorHelper=ko)}const v={},$={};function U(u){const E=_e.get(u);E&&E.forEach(l=>de.delete(l)),_e.set(u,new Set),Ue.delete(u),Pe.delete(u),ge.delete(u)}function P(){for(const{ctx:u,origFuncs:E}of Object.values(k))Object.assign(u,E),bn.delete(u);C.apis.gman_debug_helper._checksRemoved=!0;for(const u of[...Object.keys(C)])delete C[u]}function L(u,E,l){const{vertCount:d,instances:T}=zn(E,l);d===0&&console.warn(qt(u,E,l,`count for ${E} is 0!`)),T===0&&console.warn(qt(u,E,l,`instanceCount for ${E} is 0!`)),--D.maxDrawCalls,D.maxDrawCalls===0&&P()}function J(){}function j(u){return function(E,l,d,T){if(D.makeDefaultTags){const A=(dt[u]||0)+1;dt[u]=A,Qe.set(T,`*UNTAGGED:${u}${A}*`)}}}function fe(u){const E=Bi(new Error().stack),l=E?`${E.url}:${E.lineNo}: ${u}`:u;if(D.throwOnError)throw new Error(l);console.error(l)}function re(u,E,l){u?fe(l):E&&console.warn(l)}function se(u){return typeof u=="number"}const Ie=34229;function Ae(){const u=O;return typeof WebGL2RenderingContext<"u"&&u instanceof WebGL2RenderingContext||k.oes_vertex_array_object?u.getParameter(Ie):null}function $e(u,E,l){if(!D.failUnsetUniforms)return;const d=Ue.get(ne.currentProgram);if(d){const T=[];for(const[A,{index:R,unset:S}]of d)S.has(R)&&T.push(A);le(u,E,l,`uniforms "${T.join('", "')}" have not been set
See docs at https://github.com/greggman/webgl-lint/ for how to turn off this check using "failUnsetUniforms": false`)}}function Ne(u,E,l){return E>1||l>1?`${u}[${l}]`:u}function ft(u,E,l){if(!D.failUnrenderableTextures)return;const d=ge.get(ne.currentProgram),T=xe.numTextureUnits;for(const{type:A,values:R,name:S}of d){const I=hi(A);for(let B=0;B<R.length;++B){const H=R[B];if(H>=T){le(u,E,l,`uniform ${gt(A).name} ${Ne(S,R.length,B)} is set to ${H} which is out of range. There are only ${T} texture units`);return}const ce=xe.getTextureUnitUnrenderableReason(A,H,I,Ze);if(ce){const he=xe.getTextureForTextureUnit(H,I);le(u,E,l,he?`texture ${Ze(he)} on texture unit ${H} referenced by uniform ${Hn(A)} ${Ne(S,R.length,B)} is not renderable: ${ce}`:`no texture on texture unit ${H} referenced by uniform ${Ne(S,R.length,B)}`);return}}}}function Je(u,E,l){const d=ge.get(ne.currentProgram),T=new Map;for(const{type:A,values:R,name:S}of d){const I=R[0],B=T.get(I);if(!B)T.set(I,A);else if(B!==A){le(u,E,l,`Two textures of different types can't use the same sampler location. uniform ${gt(A).name} ${Ne(S,R.length,0)} is not ${gt(B).name}`);return}}}function Fe(u,E,l){if(!ne.currentProgram){le(u,E,l,"no current program");return}$e(u,E,l),ft(u,E,l),Je(u,E,l)}function Le(u,E,l){const[d,T,A,R=0,S=0]=l,I=O.getBufferParameter(d,u.BUFFER_SIZE),B=A instanceof DataView||A instanceof ArrayBuffer,H=S||(B?A.byteLength-R:A.length-R);if(I<T+H){const ce=Dn(d),he=O.getParameter(ce);le(u,E,l,I===0?`buffer ${Ze(he)} has 0 size. You need to call bufferData before calling bufferSubData.`:`buffer ${Ze(he)} buffer is too small for data [bufferSize:${I} dstByteOffset(${T}) + copyLength(${H}) = ${T+H}]`)}}const et={bufferSubData:Le,drawArrays:Fe,drawElements:Fe,drawArraysInstanced:Fe,drawElementsInstanced:Fe,drawArraysInstancedANGLE:Fe,drawElementsInstancedANGLE:Fe,drawRangeElements:Fe};function qe(u,E){if(!u){re(D.failUndefinedUniforms,D.warnUndefinedUniforms,`attempt to set non-existent uniform on ${Ze(ne.currentProgram)}
See docs at https://github.com/greggman/webgl-lint/ for how to turn off this check using "warnUndefinedUniforms: false"`);return}const l=Ue.get(ne.currentProgram);if(!l)return;const d=de.get(u),T=l.get(d);if(T){for(let A=0;A<E;++A)T.unset.delete(T.index+A);if(!T.unset.size){for(const[A]of T.altNames)l.delete(A);l.size||Ue.delete(ne.currentProgram)}}}function Te(u){return function(E,l,d){const[T,A,R=0,S=0]=d,I=S||A.length-R;qe(T,I/u|0)}}function bt(u){return Q.has(u)}function lt(u){return bt(de.get(u))}function Ke(u,E){const[l,d]=E;return e(u)&&u.getUniformIndices(l,[d])[0]!==u.INVALID_INDEX}function rt(u){return function(E,l,d){const[T,A,R,S=0,I=0]=d,H=(I||R.length-S)/u|0;if(D.failZeroMatrixUniforms&&!lt(T))for(let ce=0;ce<H;++ce){let he=!0;const mt=S+u*ce;for(let Ce=0;Ce<u;++Ce)if(R[mt+Ce]){he=!1;break}if(he){le(E,l,[T,A,...d],`matrix is all zeros
See docs at https://github.com/greggman/webgl-lint/ for how to turn off this check using "failZeroMatrixUniforms": false`);return}}qe(T,H)}}function Xo(u){const E=Te(u);return function(l,d,T){E(l,d,T);const[A,R]=T;vr(A,R)}}function je(u,E,l){const[d]=l;qe(d,1)}function Wo(u,E,l){je(u,E,l);const[d,T]=l;vr(d,[T])}function vr(u,E){const l=de.get(u),d=Pe.get(ne.currentProgram),{index:T,type:A,values:R}=d.get(l);if(!Bt(A))return;const S=Math.min(E.length,R.length-T);for(let I=0;I<S;++I)R[I]=E[I]}function tt(u,E,l){const[d]=l;Qe.delete(d)}const Yo=/ERROR:\s*\d+:(\d+)/gi;function Cr(u,E=""){const l=[...E.matchAll(Yo)],d=new Map(l.map((T,A)=>{const R=parseInt(T[1]),S=l[A+1],I=S?S.index:E.length,B=E.substring(T.index,I);return[R-1,B]}));return u.split(`
`).map((T,A)=>{const R=d.get(A);return`${A+1}: ${T}${R?`

^^^ ${R}`:""}`}).join(`
`)}const Tn={enable(u,E,l){const[d]=l;ne.enabled[d]?++be.enableDisable:ne.enabled[d]=!0},disable(u,E,l){const[d]=l;ne.enabled[d]?ne.enabled[d]=!1:++be.enableDisable},bindBuffer(u,E,l){const[d,T]=l;switch(d){case u.ELEMENT_ARRAY_BUFFER:break;default:ot(ne.buffers[d],T)?++be.bindBuffer:ne.buffers[d]=it(T)}},bindFramebuffer(u,E,l){const[d,T]=l;switch(d){case u.READ_FRAMEBUFFER:ot(ne.currentReadFramebuffer,T)?++be.bindFramebuffer:ne.currentReadFramebuffer=it(T);break;case u.DRAW_FRAMEBUFFER:ot(ne.currentDrawFramebuffer,T)?++be.bindFramebuffer:ne.currentDrawFramebuffer=it(T);break;case u.FRAMEBUFFER:ot(ne.currentDrawFramebuffer,T)&&ot(ne.currentDrawFramebuffer,T)?++be.bindFramebuffer:(ne.currentDrawFramebuffer=it(T),ne.currentReadFramebuffer=it(T))}},bindRenderbuffer(u,E,l){const[,d]=l;ot(ne.currentRenderbuffer,d)?++be.bindRenderbuffer:ne.currentRenderbuffer=it(d)},bufferData(u,E,l){const[d,T,,A=0,R=0]=l;if(d!==u.ELEMENT_ARRAY_BUFFER)return;const S=O.getParameter(u.ELEMENT_ARRAY_BUFFER_BINDING);if(se(T))V.set(S,new ArrayBuffer(T));else{const I=T instanceof DataView,B=R||(I?T.byteLength-A:T.length-A),H=I?1:T.BYTES_PER_ELEMENT,ce=B*H,he=T.buffer?T.buffer:T,Ce=(T.byteOffset||0)+A*H;V.set(S,he.slice(Ce,Ce+ce))}},bufferSubData(u,E,l){const[d,T,A,R=0,S=0]=l;if(d!==u.ELEMENT_ARRAY_BUFFER)return;const I=O.getParameter(u.ELEMENT_ARRAY_BUFFER_BINDING),B=V.get(I),H=new Uint8Array(B),ce=A instanceof DataView,he=S||(ce?A.byteLength-R:A.length-R),mt=ce?1:A.BYTES_PER_ELEMENT,Ce=he*mt,Pt=A.buffer?A.buffer:A,Ut=(A.byteOffset||0)+R*mt,ht=new Uint8Array(Pt,Ut,Ce);H.set(ht,T)},compileShader(u,E,l){if(!D.failBadShadersAndPrograms)return;const[d]=l;if(!O.getShaderParameter(d,u.COMPILE_STATUS)){const A=O.getShaderInfoLog(d),R=Cr(O.getShaderSource(d),A),S=O.getShaderParameter(d,u.SHADER_TYPE),I=`failed to compile ${b(S)}: ${A}
------[ shader source ]------
${R}`;le(u,E,l,I)}},createBuffer:j("Buffer"),createFramebuffer:j("Framebuffer"),createProgram:j("Program"),createQuery:j("Query"),createRenderbuffer:j("Renderbuffer"),createShader:j("Shader"),createTexture:j("Texture"),createTransformFeedback:j("TransformFeedback"),createSampler:j("Sampler"),createVertexArray:j("VertexArray"),createVertexArrayOES:j("VertexArray"),drawArrays:L,drawElements:L,drawArraysInstanced:L,drawElementsInstanced:L,drawArraysInstancedANGLE:L,drawElementsInstancedANGLE:L,drawRangeElements:L,fenceSync:j("Sync"),uniform1f:je,uniform2f:je,uniform3f:je,uniform4f:je,uniform1i:Wo,uniform2i:je,uniform3i:je,uniform4i:je,uniform1fv:Te(1),uniform2fv:Te(2),uniform3fv:Te(3),uniform4fv:Te(4),uniform1iv:Xo(1),uniform2iv:Te(2),uniform3iv:Te(3),uniform4iv:Te(4),uniformMatrix2fv:rt(4),uniformMatrix3fv:rt(9),uniformMatrix4fv:rt(16),uniform1ui:je,uniform2ui:je,uniform3ui:je,uniform4ui:je,uniform1uiv:Te(1),uniform2uiv:Te(2),uniform3uiv:Te(3),uniform4uiv:Te(4),uniformMatrix3x2fv:rt(6),uniformMatrix4x2fv:rt(8),uniformMatrix2x3fv:rt(6),uniformMatrix4x3fv:rt(12),uniformMatrix2x4fv:rt(8),uniformMatrix3x4fv:rt(12),getSupportedExtensions(u,E,l,d){d.push("GMAN_debug_helper")},getUniformLocation(u,E,l,d){const[T,A]=l;d?(de.set(d,A),_e.get(T).add(d)):!bt(A)&&!Ke(u,l)&&Qo(u,E,l,`uniform '${A}' does not exist in ${Ze(T)}`,D.failUndefinedUniforms,D.warnUndefinedUniforms)},linkProgram(u,E,l){const[d]=l;if(O.getProgramParameter(d,u.LINK_STATUS)){U(d);const A=new Map,R=new Map,S=[],I=O.getProgramParameter(d,u.ACTIVE_UNIFORMS);for(let B=0;B<I;++B){const{name:H,type:ce,size:he}=a.getActiveUniform(d,B);if(t(H)||!O.getUniformLocation(d,H))continue;const Ce=new Map([[H,0]]),Pt=H.endsWith("[0]");let Rt=H;if(Pt&&(Rt=H.substr(0,H.length-3),Ce.set(Rt,0)),he>1)for(let ve=0;ve<he;++ve)Ce.set(`${Rt}[${ve}]`,ve);const Ut=(!Bt(ce)||D.failUnsetSamplerUniforms)&&!Q.has(H),ht=Bt(ce)?new Array(he).fill(0):void 0;ht&&S.push({type:ce,values:ht,name:Rt});const pn=new Set(ra(0,he));for(const[ve,$r]of Ce)Ut&&A.set(ve,{index:$r,unset:pn,altNames:Ce}),R.set(ve,{index:$r,type:ce,size:he,...ht&&{values:ht}})}ge.set(d,S),Pe.set(d,R),A.size&&Ue.set(d,A)}else if(D.failBadShadersAndPrograms){const R=O.getAttachedShaders(d).map(B=>{const H=Cr(O.getShaderSource(B)),ce=O.getShaderParameter(B,u.SHADER_TYPE);return`-------[ ${b(ce)} ${Ze(B)} ]-------
${H}`}).join(`
`),I=`failed to link program: ${O.getProgramInfoLog(d)}
${R}`;le(u,E,l,I)}},useProgram(u,E,l){const[d]=l;ne.currentProgram===d?++be.useProgram:ne.currentProgram=d},deleteProgram(u,E,l){const[d]=l;ne.currentProgram===d&&(ne.currentProgram=void 0),U(d)},deleteBuffer(u,E,l){const[d]=l;V.delete(d)},deleteFramebuffer:tt,deleteRenderbuffer:tt,deleteTexture:tt,deleteShader:tt,deleteQuery:tt,deleteSampler:tt,deleteSync:tt,deleteTransformFeedback:tt,deleteVertexArray:tt,deleteVertexArrayOES:tt};[xe,nt].forEach(u=>{Object.entries(u.postChecks).forEach(([E,l])=>{const d=Tn[E]||J;Tn[E]=function(...T){d(...T),D.failUnrenderableTextures&&l(...T)}})});function Ze(u){const E=Qe.get(u)||"*unnamed*";return`${u.constructor.name}(${s(E)})`}function jo(u){return V.get(u)}function Ho(u,E,l,d,T){const A=Qe.get(T);if(A)return`${T.constructor.name}("${A}")`;if(T instanceof WebGLUniformLocation)return`WebGLUniformLocation("${de.get(T)}")`;const R=Be[E];if(R!==void 0){const S=R[l];if(S!==void 0){const I=S.enums;if(I){const B=I[d];if(B!==void 0){if(typeof B=="function")return B(u,T);if(!E.startsWith("bind")&&d===0){const H=Dn(T);if(H){const ce=O.getParameter(H);if(ce)return`${b(T)}{${Ze(ce)}}`}}return b(T)}}}}return T===null?"null":T===void 0?"undefined":Array.isArray(T)||n(T)?T.length<=32?`[${Array.from(T.slice(0,32)).join(", ")}]`:`${T.constructor.name}(${T.length!==void 0?T.length:T.byteLength})`:T.toString()}function St(u,E,l,d,T,A,R){if(!n(d)){le(u,E,l,`argument ${T} must be a TypedArray`);return}if(!r(d))return;const S=A,I=A+R;for(let B=S;B<I;++B)if(d[B]===void 0){le(u,E,l,`element ${B} of argument ${T} is undefined`);return}else if(isNaN(d[B])){le(u,E,l,`element ${B} of argument ${T} is NaN`);return}}function xn(u,E,l,d,T){const A=l[l.length-1],R=d.length-A;St(u,E,l,d,T,A,R)}function qo(u,E,l,d,T){if(n(d)&&r(d)){const R=d.length-0;St(u,E,l,d,T,0,R)}else Array.isArray(d)&&le(u,E,l,`argument ${T} is not an ArrayBufferView or ArrayBuffer`)}function Or(u,E,l,d,T){if(n(d)&&r(d)){const A=l[l.length-1],R=d.length-A;St(u,E,l,d,T,A,R)}else Array.isArray(d)&&le(u,E,l,`argument ${T} is not an ArrayBufferView or ArrayBuffer`)}function zr(u,E,l,d,T){if(n(d)&&r(d)){const A=l[l.length-2],R=l[l.length-1];St(u,E,l,d,T,A,R)}else Array.isArray(d)&&le(u,E,l,`argument ${T} is not an ArrayBufferView or ArrayBuffer`)}function Ko(u,E,l,d,T){if(Array.isArray(d)||n(d)){const A=l[l.length-1],R=d.length-A;St(u,E,l,d,T,A,R)}}function An(u,E,l,d,T,A,R,S){const I=l[0];if(!I)return;const B=Pe.get(ne.currentProgram);if(!B)return;const H=de.get(I),{type:ce,size:he,index:mt}=B.get(H),Ce=gt(ce).size;S!==Ce&&le(u,E,l,`uniform "${H}" is ${gt(ce).name} which is wrong for ${E}`);const Pt=he-mt,Ut=Math.min(R/S|0,Pt)*S,ht=A,pn=A+Ut;for(let ve=ht;ve<pn;++ve)if(d[ve]===void 0){le(u,E,l,`element ${ve} of argument ${T} is undefined`);return}else if(Jo(d[ve])){le(u,E,l,`element ${ve} of argument ${T} is an array. WebGL expects flat arrays`);return}else if(isNaN(d[ve])){le(u,E,l,`element ${ve} of argument ${T} is NaN`);return}}function pe(u){return function(E,l,d,T,A){const R=d[d.length-2],S=d[d.length-1];An(E,l,d,T,A,R,S,u)}}function ye(u){return function(E,l,d,T,A){const R=d[d.length-1],S=T.length-R;An(E,l,d,T,A,R,S,u)}}function Re(u){return function(E,l,d,T,A){const S=T.length;An(E,l,d,T,A,0,S,u)}}function Zo(u,E,l){const d=l.length;return l.map(function(A,R){let S=Ho(u,E,d,R,A);return S.length>200&&(S=S.substring(0,200)+"..."),S}).join(", ")}function qt(u,E,l,d){const T=O,A=[d],R=Be[E];if(R&&R.errorHelper&&A.push(R.errorHelper(u,E,l,C)),E.includes("draw")){const I=T.getParameter(T.CURRENT_PROGRAM);I?A.push(`with ${Ze(I)} as current program`):A.push("no shader program in use!")}if(E.includes("vertexAttrib")||cn(E)){const I=Ae(),B=Qe.get(I),H=`WebGLVertexArrayObject(${s(B||"*unnamed*")})`;A.push(`with ${I?H:"the default vertex array"} bound`)}const S=Zo(u,E,l);return`error in ${E}(${S}): ${A.join(`
`)}`}function Qo(u,E,l,d,T,A){re(T,A,qt(u,E,l,d))}function le(u,E,l,d){fe(qt(u,E,l,d))}const Jo=u=>Array.isArray(u)||n(u);function ea(u,E,l){const d=Be[E];if(d){const T=d[l.length];if(T){const{numbers:A={},arrays:R={},undef:S={}}=T;for(let I=0;I<l.length;++I){const B=l[I];if(B===void 0&&!S[I]){le(u,E,l,`argument ${I} is undefined`);return}if(A[I]!==void 0){if(A[I]>=0){if(typeof B!="number"&&!(B instanceof Number)&&B!==!1&&B!==!0||isNaN(B)){le(u,E,l,`argument ${I} is not a number`);return}}else if(!(B instanceof Object)&&isNaN(B)){le(u,E,l,`argument ${I} is NaN`);return}}const H=R[I];if(H!==void 0){const ce=Array.isArray(B)||n(B);if(H>=0&&!ce){le(u,E,l,`argument ${I} is not an array or typedarray`);return}if(ce&&r(B)){if(typeof H=="function")H(u,E,l,B,I);else for(let he=0;he<B.length;++he)if(B[he]===void 0){le(u,E,l,`element ${he} of argument ${I} is undefined`);return}else if(isNaN(B[he])){le(u,E,l,`element ${he} of argument ${I} is NaN`);return}}}}}else{le(u,E,l,`no version of function '${E}' takes ${l.length} arguments`);return}}}const ta={getExtension(u,E){const l=u[E];u[E]=function(...d){const T=d[0].toLowerCase(),A=k[T];if(A)return A.ctx;const R=l.call(u,...d);return R&&Dr(R,T,{...y,origGLErrorFn:F}),R}}};function na(u,E){const l=u[E],d=et[E]||J,T=Tn[E]||J;u[E]=function(...R){if(d(u,E,R),ea(u,E,R),ne.currentProgram&&cn(E)){const H=si(O,E,R,Ze,jo);H.length&&le(u,E,R,H.join(`
`))}const S=l.call(u,...R),I=O,B=F.call(I);if(B!==0){v[B]=!0;const H=[b(B)];cn(E)&&ne.currentProgram&&H.push(...Ni(I,Ze)),le(u,E,R,H.join(`
`))}else T(u,E,R,S);return S};const A=ta[E];A&&A(u,E,F)}function ra(u,E){const l=[];for(let d=u;d<E;++d)l.push(d);return l}for(const u in a)typeof a[u]=="function"&&($[u]=a[u],na(a,u));a.getError&&(a.getError=function(){for(const u of Object.keys(v))if(v[u])return v[u]=!1,u;return a.NO_ERROR}),k[x.toLowerCase()]={ctx:a,origFuncs:$}}console.log("webgl-lint running");function Lr(a){const x=a.prototype.getContext;a.prototype.getContext=function(y,...F){const N=x.call(this,y,...F);if(N&&N.bindTexture){Dr(N,y,{maxDrawCalls:1e3,throwOnError:!0,failBadShadersAndPrograms:!0,failUnsetUniforms:!0,failUnsetSamplerUniforms:!1,failZeroMatrixUniforms:!0,failUnrenderableTextures:!0,failUndefinedUniforms:!1,warnUndefinedUniforms:!0,makeDefaultTags:!0,ignoreUniforms:[]});const k=N.getExtension("GMAN_debug_helper");document.querySelectorAll("[data-gman-debug-helper]").forEach(O=>{const V=O.dataset.gmanDebugHelper;let D;try{D=JSON.parse(V)}catch(Q){throw Q.message+=`
${V}
failed to parse data-gman-debug-helper as JSON in: ${O.outerHTML}`,Q}D&&k.setConfiguration(D)})}return N}}typeof HTMLCanvasElement<"u"&&Lr(HTMLCanvasElement),typeof OffscreenCanvas<"u"&&Lr(OffscreenCanvas)});function mu(t){const e=new De([0,0,0]),n=t.inputManager,r=t.controllerIndex;if(t.controllerIndex!==null){const s=navigator.getGamepads()[r],i=s.buttons;for(let f=0;f<i.length;f++)n.setActionFromButton(f,i[f].pressed);const c=.4,o=s.axes[0];Math.abs(o)>=c&&e.add(new De([-o,0,0]));const m=s.axes[1];Math.abs(m)>=c&&e.add(new De([0,0,-m]));const h=s.axes[2];Math.abs(h)>=c&&(t.phi+=h*2);const b=s.axes[3];Math.abs(b)>=c&&(t.theta=qr(t.theta+b*2,-80,80))}if(n.getFromAction("flashlight").justPressed&&(t.flashlight=!t.flashlight),n.getFromAction("forward").down&&e.add(new De([0,0,1])).normalize(),n.getFromAction("back").down&&e.add(new De([0,0,-1])).normalize(),n.getFromAction("left").down&&e.add(new De([1,0,0])).normalize(),n.getFromAction("right").down&&e.add(new De([-1,0,0])).normalize(),e.magnitude()>0){let s=new He().identity(),i=new De(t.player.getTranslation()).scale(-1);n.getFromAction("sprint").down&&e.scale(1.5);const c=hu(t.phi,e.scale(.007)),o=Math.floor(i.x+.5),m=Math.round(i.z);(!(t.maze.mazemap[o][m]&2)||Math.abs(i.z-m)>t.maze.roomSize*.9)&&c.x<0&&i.x-o>t.maze.roomSize*.8&&(c.x=0),(!(t.maze.mazemap[o][m]&1)||Math.abs(i.z-m)>t.maze.roomSize*.9)&&c.x>0&&i.x-o<-t.maze.roomSize*.8&&(c.x=0),(!(t.maze.mazemap[o][m]&8)||Math.abs(i.x-o)>t.maze.roomSize*.9)&&c.z<0&&i.z-m>t.maze.roomSize*.8&&(c.z=0),(!(t.maze.mazemap[o][m]&4)||Math.abs(i.x-o)>t.maze.roomSize*.9)&&c.z>0&&i.z-m<-t.maze.roomSize*.8&&(c.z=0),s.translate(c),t.player.multiplyRight(s)}}function hu(t,e){let n=new He().identity();return n.rotateY(-t*Math.PI/180),n.translate(e),n.rotateY(t*Math.PI/180),new De(n.getTranslation())}function Jt(t,e,n){let r,s;return typeof e=="number"?(r=e,s=n):(r=e.x,s=e.z),t===1?r-=1:t===2?r+=1:t===4?s-=1:t===8&&(s+=1),new De(r,0,s)}class Eu{constructor(){this.setAction=(e,n)=>{const r=this.actions.get(e);r.justPressed=n&&!r.down,r.justPressed&&console.log("JUST PRESSED "+e),r.down=n,this.actions.set(e,r)},this.addKeyAction=(e,n)=>(this.keys.set(e,n),this.actions.get(n)||this.actions.set(n,{down:!1,justPressed:!1}),this),this.addButtonAction=(e,n)=>(this.buttons.set(e,n),this.actions.get(n)||this.actions.set(n,{down:!1,justPressed:!1}),this),this.setKeyFromKeyCode=(e,n)=>{const r=this.keys.get(e);r&&this.setAction(r,n)},this.keys=new Map,this.actions=new Map,this.buttons=new Map,this.addKeyAction("a","left"),this.addKeyAction("d","right"),this.addKeyAction("w","forward"),this.addKeyAction("s","back"),this.addKeyAction("f","flashlight"),this.addButtonAction(5,"flashlight"),this.addKeyAction("shift","sprint"),window.addEventListener("keydown",e=>{this.setKeyFromKeyCode(e.key.toLowerCase(),!0),e.preventDefault()}),window.addEventListener("keyup",e=>{this.setKeyFromKeyCode(e.key.toLowerCase(),!1),e.preventDefault()})}getFromKey(e){return this.actions.get(this.keys.get(e))}getFromAction(e){return this.actions.get(e)}setActionFromButton(e,n){const r=this.buttons.get(e);r&&this.setAction(r,n)}update(){this.actions.forEach(e=>{e.justPressed&&(e.justPressed=!1)})}}class Tt{constructor(e,n){this.x=e,this.y=n}distance(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}direction(e){if(this.distance(e)!==1)return 0;if(this.x>e.x)return 1;if(this.x<e.x)return 2;if(this.y>e.y)return 4;if(this.y<e.y)return 8}adjacent(){return[this.up(),this.down(),this.left(),this.right()]}up(){return new Tt(this.x,this.y+1)}down(){return new Tt(this.x,this.y-1)}left(){return new Tt(this.x-1,this.y)}right(){return new Tt(this.x+1,this.y)}valid(e){return this.x<e.length&&this.x>=0&&this.y<e[this.x].length&&this.y>=0}retrieve(e){if(this.valid(e))return e[this.x][this.y]}insert(e,n){this.valid(e)&&(e[this.x][this.y]|=n)}add(e,n){this.valid(e)&&(e[this.x][this.y]=e[this.x][this.y]+n)}equals(e){return e!==void 0&&this.x===e.x&&this.y===e.y}pos(){return"X: "+this.x+" Y: "+this.y}copy(){return new Tt(this.x,this.y)}}function Mn(t,e,n){let r=t[t.length-1],s=n!==void 0?n-1:void 0;if(e[r.x][r.y]>0||s===0)return{finished:!0,into:r,path:t};if(t.slice(0,-1).some(c=>c.equals(r)))return{finished:!1,into:r,path:t.slice(0,-1)};let i=Un(r.adjacent()).filter(c=>c.valid(e));for(let c=0;c<i.length;c++){const o=i[c];let m=new Array(...t);m.push(o);let h=Mn(m,e,s);if(h.finished)return h.into.insert(e,h.into.direction(r)),r.insert(e,r.direction(h.into)),{finished:!0,into:r,path:m};if(!r.equals(h.into))return{finished:!1,into:h.into,path:t}}return Mn(t,e,s)}const Un=t=>{for(let e=t.length-1;e>0;e--){const n=Math.floor(Math.random()*(e+1));[t[e],t[n]]=[t[n],t[e]]}return t};class du{constructor(e,n){const r=new Array(n).fill(0);for(let p=0;p<n;p++)r[p]=new Array(n).fill(0);let s=new Array;for(let p=0;p<n;p++)for(let _=0;_<n;_++)s.push(new Tt(p,_));Un(s);let i=new Array;for(this.start=s.pop(),this.start.insert(r,16);s.length>0;){const p=s.pop(),_=Mn([p],r).path;for(this.goal===void 0&&p.distance(this.start)>n/2&&(this.goal=p),_.length>1&&p.x>0&&p.y>0&&p.x<n-1&&p.y<n-1&&i.push(p);_.length>0;){const X=_.shift();s=s.filter(ee=>!ee.equals(X))}}for(;i.length>0;){const p=i.pop(),_=p.retrieve(r),X=[1,2,4,8];let ee=0;if(X.forEach(w=>{w&_&&(ee+=1)}),ee==1){let w;switch(_){case 1:w=p.right();break;case 2:w=p.left();break;case 4:w=p.down();break;case 8:w=p.up();break}w.valid(r)&&(p.insert(r,p.direction(w)),w.insert(r,w.direction(p)))}}let c=[],o=[];const m=.25,h=.15,b=.45,f=1;for(let p=0;p<n;p++)for(let _=0;_<n;_++){r[p][_]===0&&console.debug(p+" "+_);const X=[(p-b)*f,(h-m)*f,(_-b)*f],ee=[(p+b)*f,(h-m)*f,(_-b)*f],w=[(p+b)*f,(h-m)*f,(_+b)*f],z=[(p-b)*f,(h-m)*f,(_+b)*f],W=[(p-b)*f,(h+m)*f,(_-b)*f],Y=[(p+b)*f,(h+m)*f,(_-b)*f],me=[(p+b)*f,(h+m)*f,(_+b)*f],ue=[(p-b)*f,(h+m)*f,(_+b)*f],q=[0,-1,0],K=[0,1,0],ie=[-1,0,0],oe=[1,0,0],ae=[0,0,-1],Z=[0,0,1];if(c=c.concat(ue,Y,me,Y,ue,W,z,ee,w,ee,X,z),o=o.concat(q,q,q,q,q,q,K,K,K,K,K,K),r[p][_]%2>0){const Ee=[(p-.5)*f,(h+m)*f,(_-b)*f],we=[(p-.5)*f,(h-m)*f,(_-b)*f],Me=[(p-.5)*f,(h+m)*f,(_+b)*f],Ge=[(p-.5)*f,(h-m)*f,(_+b)*f];c=c.concat(z,ue,Me,Ge,Me,z,X,W,Ee,we,Ee,X,Me,Ee,ue,Ee,W,ue,Ge,we,z,we,X,z),o=o.concat(ae,ae,ae,ae,ae,ae,Z,Z,Z,Z,Z,Z,q,q,q,q,q,q,K,K,K,K,K,K)}else c=c.concat(W,ue,X,z,X,ue),o=o.concat(oe,oe,oe,oe,oe,oe);if(r[p][_]%4>1){const Ee=[(p+.5)*f,(h+m)*f,(_-b)*f],we=[(p+.5)*f,(h-m)*f,(_-b)*f],Me=[(p+.5)*f,(h+m)*f,(_+b)*f],Ge=[(p+.5)*f,(h-m)*f,(_+b)*f];c=c.concat(w,me,Me,Ge,Me,w,ee,Y,Ee,we,Ee,ee,Me,Ee,me,Ee,Y,me,Ge,we,w,we,ee,w),o=o.concat(ae,ae,ae,ae,ae,ae,Z,Z,Z,Z,Z,Z,q,q,q,q,q,q,K,K,K,K,K,K)}else c=c.concat(me,Y,ee,w,ee,me),o=o.concat(ie,ie,ie,ie,ie,ie);if(r[p][_]%8>3){const Ee=[(p+b)*f,(h+m)*f,(_-.5)*f],we=[(p+b)*f,(h-m)*f,(_-.5)*f],Me=[(p-b)*f,(h+m)*f,(_-.5)*f],Ge=[(p-b)*f,(h-m)*f,(_-.5)*f];c=c.concat(ee,Y,Ee,Ee,we,ee,X,W,Me,Me,Ge,X,Ee,Me,Y,Me,W,Y,we,Ge,X,we,X,ee),o=o.concat(ie,ie,ie,ie,ie,ie,oe,oe,oe,oe,oe,oe,q,q,q,q,q,q,K,K,K,K,K,K)}else c=c.concat(Y,W,X,X,ee,Y),o=o.concat(Z,Z,Z,Z,Z,Z);if(r[p][_]%16>7){const Ee=[(p+b)*f,(h+m)*f,(_+.5)*f],we=[(p+b)*f,(h-m)*f,(_+.5)*f],Me=[(p-b)*f,(h+m)*f,(_+.5)*f],Ge=[(p-b)*f,(h-m)*f,(_+.5)*f];c=c.concat(w,me,Ee,Ee,we,w,z,ue,Me,Me,Ge,z,Ee,Me,me,Me,ue,me,we,Ge,z,we,w,z),o=o.concat(ie,ie,ie,ie,ie,ie,oe,oe,oe,oe,oe,oe,q,q,q,q,q,q,K,K,K,K,K,K)}else c=c.concat(ue,me,w,z,w,ue),o=o.concat(ae,ae,ae,ae,ae,ae)}const g=e.createVertexArray();e.bindVertexArray(g);const M=e.createBuffer();e.enableVertexAttribArray(0),e.bindBuffer(e.ARRAY_BUFFER,M),e.bufferData(e.ARRAY_BUFFER,new Float32Array(c),e.STATIC_DRAW),e.vertexAttribPointer(0,3,e.FLOAT,!1,0,0);var G=e.createBuffer();e.enableVertexAttribArray(1),e.bindBuffer(e.ARRAY_BUFFER,G),e.bufferData(e.ARRAY_BUFFER,new Float32Array(o),e.STATIC_DRAW),e.vertexAttribPointer(1,3,e.FLOAT,!1,0,0),this.mazemap=r,this.vao=g,this.normals=o,this.roomSize=b,this.vboSize=c.length}loadTextures(e,n){e.useProgram(this.program);const r=e.createTexture();e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,r),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n[0]),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_LINEAR),e.generateMipmap(e.TEXTURE_2D),e.activeTexture(e.TEXTURE1);const s=e.createTexture();e.bindTexture(e.TEXTURE_2D,s),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n[1]),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_LINEAR),e.generateMipmap(e.TEXTURE_2D),e.activeTexture(e.TEXTURE2);const i=e.createTexture();e.bindTexture(e.TEXTURE_2D,i),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n[2]),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_LINEAR),e.generateMipmap(e.TEXTURE_2D),this.textures=[r,s,i]}update(e){const n=e.gl,r=this.program;n.useProgram(r),n.bindVertexArray(this.vao),Pn(this.uniformSetter,e.globalUniforms),n.activeTexture(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,this.textures[0]);let s=n.getUniformLocation(r,"uTexture");n.uniform1i(s,0),n.activeTexture(n.TEXTURE1),n.bindTexture(n.TEXTURE_2D,this.textures[1]);let i=n.getUniformLocation(r,"uFloor");n.uniform1i(i,1),n.activeTexture(n.TEXTURE2),n.bindTexture(n.TEXTURE_2D,this.textures[2]);let c=n.getUniformLocation(r,"uCeiling");n.uniform1i(c,2),n.drawArrays(n.TRIANGLES,0,this.vboSize/3)}}const bu="/assets/wallpaper-B-8789Ut.png",Tu="/assets/floor-Dl6kxC-q.webp",xu="/assets/ceiling-B75eh-JO.png",Au="/assets/eyes-BN1QhFwl.png";class pu{update(e){const n=new De(this.position.getTranslation()),r=Math.floor(n.x+.5),s=Math.round(n.z);this.timer++;let i=0;switch(this.state){case"idle":if(this.timer%60===0){Math.random()>.7&&(this.state="wander");const m=[1,2,4,8];let h=[];const b=e.maze.mazemap;for(const f of m)b[r][s]&f&&h.push(Jt(f,r,s));this.goingTo=Un(h).pop()}break;case"wander":i=.005,this.goingTo.distance(this.position.getTranslation())<.01&&(this.state="idle",this.position=new He().identity().translate(this.goingTo));break;case"chase":i=.015,this.goingTo.distance(this.position.getTranslation())<.01&&(this.position=new He().identity().translate(this.goingTo),this.target.loc.distance(this.goingTo)<.01?this.state="idle":this.goingTo=Jt(this.target.dir,this.goingTo))}const c=new De(e.player.getTranslation()).scale(-1),o=this.inSight(c,e.maze.mazemap);if(o===15&&c.distance(this.position.getTranslation())<.6&&(e.gameOver=!0),o&&(this.state="chase",c.x=Math.round(c.x),c.z=Math.round(c.z),this.target={loc:c,dir:o},this.goingTo.distance(Jt(o,r,s))&&(this.goingTo=Jt(0,r,s))),i>0){const m=this.goingTo.clone().subtract(this.position.getTranslation()).normalize().scale(i);this.position.translate(m)}this.draw(e)}inSight(e,n){const r=new De(this.position.getTranslation()),s=Math.floor(r.x+.5),i=Math.round(r.z);function c(h,b,f){if(h<0||b<0||h>=n.length||b>=n.length)return 0;let g=h,M=b;return Math.round(e.x)==h&&Math.round(e.z)==b?f:n[h][b]&f?(f===1?g=h-1:f===2?g=h+1:f===4?M=b-1:f===8&&(M=b+1),c(g,M,f)):0}let o=0;const m=[1,2,4,8];for(const h of m)o|=c(s,i,h);return o>0&&console.log("Has been known! "+o),o}draw(e){const n=e.gl,r=this.program;this.angleX+=(Math.random()+Math.random())/10,this.angleY+=Math.random()/10,n.useProgram(r),n.bindVertexArray(this.vao);let s=n.getUniformLocation(r,"uPosition");n.uniformMatrix4fv(s,!1,this.position);let i=n.getUniformLocation(r,"uRotation");const c=new He().identity().rotateY(this.angleY).rotateX(this.angleX).scale(.1);n.activeTexture(n.TEXTURE0),n.bindTexture(n.TEXTURE_CUBE_MAP,this.texture);let o=n.getUniformLocation(r,"uTexture");n.uniform1i(o,0),n.uniformMatrix4fv(i,!1,c),Pn(this.uniformSetter,e.globalUniforms),n.drawElements(n.TRIANGLE_STRIP,this.iboSize,n.UNSIGNED_INT,0)}constructor(e){let s=[],i=[],c=0;for(let g=0;g<=32;g++){const M=Math.cos(c),G=Math.sin(c);let p=0;for(let _=0;_<64;_++){const X=Math.cos(p),ee=Math.sin(p),w=G*X,z=G*ee,W=M;s.push(w,z,W),s.push(w,z,W),p+=2*Math.PI/64}c+=Math.PI/32}let o=0;for(let g=0;g<32;g++){for(let M=0;M<64;M++)i.push(o+M),i.push(o+M+64);i.push(o+0),i.push(o+64),o+=64}const m=i.length;console.log(m);const h=e.createVertexArray();e.bindVertexArray(h);const b=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,b),e.bufferData(e.ARRAY_BUFFER,new Float32Array(s),e.STATIC_DRAW),e.enableVertexAttribArray(0),e.vertexAttribPointer(0,3,e.FLOAT,!1,6*4,0),e.enableVertexAttribArray(1),e.vertexAttribPointer(1,3,e.FLOAT,!1,6*4,3*4);const f=e.createBuffer();e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,f),e.bufferData(e.ELEMENT_ARRAY_BUFFER,new Uint32Array(i),e.STATIC_DRAW),this.vao=h,this.iboSize=m,this.angleX=0,this.angleY=0,this.position=new He().identity(),this.state="idle",this.timer=0,this.goingTo=new De}loadTextures(e,n){e.useProgram(this.program),e.activeTexture(e.TEXTURE0);const r=e.createTexture();e.bindTexture(e.TEXTURE_CUBE_MAP,r),e.texImage2D(e.TEXTURE_CUBE_MAP_NEGATIVE_X,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n),e.bindTexture(e.TEXTURE_CUBE_MAP,r),e.texImage2D(e.TEXTURE_CUBE_MAP_NEGATIVE_Y,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n),e.bindTexture(e.TEXTURE_CUBE_MAP,r),e.texImage2D(e.TEXTURE_CUBE_MAP_NEGATIVE_Z,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n),e.bindTexture(e.TEXTURE_CUBE_MAP,r),e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n),e.bindTexture(e.TEXTURE_CUBE_MAP,r),e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_Y,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n),e.bindTexture(e.TEXTURE_CUBE_MAP,r),e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_Z,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n),e.bindTexture(e.TEXTURE_CUBE_MAP,r),e.generateMipmap(e.TEXTURE_CUBE_MAP),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_WRAP_R,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_LINEAR),this.texture=r}}const Hr=t=>{const e=t.gl,n=new He().identity();let r=.01,s=1e3,i=e.canvas.width/e.canvas.height;const c=new He().perspective({fovy:Math.PI/4,aspect:i,near:r,far:s});n.identity(),n.rotateX(t.theta*Math.PI/180),n.rotateY(t.phi*Math.PI/180),n.multiplyRight(t.player),e.colorMask(!0,!0,!0,!0);let o=new He().identity();o.rotateY(-t.phi*Math.PI/180),o.rotateX(-t.theta*Math.PI/180),o.translate([0,0,1]),o.rotateX(t.theta*Math.PI/180),o.rotateY(t.phi*Math.PI/180),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT);const m={uProjection:c,uModelView:n,lightPosition:t.player.getTranslation(),u_lightDirection:new De(o.getTranslation()).scale(-1),u_limit:Math.cos(20*Math.PI/180),uFlashlight:t.flashlight};t.globalUniforms=m,t.objects.forEach(h=>{h.update(t)}),t.maze.update(t),t.enemy.update(t)},yu=()=>{const t=en.useRef(),e=en.useRef(),n=()=>{if(!e.current)return;const o=e.current;if(o.gameOver){o.gl.clearColor(0,0,0,1),us(!0);return}mu(o),Hr(o),o.inputManager.update(),requestAnimationFrame(n)},r=()=>{e.current&&document.body.requestPointerLock()},s=o=>{if(!e.current)return;const m=e.current,h=10;m.phi+=o.movementX/h,m.theta=qr(m.theta+o.movementY/h,-80,80)},i=o=>{if(!e.current)return;const m=e.current;m.controllerIndex=o.gamepad.index},c=async()=>{const o=t.current.getContext("webgl2",{antialias:!0});if(!o)return;const m=new Array,h=new du(o,5),b=new Eu;h.program=Wr(o,Za,Qa),o.enable(o.DEPTH_TEST),o.clearColor(0,0,0,1),o.enable(o.BLEND),o.blendFunc(o.SRC_ALPHA,o.ONE_MINUS_SRC_ALPHA);const f=new pu(o);f.program=Wr(o,Ja,ec),f.position.translate([h.goal.x,0,h.goal.y]);const g=await Ru();h.loadTextures(o,g),f.loadTextures(o,await nn(Au));const M=()=>{e.current.gameOver||(o.viewport(0,0,o.canvas.width,o.canvas.height),Hr(e.current))};t.current.addEventListener("mousedown",r),document.addEventListener("mousemove",s,!1),window.addEventListener("gamepadconnected",i),h.uniformSetter=jr(o,h.program),f.uniformSetter=jr(o,f.program),e.current={gl:o,enemy:f,inputManager:b,maze:h,player:new He().identity().translate([-h.start.x,0,-h.start.y]),phi:90,theta:5,gameOver:!1,globalUniforms:new Array,objects:m,controllerIndex:null,flashlight:!0},Xr(t.current),M(),window.addEventListener("resize",()=>{Xr(t.current)&&M()}),requestAnimationFrame(n)};return en.useEffect(()=>{c()},[]),st.jsx("div",{className:"relative bg-black h-[inherit] w-full",children:st.jsx("canvas",{ref:t,className:"w-full h-[inherit]"})})},nn=async t=>{const e=new Image;return await new Promise((n,r)=>{e.onload=()=>{n()},e.onerror=function(){console.log(t,"not found."),r()},e.src=t}),e},Ru=async t=>{const e=new Array;return e.push(await nn(bu)),e.push(await nn(Tu)),e.push(await nn(xu)),e};let us;const gu=()=>{const[t,e]=en.useState(!1);return us=e,t?st.jsx(st.Fragment,{children:st.jsx("div",{className:"relative bg-black h-[inherit] w-full",children:st.jsx("img",{src:"./src/img/heccinded.png"})})}):st.jsx(st.Fragment,{children:st.jsx(yu,{})})};export{gu as default};
